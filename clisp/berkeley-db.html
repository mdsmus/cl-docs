<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>33.6. Berkeley DB access</title><link rel="stylesheet" href="impnotes.css" type="text/css" /><link rev="made" href="mailto:clisp-list@lists.sourceforge.net" /><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot_7566" /><link rel="start" href="index.html" title="Implementation Notes for GNU CLISP" /><link rel="up" href="ext-modules.html" title="Chapter 33. Extensions Implemented as Modules" /><link rel="prev" href="gdbm.html" title="33.5. GDBM - The GNU database manager" /><link rel="next" href="dir-key.html" title="33.7. Directory Access" /><link rel="copyright" href="legalese.html" title="Legal Status of the CLISP Implementation Notes" /><meta name="date" content="'generated: 2008-07-02 11:52:30-04:00'" /><link rel="author" title="Authors" href="index.html#authors" /><link rel="contents" title="Table of Contents" href="index.html" /><link rel="glossary" href="glossary.html" /><link rel="help" href="faq.html#faq-help" title="How do I ask for help?" /><link rel="home" title="Home" href="http://clisp.cons.org" /><link rel="index" href="idx.html" /></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">33.6. Berkeley DB access</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="gdbm.html">Prev</a> </td><th width="60%" align="center">Chapter 33. Extensions Implemented as Modules</th><td width="20%" align="right"> <a accesskey="n" href="dir-key.html">Next</a></td></tr></table><hr /></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="berkeley-db"></a>33.6. Berkeley DB access</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="berkeley-db.html#bdb-objects">33.6.1. Berkeley-DB Objects</a></span></dt><dt><span class="section"><a href="berkeley-db.html#bdb-close">33.6.2. Closing handles</a></span></dt><dt><span class="section"><a href="berkeley-db.html#bdb-db-environment">33.6.3. Database Environment</a></span></dt><dt><span class="section"><a href="berkeley-db.html#bdb-environment-config">33.6.4. Environment Configuration</a></span></dt><dt><span class="section"><a href="berkeley-db.html#bdb-operations">33.6.5. Database Operations</a></span></dt><dt><span class="section"><a href="berkeley-db.html#bdb-db-config">33.6.6. Database Configuration</a></span></dt><dt><span class="section"><a href="berkeley-db.html#bdb-cursor">33.6.7. Database Cursor Operations</a></span></dt><dt><span class="section"><a href="berkeley-db.html#bdb-lock">33.6.8. Lock Subsystem</a></span></dt><dt><span class="section"><a href="berkeley-db.html#bdb-log">33.6.9. Log Subsystem</a></span></dt><dd><dl><dt><span class="section"><a href="berkeley-db.html#bdb-log-cursor">33.6.9.1. Log Cursor Operations</a></span></dt><dt><span class="section"><a href="berkeley-db.html#bdb-log-seq">33.6.9.2. Log Sequence Numbers</a></span></dt></dl></dd><dt><span class="section"><a href="berkeley-db.html#bdb-mem-pool">33.6.10. Memory Pool Subsystem</a></span></dt><dt><span class="section"><a href="berkeley-db.html#bdb-replication">33.6.11. Replication</a></span></dt><dt><span class="section"><a href="berkeley-db.html#bdb-sequences">33.6.12. Sequences</a></span></dt><dt><span class="section"><a href="berkeley-db.html#bdb-transaction">33.6.13. Transaction Subsystem</a></span></dt></dl></div><p>This interface to <a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/index.html">Berkeley DB</a>
 from <a class="ulink" href="http://en.wikipedia.org/wiki/Sleepycat_Software" target="_top">Sleepycat
  Software</a>/<a class="ulink" href="http://www.oracle.com" target="_top">Oracle</a> exports most functions in the official
 <a class="ulink" href="http://c-faq.com/" target="_top"><span class="command"><strong>C</strong></span></a> API.  Supported versions:</p><table class="simplelist" border="0" summary="Simple list"><tr><td><a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/ref/upgrade.4.2/toc.html">4.2</a></td></tr><tr><td><a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/ref/upgrade.4.3/toc.html">4.3</a></td></tr><tr><td><a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/ref/upgrade.4.4/toc.html">4.4</a></td></tr><tr><td><a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/ref/upgrade.4.5/toc.html">4.5</a></td></tr><tr><td><a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/ref/upgrade.4.6/toc.html">4.6</a></td></tr></table><p>When this module is present, <a href="features.html" class="olink"><code class="varname">*FEATURES*</code></a> contains the
 symbol <code class="constant">:BERKELEY-DB</code>.</p><p>See <a class="clisp-cvs" href="http://clisp.cvs.sourceforge.net/*checkout*/clisp/clisp/modules/berkeley-db/test.tst"><code class="filename">modules/berkeley-db/test.tst</code></a>
 for sample usage.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="bdb-objects"></a>33.6.1. Berkeley-DB Objects</h3></div></div></div><p>Thie module exports the following opaque <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/cla_structure-object.html" target="_top"><code class="classname">STRUCTURE-OBJECT</code></a> types:
 </p><div class="variablelist"><dl><dt><span class="term"><span class="type">BDB:DBE</span></span></dt><dd>environment handle</dd><dt><span class="term"><span class="type">BDB:DB</span></span></dt><dd>database handle</dd><dt><span class="term"><span class="type">BDB:DBC</span></span></dt><dd>cursor handle</dd><dt><span class="term"><span class="type">BDB:TXN</span></span></dt><dd>transaction handle</dd><dt><span class="term"><span class="type">BDB:LOGC</span></span></dt><dd>log cursor handle</dd><dt><span class="term"><span class="type">BDB:MPOOLFILE</span></span></dt><dd>memory pool file handle</dd><dt><span class="term"><span class="type">BDB:DBLOCK</span></span></dt><dd>lock handle</dd></dl></div><p>
 They contain the internal handle (a <a class="link" href="dffi.html#fptr"><code class="classname">FFI:FOREIGN-POINTER</code></a>), the <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/syscla_list.html" target="_top"><code class="classname">LIST</code></a>
 of parents, and the <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/syscla_list.html" target="_top"><code class="classname">LIST</code></a> of dependents.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="bdb-close"></a>33.6.2. Closing handles</h3></div></div></div><p><a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_close.html" target="_top"><code class="function">CLOSE</code></a> will close (or commit, in the case of a
 <a class="link" href="berkeley-db.html#bdb-transaction" title="33.6.13. Transaction Subsystem">transaction</a>, or
 put, in the case of a <a class="link" href="berkeley-db.html#bdb-lock" title="33.6.8. Lock Subsystem">lock</a>)
 the Berkeley-DB handle objects.  The <a href="gc.html" class="olink">garbage-collect</a>or will also call <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_close.html" target="_top"><code class="function">CLOSE</code></a>.
 Closing an object will <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_close.html" target="_top"><code class="function">CLOSE</code></a> all its dependents and remove the object
 itself from the dependents lists of its parents (but see
 <a class="link" href="berkeley-db.html#bdb-lock" title="33.6.8. Lock Subsystem"><code class="function">BDB:LOCK-CLOSE</code></a>).</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="bdb-db-environment"></a>33.6.3. Database Environment</h3></div></div></div><div class="variablelist"><dl><dt><span class="term"><code class="code">(BDB:DB-VERSION <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html" target="_top"><code class="literal">&amp;OPTIONAL</code></a>
    subsystems-too)</code></span></dt><dd><p>Return version information as multiple values:</p><div class="orderedlist"><ol type="1"><li>descriptive <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/syscla_string.html" target="_top"><code class="classname">STRING</code></a>
       (from <a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_version.html"><code class="function">db_version</code></a>)</li><li>major version number (<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/typ_fixnum.html" target="_top"><code class="classname">FIXNUM</code></a>)</li><li>minor version number (<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/typ_fixnum.html" target="_top"><code class="classname">FIXNUM</code></a>)</li><li>patch number (<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/typ_fixnum.html" target="_top"><code class="classname">FIXNUM</code></a>)</li></ol></div><p>When the optional argument is non-<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_nil.html" target="_top"><code class="constant">NIL</code></a>, returns the
    <a class="" href="http://www.lisp.org/HyperSpec/Body/glo_a.html#association_list">association list</a> of the subsystem versions as the 5th value.
 </p></dd><dt><a id="dbe-create"></a><span class="term"><code class="code">(BDB:DBE-CREATE <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html" target="_top"><code class="literal">&amp;KEY</code></a>
    PASSWORD ENCRYPT HOST CLIENT-TIMEOUT SERVER-TIMEOUT)</code></span></dt><dd>Create an environment handle
    (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_class.html"><code class="function">db_env_create</code></a>),
    possibly connecting to a remote host
    (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_set_rpc_server.html"><code class="function">DB_ENV-&gt;set_rpc_server</code></a>)
    and possibly using encryption with password
    (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_set_encrypt.html"><code class="function">DB_ENV-&gt;set_encrypt</code></a>).
 </dd><dt><span class="term"><code class="code">(BDB:DBE-CLOSE dbe)</code></span></dt><dd>Close an environment
    (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_close.html"><code class="function">DB_ENV-&gt;close</code></a>).
    You can also call <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_close.html" target="_top"><code class="function">CLOSE</code></a>.</dd><dt><span class="term"><code class="code">(BDB:DBE-MESSAGES dbe)</code></span></dt><dd>Return the verbose messages accumulated so far
    (requires Berkeley-DB 4.3 or better).</dd><dt><span class="term"><code class="code">(BDB:DBREMOVE dbe file
    database <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html" target="_top"><code class="literal">&amp;KEY</code></a> TRANSACTION AUTO-COMMIT)</code></span></dt><dd>Remove a database
    (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_dbremove.html"><code class="function">DB_ENV-&gt;dbremove</code></a>).
 </dd><dt><span class="term"><code class="code">(BDB:DBREMOVE dbe file
    database newname <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html" target="_top"><code class="literal">&amp;KEY</code></a> TRANSACTION AUTO-COMMIT)</code></span></dt><dd>Rename a database
    (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_dbrename.html"><code class="function">DB_ENV-&gt;dbrename</code></a>).
 </dd><dt><a id="dbe-open"></a><span class="term"><code class="code">(BDB:DBE-OPEN dbe <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html" target="_top"><code class="literal">&amp;KEY</code></a>
    FLAGS HOME JOIN INIT-CDB INIT-LOCK INIT-LOG INIT-MPOOL INIT-TXN
    RECOVER RECOVER-FATAL USE-ENVIRON USE-ENVIRON-ROOT CREATE
    LOCKDOWN PRIVATE SYSTEM-MEM THREAD MODE)</code></span></dt><dd>Open an environment
    (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_open.html"><code class="function">DB_ENV-&gt;open</code></a>).
    <code class="constant">:FLAGS</code> may be the value of a previous call
    to <code class="code">(<a class="link" href="berkeley-db.html#dbe-get-options"><code class="function">BDB:DBE-GET-OPTIONS</code></a> dbe :OPEN)</code>.
 </dd><dt><span class="term"><code class="code">(BDB:DBE-REMOVE dbe <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html" target="_top"><code class="literal">&amp;KEY</code></a>
    HOME FORCE USE-ENVIRON USE-ENVIRON-ROOT)</code></span></dt><dd>Destroy an environment
    (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_remove.html"><code class="function">DB_ENV-&gt;remove</code></a>).
 </dd><dt><a id="with-dbe"></a><span class="term"><code class="code">(BDB:WITH-DBE (var <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html" target="_top"><code class="literal">&amp;KEY</code></a>
    <em class="replaceable"><code>create</code></em> <em class="replaceable"><code>options</code></em>) <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/sec_3-4-4.html" target="_top"><code class="literal">&amp;BODY</code></a> body)</code></span></dt><dd>Create an environment, execute <em class="replaceable"><code>body</code></em>, close it.
    <em class="replaceable"><code>create</code></em> is a list of options to be passed to <a class="link" href="berkeley-db.html#dbe-create"><code class="function">BDB:DBE-CREATE</code></a>,
    <em class="replaceable"><code>options</code></em> is a list of options to be passed to <a class="link" href="berkeley-db.html#dbe-set-options"><code class="function">BDB:DBE-SET-OPTIONS</code></a>.
 </dd></dl></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="bdb-environment-config"></a>33.6.4. Environment Configuration</h3></div></div></div><div class="variablelist"><dl><dt><a id="dbe-set-options"></a><span class="term"><code class="code">(BDB:DBE-SET-OPTIONS dbe
   <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html" target="_top"><code class="literal">&amp;KEY</code></a> MSGFILE ERRFILE ERRPFX PASSWORD ENCRYPT LOCK-TIMEOUT TXN-TIMEOUT
   SHM-KEY TAS-SPINS TX-TIMESTAMP TX-MAX DATA-DIR TMP-DIR LG-BSIZE LG-DIR
   LG-MAX LG-REGIONMAX NCACHE CACHESIZE CACHE LK-CONFLICTS LK-DETECT
   LK-MAX-LOCKERS LK-MAX-LOCKS LK-MAX-OBJECTS AUTO-COMMIT CDB-ALLDB DIRECT-DB
   DSYNC-LOG LOG-AUTOREMOVE LOG-INMEMORY DIRECT-LOG NOLOCKING NOMMAP NOPANIC
   OVERWRITE PANIC-ENVIRONMENT REGION-INIT TXN-NOSYNC TXN-WRITE-NOSYNC YIELDCPU
   VERB-CHKPOINT VERB-DEADLOCK VERB-RECOVERY VERB-REPLICATION VERB-WAITSFOR
   VERBOSE)</code></span></dt><dd><p>Set some environment options using </p><table class="simplelist" border="0" summary="Simple list"><tr><td><a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_set_flags.html"><code class="function">DB_ENV-&gt;set_flags</code></a></td><td><a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_set_timeout.html"><code class="function">DB_ENV-&gt;set_timeout</code></a></td><td><a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_set_lg_regionmax.html"><code class="function">DB_ENV-&gt;set_lg_regionmax</code></a></td></tr><tr><td><a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_set_verbose.html"><code class="function">DB_ENV-&gt;set_verbose</code></a></td><td><a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_set_encrypt.html"><code class="function">DB_ENV-&gt;set_encrypt</code></a></td><td><a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_set_lk_conflicts.html"><code class="function">DB_ENV-&gt;set_lk_conflicts</code></a></td></tr><tr><td><a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_set_tmp_dir.html"><code class="function">DB_ENV-&gt;set_tmp_dir</code></a></td><td><a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_set_errfile.html"><code class="function">DB_ENV-&gt;set_errfile</code></a></td><td><a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_set_lk_detect.html"><code class="function">DB_ENV-&gt;set_lk_detect</code></a></td></tr><tr><td><a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_set_data_dir.html"><code class="function">DB_ENV-&gt;set_data_dir</code></a></td><td><a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_set_msgfile.html"><code class="function">DB_ENV-&gt;set_msgfile</code></a></td><td><a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_set_lk_max_lockers.html"><code class="function">DB_ENV-&gt;set_lk_max_lockers</code></a></td></tr><tr><td><a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_set_tx_max.html"><code class="function">DB_ENV-&gt;set_tx_max</code></a></td><td><a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_set_errpfx.html"><code class="function">DB_ENV-&gt;set_errpfx</code></a></td><td><a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_set_lk_max_locks.html"><code class="function">DB_ENV-&gt;set_lk_max_locks</code></a></td></tr><tr><td><a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_set_tx_timestamp.html"><code class="function">DB_ENV-&gt;set_tx_timestamp</code></a></td><td><a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_set_lg_bsize.html"><code class="function">DB_ENV-&gt;set_lg_bsize</code></a></td><td><a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_set_lk_max_objects.html"><code class="function">DB_ENV-&gt;set_lk_max_objects</code></a></td></tr><tr><td><a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_set_tas_spins.html"><code class="function">DB_ENV-&gt;set_tas_spins</code></a></td><td><a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_set_lg_dir.html"><code class="function">DB_ENV-&gt;set_lg_dir</code></a></td><td><a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_set_cachesize.html"><code class="function">DB_ENV-&gt;set_cachesize</code></a></td></tr><tr><td><a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_set_shm_key.html"><code class="function">DB_ENV-&gt;set_shm_key</code></a></td><td><a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_set_lg_max.html"><code class="function">DB_ENV-&gt;set_lg_max</code></a></td><td> </td></tr></table></dd><dt><a id="dbe-get-options"></a><span class="term"><code class="code">(BDB:DBE-GET-OPTIONS dbe
   <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html" target="_top"><code class="literal">&amp;OPTIONAL</code></a> <em class="replaceable"><code>what</code></em>)</code></span></dt><dd><p>Retrieve some environment options.
   </p><div class="variablelist"><p class="title"><b>Values of <em class="replaceable"><code>what</code></em></b></p><dl><dt><span class="term">missing<br /></span><span class="term"><a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_nil.html" target="_top"><code class="constant">NIL</code></a></span></dt><dd>all options as a <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/syscla_list.html" target="_top"><code class="classname">LIST</code></a>
    </dd><dt><span class="term"><code class="constant">:TX-TIMESTAMP</code></span></dt><dd>Recover to the time specified by timestamp
       rather than to the most current possible date
       (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_get_tx_timestamp.html"><code class="function">DB_ENV-&gt;get_tx_timestamp</code></a>)
    </dd><dt><span class="term"><code class="constant">:TX-MAX</code></span></dt><dd>the number of active transactions
       (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_set_tx_max.html"><code class="function">DB_ENV-&gt;set_tx_max</code></a>)
    </dd><dt><span class="term"><code class="constant">:DATA-DIR</code></span></dt><dd>list of data directories
       (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_get_data_dir.html"><code class="function">DB_ENV-&gt;get_data_dir</code></a>)
    </dd><dt><span class="term"><code class="constant">:TMP-DIR</code></span></dt><dd>temporary directory
       (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_get_tmp_dir.html"><code class="function">DB_ENV-&gt;get_tmp_dir</code></a>).
       May be <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_nil.html" target="_top"><code class="constant">NIL</code></a>.</dd><dt><span class="term"><code class="constant">:VERBOSE</code></span></dt><dd>the <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/syscla_list.html" target="_top"><code class="classname">LIST</code></a> of verbosity settings
       (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_get_verbose.html"><code class="function">DB_ENV-&gt;get_verbose</code></a>).
    </dd><dt><span class="term"><code class="constant">:AUTO-COMMIT</code><br /></span><span class="term"><code class="constant">:CDB-ALLDB</code><br /></span><span class="term"><code class="constant">:DIRECT-DB</code><br /></span><span class="term"><code class="constant">:DSYNC-LOG</code><br /></span><span class="term"><code class="constant">:LOG-AUTOREMOVE</code><br /></span><span class="term"><code class="constant">:LOG-INMEMORY</code><br /></span><span class="term"><code class="constant">:DIRECT-LOG</code><br /></span><span class="term"><code class="constant">:NOLOCKING</code><br /></span><span class="term"><code class="constant">:NOMMAP</code><br /></span><span class="term"><code class="constant">:NOPANIC</code><br /></span><span class="term"><code class="constant">:OVERWRITE</code><br /></span><span class="term"><code class="constant">:PANIC-ENVIRONMENT</code><br /></span><span class="term"><code class="constant">:REGION-INIT</code><br /></span><span class="term"><code class="constant">:TXN-NOSYNC</code><br /></span><span class="term"><code class="constant">:TXN-WRITE-NOSYNC</code><br /></span><span class="term"><code class="constant">:YIELDCPU</code><br /></span><span class="term"><code class="constant">:VERB-CHKPOINT</code><br /></span><span class="term"><code class="constant">:VERB-DEADLOCK</code><br /></span><span class="term"><code class="constant">:VERB-RECOVERY</code><br /></span><span class="term"><code class="constant">:VERB-REPLICATION</code><br /></span><span class="term"><code class="constant">:VERB-WAITSFOR</code></span></dt><dd>a <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/typ_boolean.html" target="_top"><code class="classname">BOOLEAN</code></a> indicator of whether this
       option is set or not
       (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_get_verbose.html"><code class="function">DB_ENV-&gt;get_verbose</code></a> and
       <a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_get_flags.html"><code class="function">DB_ENV-&gt;get_flags</code></a>).
    </dd><dt><span class="term"><code class="constant">:LG-BSIZE</code></span></dt><dd>log buffer size
       (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_get_lg_bsize.html"><code class="function">DB_ENV-&gt;get_lg_bsize</code></a>).
    </dd><dt><span class="term"><code class="constant">:LG-DIR</code></span></dt><dd>logging directory
       (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_get_lg_dir.html"><code class="function">DB_ENV-&gt;get_lg_dir</code></a>).
    </dd><dt><span class="term"><code class="constant">:LG-MAX</code></span></dt><dd>log file size
       (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_get_lg_max.html"><code class="function">DB_ENV-&gt;get_lg_max</code></a>).
    </dd><dt><span class="term"><code class="constant">:LG-REGIONMAX</code></span></dt><dd>logging region size
       (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_get_lg_regionmax.html"><code class="function">DB_ENV-&gt;get_lg_regionmax</code></a>).
    </dd><dt><span class="term"><code class="constant">:NCACHE</code><br /></span><span class="term"><code class="constant">:CACHESIZE</code><br /></span><span class="term"><code class="constant">:CACHE</code></span></dt><dd>cache parameters
       (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_get_cachesize.html"><code class="function">DB_ENV-&gt;get_cachesize</code></a>).
    </dd><dt><span class="term"><code class="constant">:LK-CONFLICTS</code></span></dt><dd>lock conflicts matrix
       (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_get_lk_conflicts.html"><code class="function">DB_ENV-&gt;get_lk_conflicts</code></a>).
    </dd><dt><span class="term"><code class="constant">:LK-DETECT</code></span></dt><dd>automatic deadlock detection
       (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_get_lk_detect.html"><code class="function">DB_ENV-&gt;get_lk_detect</code></a>).
    </dd><dt><span class="term"><code class="constant">:LK-MAX-LOCKERS</code></span></dt><dd>maximum number of lockers
       (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_get_lk_max_lockers.html"><code class="function">DB_ENV-&gt;get_lk_max_lockers</code></a>).
    </dd><dt><span class="term"><code class="constant">:LK-MAX-LOCKS</code></span></dt><dd>maximum number of locks
       (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_get_lk_max_locks.html"><code class="function">DB_ENV-&gt;get_lk_max_locks</code></a>).
    </dd><dt><span class="term"><code class="constant">:LK-MAX-OBJECTS</code></span></dt><dd>maximum number of lock objects
       (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_get_lk_max_objects.html"><code class="function">DB_ENV-&gt;get_lk_max_objects</code></a>).
    </dd><dt><span class="term"><code class="constant">:TAS-SPINS</code></span></dt><dd>the number of test-and-set spins
       (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_get_tas_spins.html"><code class="function">DB_ENV-&gt;get_tas_spins</code></a>).
    </dd><dt><span class="term"><code class="constant">:SHM-KEY</code></span></dt><dd>base segment ID for shared memory regions
       (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_get_shm_key.html"><code class="function">DB_ENV-&gt;get_shm_key</code></a>).
    </dd><dt><span class="term"><code class="constant">:LOCK-TIMEOUT</code><br /></span><span class="term"><code class="constant">:TXN-TIMEOUT</code></span></dt><dd>timeout values for locks or transactions in the
       database environment
       (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_get_timeout.html"><code class="function">DB_ENV-&gt;get_timeout</code></a>).
    </dd><dt><span class="term"><code class="constant">:ENCRYPT</code></span></dt><dd>encryption flags
       (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_get_encrypt_flags.html"><code class="function">DB_ENV-&gt;get_encrypt_flags</code></a>).
    </dd><dt><span class="term"><code class="constant">:ERRFILE</code></span></dt><dd><a class="unix" href="http://www.opengroup.org/onlinepubs/009695399/basedefs/xbd_chap03.html#tag_03_165">file descriptor</a> or <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_nil.html" target="_top"><code class="constant">NIL</code></a>
       (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_get_errfile.html"><code class="function">DB_ENV-&gt;get_errfile</code></a>).
    </dd><dt><span class="term"><code class="constant">:MSGFILE</code></span></dt><dd><a class="unix" href="http://www.opengroup.org/onlinepubs/009695399/basedefs/xbd_chap03.html#tag_03_165">file descriptor</a> or <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_nil.html" target="_top"><code class="constant">NIL</code></a>
       (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_get_msgfile.html"><code class="function">DB_ENV-&gt;get_msgfile</code></a>).
    </dd><dt><span class="term"><code class="constant">:ERRPFX</code></span></dt><dd><a class="ulink" href="http://www.lisp.org/HyperSpec/Body/syscla_string.html" target="_top"><code class="classname">STRING</code></a> or <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_nil.html" target="_top"><code class="constant">NIL</code></a>
       (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_get_errpfx.html"><code class="function">DB_ENV-&gt;get_errpfx</code></a>).
    </dd><dt><span class="term"><code class="constant">:DB-XIDDATASIZE</code></span></dt><dd>the <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_length.html" target="_top"><code class="function">LENGTH</code></a> of the globally unique
       <span class="type"><code class="literal">(<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/syscla_vector.html" target="_top"><code class="classname">VECTOR</code></a> (<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/typ_unsigned-byte.html" target="_top"><code class="classname">UNSIGNED-BYTE</code></a> 8))</code></span> which must be passed to
       <a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/txn_prepare.html"><code class="function">DB_TXN-&gt;prepare</code></a>.
    </dd><dt><span class="term"><code class="constant">:HOME</code></span></dt><dd>the home directory when open
       (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_get_home.html"><code class="function">DB_ENV-&gt;get_home</code></a>).
    </dd><dt><span class="term"><code class="constant">:OPEN</code></span></dt><dd>the <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/syscla_list.html" target="_top"><code class="classname">LIST</code></a> of flags passed to <a class="link" href="berkeley-db.html#dbe-open"><code class="function">BDB:DBE-OPEN</code></a>
       (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_get_open_flags.html"><code class="function">DB_ENV-&gt;get_open_flags</code></a>).
    </dd><dt><span class="term"><code class="constant">:CACHE</code></span></dt><dd>database cache information
       (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_get_cachesize.html"><code class="function">DB_ENV-&gt;get_cachesize</code></a>).
    </dd></dl></div></dd></dl></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="bdb-operations"></a>33.6.5. Database Operations</h3></div></div></div>
<!--DB->associate Associate a secondary index DB->err Error message with error string DB->errx Error message-->
<div class="variablelist"><dl><dt><a id="db-create"></a><span class="term"><code class="code">(BDB:DB-CREATE dbe <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html" target="_top"><code class="literal">&amp;KEY</code></a>
   XA)</code></span></dt><dd>Create a database handle
   (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/db_class.html"><code class="function">db_create</code></a>).
</dd><dt><span class="term"><code class="code">(BDB:DB-CLOSE db <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html" target="_top"><code class="literal">&amp;KEY</code></a> NOSYNC)</code></span></dt><dd>Close a database
   (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/db_close.html"><code class="function">DB-&gt;close</code></a>).
   You can also call <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_close.html" target="_top"><code class="function">CLOSE</code></a>.</dd><dt><span class="term"><code class="code">(BDB:DB-DEL dbe key <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html" target="_top"><code class="literal">&amp;KEY</code></a>
   TRANSACTION AUTO-COMMIT)</code></span></dt><dd>Delete items from a database
   (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/db_del.html"><code class="function">DB-&gt;del</code></a>).
</dd><dt><span class="term"><code class="code">(BDB:DB-FD db)</code></span></dt><dd>Return a file descriptor from a database
   (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/db_fd.html"><code class="function">DB-&gt;fd</code></a>).
</dd><dt><span class="term"><code class="code">(BDB:DB-GET db key <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html" target="_top"><code class="literal">&amp;KEY</code></a> ACTION AUTO-COMMIT
   DEGREE-2 DIRTY-READ MULTIPLE RMW TRANSACTION (ERROR <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_t.html" target="_top"><code class="constant">T</code></a>))</code></span></dt><dd><p>Get items from a database
   (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/db_get.html"><code class="function">DB-&gt;get</code></a>).
   If <code class="constant">:ERROR</code> is <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_nil.html" target="_top"><code class="constant">NIL</code></a> and the record is not found, no <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/contyp_error.html" target="_top"><code class="classname">ERROR</code></a> is <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_signal.html" target="_top"><code class="function">SIGNAL</code></a>ed,
   instead <code class="constant">:NOTFOUND</code> is returned.
   <code class="constant">:ACTION</code> should be one of
   </p><table class="simplelist" border="0" summary="Simple list"><tr><td><code class="constant">:CONSUME</code></td><td><code class="constant">:GET-BOTH</code></td></tr><tr><td><code class="constant">:CONSUME-WAIT</code></td><td><code class="constant">:SET-RECNO</code></td></tr></table><p>
</p></dd><dt><span class="term"><code class="code">(BDB:DB-PUT db key val
   <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html" target="_top"><code class="literal">&amp;KEY</code></a> AUTO-COMMIT ACTION TRANSACTION)</code></span></dt><dd><p>Store items into a database
  (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/db_put.html"><code class="function">DB-&gt;put</code></a>).
  <code class="constant">:ACTION</code> should be one of
  </p><table class="simplelist" border="0" summary="Simple list"><tr><td><code class="constant">:APPEND</code></td><td><code class="constant">:NODUPDATA</code></td><td><code class="constant">:NOOVERWRITE</code></td></tr></table><p>
</p></dd><dt><span class="term"><code class="code">(BDB:DB-STAT db <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html" target="_top"><code class="literal">&amp;KEY</code></a> FAST-STAT
   TRANSACTION)</code></span></dt><dd>Return database statistics
   (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/db_get_byteswapped.html"><code class="function">DB-&gt;get_byteswapped</code></a>,
   <a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/db_get_type.html"><code class="function">DB-&gt;get_type</code></a>,
   <a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/db_stat.html"><code class="function">DB-&gt;stat</code></a>).
</dd><dt><a id="db-open"></a><span class="term"><code class="code">(BDB:DB-OPEN db file <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html" target="_top"><code class="literal">&amp;KEY</code></a>
   DATABASE TYPE MODE FLAGS CREATE DIRTY-READ EXCL NOMMAP RDONLY
   THREAD TRUNCATE AUTO-COMMIT TRANSACTION)</code></span></dt><dd><p>Open a database (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/db_open.html"><code class="function">DB-&gt;open</code></a>).
   <code class="constant">:TYPE</code> should be one of
   </p><table class="simplelist" border="0" summary="Simple list"><tr><td><code class="constant">:BTREE</code></td><td><code class="constant">:RECNO</code></td></tr><tr><td><code class="constant">:HASH</code></td><td><code class="constant">:UNKNOWN</code> (default)</td></tr><tr><td><code class="constant">:QUEUE</code></td><td> </td></tr></table><p>
   <code class="constant">:FLAGS</code> may be the value of a previous call
   to <code class="code">(<a class="link" href="berkeley-db.html#db-get-options"><code class="function">BDB:DB-GET-OPTIONS</code></a> db :OPEN)</code>
</p></dd><dt><span class="term"><code class="code">(BDB:DB-SYNC db)</code></span></dt><dd>Flush a database to stable storage
   (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/db_sync.html"><code class="function">DB-&gt;sync</code></a>).
</dd><dt><span class="term"><code class="code">(BDB:DB-TRUNCATE db <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html" target="_top"><code class="literal">&amp;KEY</code></a>
   TRANSACTION AUTO-COMMIT)</code></span></dt><dd>Empty a database
   (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/db_truncate.html"><code class="function">DB-&gt;truncate</code></a>).
</dd><dt><span class="term"><code class="code">(BDB:DB-UPGRADE db file
   <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html" target="_top"><code class="literal">&amp;KEY</code></a> DUPSORT)</code></span></dt><dd>Upgrade a database
   (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/db_upgrade.html"><code class="function">DB-&gt;upgrade</code></a>).
</dd><dt><span class="term"><code class="code">(BDB:DB-RENAME db file database newname)</code></span></dt><dd>Rename a database
   (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/db_rename.html"><code class="function">DB-&gt;rename</code></a>).
</dd><dt><span class="term"><code class="code">(BDB:DB-REMOVE db file database)</code></span></dt><dd>Remove a database
   (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/db_remove.html"><code class="function">DB-&gt;remove</code></a>).
</dd><dt><span class="term"><code class="code">(BDB:DB-JOIN db cursor-sequence
   <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html" target="_top"><code class="literal">&amp;KEY</code></a> JOIN-NOSORT)</code></span></dt><dd>Create a specialized join cursor for use in
   performing equality or natural joins on secondary indices
   (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/db_join.html"><code class="function">DB-&gt;join</code></a>).
</dd><dt><span class="term"><code class="code">(BDB:DB-KEY-RANGE db key
   <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html" target="_top"><code class="literal">&amp;KEY</code></a> TRANSACTION)</code></span></dt><dd>return an estimate of the proportion of keys that
   are less than, equal to, and greater than the specified key
   (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/db_key_range.html"><code class="function">DB-&gt;key_range</code></a>).
   The underlying database must be of type Btree.
</dd><dt><span class="term"><code class="code">(BDB:DB-VERIFY db file <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html" target="_top"><code class="literal">&amp;KEY</code></a>
   DATABASE SALVAGE AGGRESSIVE PRINTABLE NOORDERCHK)</code></span></dt><dd>Verify/salvage a database
   (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/db_verify.html"><code class="function">DB-&gt;verify</code></a>).
   <code class="constant">:SALVAGE</code>, if supplied, should be the output
   file name.  <code class="constant">:DATABASE</code>, if supplied,
   will force <code class="constant">DB_ORDERCHKONLY</code>.
</dd><dt><a id="with-db"></a><span class="term"><code class="code">(BDB:WITH-DB (var dbe file
   <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html" target="_top"><code class="literal">&amp;KEY</code></a> <em class="replaceable"><code>create</code></em> <em class="replaceable"><code>options</code></em> <em class="replaceable"><code>open</code></em>) <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/sec_3-4-4.html" target="_top"><code class="literal">&amp;BODY</code></a> body)</code></span></dt><dd>Open the database, execute <em class="replaceable"><code>body</code></em>, close it.
   <em class="replaceable"><code>create</code></em> is a list of options to be passed to <a class="link" href="berkeley-db.html#db-create"><code class="function">BDB:DB-CREATE</code></a>,
   <em class="replaceable"><code>options</code></em> is a list of options to be passed to <a class="link" href="berkeley-db.html#db-set-options"><code class="function">BDB:DB-SET-OPTIONS</code></a>,
   <em class="replaceable"><code>open</code></em> is a list of options to be passed to <a class="link" href="berkeley-db.html#db-open"><code class="function">BDB:DB-OPEN</code></a>.
</dd></dl></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="bdb-db-config"></a>33.6.6. Database Configuration</h3></div></div></div>
<!--DB->set_alloc Set local space allocation functions DB->set_dup_compare Set a duplicate comparison function DB->set_errcall Set error message callback DB->set_errpfx Set error message prefix DB->set_feedback Set feedback callback DB->set_paniccall Set panic callback DB->set_append_recno Set record append callback DB->set_bt_compare Set a Btree comparison function DB->set_bt_prefix Set a Btree prefix comparison function DB->set_h_hash Set a hashing function-->
<div class="variablelist"><dl><dt><a id="db-set-options"></a><span class="term"><code class="code">(BDB:DB-SET-OPTIONS db
   <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html" target="_top"><code class="literal">&amp;KEY</code></a> ERRFILE MSGFILE ERRPFX PASSWORD ENCRYPTION NCACHE CACHESIZE CACHE
   LORDER PAGESIZE BT-MINKEY H-FFACTOR H-NELEM Q-EXTENTSIZE
   RE-DELIM RE-LEN RE-PAD RE-SOURCE
   CHKSUM ENCRYPT TXN-NOT-DURABLE DUP DUPSORT INORDER RECNUM REVSPLITOFF
   RENUMBER SNAPSHOT)</code></span></dt><dd><p>Set some database options using </p><table class="simplelist" border="0" summary="Simple list"><tr><td><a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_set_errfile.html"><code class="function">DB_ENV-&gt;set_errfile</code></a></td><td><a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/db_set_pagesize.html"><code class="function">DB-&gt;set_pagesize</code></a></td><td><a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/db_set_re_len.html"><code class="function">DB-&gt;set_re_len</code></a></td></tr><tr><td><a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_set_msgfile.html"><code class="function">DB_ENV-&gt;set_msgfile</code></a></td><td><a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/db_set_bt_minkey.html"><code class="function">DB-&gt;set_bt_minkey</code></a></td><td><a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/db_set_re_pad.html"><code class="function">DB-&gt;set_re_pad</code></a></td></tr><tr><td><a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_set_errpfx.html"><code class="function">DB_ENV-&gt;set_errpfx</code></a></td><td><a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/db_set_h_ffactor.html"><code class="function">DB-&gt;set_h_ffactor</code></a></td><td><a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/db_set_re_source.html"><code class="function">DB-&gt;set_re_source</code></a></td></tr><tr><td><a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/db_set_encrypt.html"><code class="function">DB-&gt;set_encrypt</code></a></td><td><a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/db_set_h_nelem.html"><code class="function">DB-&gt;set_h_nelem</code></a></td><td><a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/db_set_flags.html"><code class="function">DB-&gt;set_flags</code></a></td></tr><tr><td><a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/db_set_cachesize.html"><code class="function">DB-&gt;set_cachesize</code></a></td><td><a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/db_set_q_extentsize.html"><code class="function">DB-&gt;set_q_extentsize</code></a></td><td> </td></tr><tr><td><a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/db_set_lorder.html"><code class="function">DB-&gt;set_lorder</code></a></td><td><a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/db_set_re_delim.html"><code class="function">DB-&gt;set_re_delim</code></a></td><td> </td></tr></table></dd><dt><a id="db-get-options"></a><span class="term"><code class="code">(BDB:DB-GET-OPTIONS db
   <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html" target="_top"><code class="literal">&amp;OPTIONAL</code></a> <em class="replaceable"><code>what</code></em>)</code></span></dt><dd><p>Retrieve some database options.
   </p><div class="variablelist"><p class="title"><b>Values of <em class="replaceable"><code>what</code></em></b></p><dl><dt><span class="term">missing<br /></span><span class="term"><a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_nil.html" target="_top"><code class="constant">NIL</code></a></span></dt><dd>all options as a <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/syscla_list.html" target="_top"><code class="classname">LIST</code></a>
    </dd><dt><span class="term"><code class="constant">:FLAGS</code></span></dt><dd>all flags
       (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_get_flags.html"><code class="function">DB_ENV-&gt;get_flags</code></a>).
    </dd><dt><span class="term"><code class="constant">:CHKSUM</code><br /></span><span class="term"><code class="constant">:ENCRYPT</code><br /></span><span class="term"><code class="constant">:TXN-NOT-DURABLE</code><br /></span><span class="term"><code class="constant">:DUP</code><br /></span><span class="term"><code class="constant">:DUPSORT</code><br /></span><span class="term"><code class="constant">:INORDER</code><br /></span><span class="term"><code class="constant">:RECNUM</code><br /></span><span class="term"><code class="constant">:REVSPLITOFF</code><br /></span><span class="term"><code class="constant">:RENUMBER</code><br /></span><span class="term"><code class="constant">:SNAPSHOT</code></span></dt><dd>a <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/typ_boolean.html" target="_top"><code class="classname">BOOLEAN</code></a> indicator of whether this
       option is set or not
       (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_get_verbose.html"><code class="function">DB_ENV-&gt;get_verbose</code></a> and
       <a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_get_flags.html"><code class="function">DB_ENV-&gt;get_flags</code></a>).
    </dd><dt><span class="term"><code class="constant">:CACHE</code></span></dt><dd>database cache information
       (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/db_get_cachesize.html"><code class="function">DB-&gt;get_cachesize</code></a> or
       <a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_get_cachesize.html"><code class="function">DB_ENV-&gt;get_cachesize</code></a> if the
       database was created within an environment).
    </dd><dt><span class="term"><code class="constant">:ENCRYPTION</code></span></dt><dd>encryption flags
       (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_get_encrypt_flags.html"><code class="function">DB_ENV-&gt;get_encrypt_flags</code></a>).
    </dd><dt><span class="term"><code class="constant">:ERRFILE</code></span></dt><dd><a class="unix" href="http://www.opengroup.org/onlinepubs/009695399/basedefs/xbd_chap03.html#tag_03_165">file descriptor</a> or <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_nil.html" target="_top"><code class="constant">NIL</code></a>
       (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_get_errfile.html"><code class="function">DB_ENV-&gt;get_errfile</code></a>).
    </dd><dt><span class="term"><code class="constant">:MSGFILE</code></span></dt><dd><a class="unix" href="http://www.opengroup.org/onlinepubs/009695399/basedefs/xbd_chap03.html#tag_03_165">file descriptor</a> or <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_nil.html" target="_top"><code class="constant">NIL</code></a>
       (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_get_msgfile.html"><code class="function">DB_ENV-&gt;get_msgfile</code></a>).
    </dd><dt><span class="term"><code class="constant">:ERRPFX</code></span></dt><dd><a class="ulink" href="http://www.lisp.org/HyperSpec/Body/syscla_string.html" target="_top"><code class="classname">STRING</code></a> or <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_nil.html" target="_top"><code class="constant">NIL</code></a>
       (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_get_errpfx.html"><code class="function">DB_ENV-&gt;get_errpfx</code></a>).
    </dd><dt><span class="term"><code class="constant">:PAGESIZE</code></span></dt><dd>database page size
       (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/db_get_pagesize.html"><code class="function">DB-&gt;get_pagesize</code></a>).
    </dd><dt><span class="term"><code class="constant">:BT-MINKEY</code></span></dt><dd>the minimum number of key/data pairs intended to
       be stored on any single <code class="constant">:BTREE</code> leaf page
       underlying source file
       (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/db_get_bt_minkey.html"><code class="function">DB-&gt;get_bt_minkey</code></a>).
    </dd><dt><span class="term"><code class="constant">:H-FFACTOR</code></span></dt><dd>the desired density within
       the <code class="constant">:HASH</code> table
       (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/db_get_h_ffactor.html"><code class="function">DB-&gt;get_h_ffactor</code></a>).
    </dd><dt><span class="term"><code class="constant">:H-NELEM</code></span></dt><dd>an estimate of the final size of
       the <code class="constant">:HASH</code> table
       (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/db_get_h_nelem.html"><code class="function">DB-&gt;get_h_nelem</code></a>).
    </dd><dt><span class="term"><code class="constant">:Q-EXTENTSIZE</code></span></dt><dd>the size of the extents used to hold pages in
       a <code class="constant">:QUEUE</code> database
       (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/db_get_q_extentsize.html"><code class="function">DB-&gt;get_q_extentsize</code></a>).
    </dd><dt><span class="term"><code class="constant">:RE-DELIM</code></span></dt><dd>the record delimiter
       for <code class="constant">:RECNO</code> databases
       (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/db_get_re_delim.html"><code class="function">DB-&gt;get_re_delim</code></a>).
    </dd><dt><span class="term"><code class="constant">:RE-LEN</code></span></dt><dd>database record length
       (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/db_get_re_len.html"><code class="function">DB-&gt;get_re_len</code></a>).
    </dd><dt><span class="term"><code class="constant">:RE-PAD</code></span></dt><dd>database record pad byte
       (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/db_get_re_pad.html"><code class="function">DB-&gt;get_re_pad</code></a>).
    </dd><dt><span class="term"><code class="constant">:RE-SOURCE</code></span></dt><dd>the underlying source file
       for <code class="constant">:RECNO</code> databases
       (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/db_get_re_source.html"><code class="function">DB-&gt;get_re_source</code></a>).
    </dd><dt><span class="term"><code class="constant">:LORDER</code></span></dt><dd>database byte order
       (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/db_get_lorder.html"><code class="function">DB-&gt;get_lorder</code></a>).
    </dd><dt><span class="term"><code class="constant">:DBNAME</code></span></dt><dd>the file name and database name
       (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/db_get_dbname.html"><code class="function">DB-&gt;get_dbname</code></a>)
    </dd><dt><span class="term"><code class="constant">:TRANSACTIONAL</code></span></dt><dd>the indicator whether the database is transactional
       (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/db_get_transactional.html"><code class="function">DB-&gt;get_transactional</code></a>).
    </dd><dt><span class="term"><code class="constant">:OPEN</code></span></dt><dd>the flags passed to <a class="link" href="berkeley-db.html#db-open"><code class="function">BDB:DB-OPEN</code></a>
       (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/db_get_open_flags.html"><code class="function">DB-&gt;get_open_flags</code></a>).
    </dd></dl></div><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Warning</h3><p>Once you call a method for one type of access method,
    the handle can only be used for that type.
    The methods <a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/db_get_re_delim.html"><code class="function">DB-&gt;get_re_delim</code></a>
    and <a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/db_get_re_source.html"><code class="function">DB-&gt;get_re_source</code></a> are for
    a <code class="constant">:RECNO</code> database so
    you <span class="emphasis"><em>cannot</em></span> call them
    (by passing <code class="constant">:RE-DELIM</code>
    or <code class="constant">:RE-SOURCE</code> to this function)
    and then use the database handle to open a database of different type
    (e.g., <code class="constant">:QUEUE</code>).</p></div></dd></dl></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="bdb-cursor"></a>33.6.7. Database Cursor Operations</h3></div></div></div><div class="variablelist"><dl><dt><a id="make-dbc"></a><span class="term"><code class="code">(BDB:MAKE-DBC db <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html" target="_top"><code class="literal">&amp;KEY</code></a>
   DEGREE-2 DIRTY-READ WRITECURSOR TRANSACTION)</code></span></dt><dd>Create a cursor handle
   (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/db_cursor.html"><code class="function">DB-&gt;cursor</code></a>).
</dd><dt><span class="term"><code class="code">(BDB:DBC-CLOSE cursor)</code></span></dt><dd>Close the cursor handle
   (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/dbc_close.html"><code class="function">DBCursor-&gt;close</code></a>).
   You can also call <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_close.html" target="_top"><code class="function">CLOSE</code></a>.</dd><dt><span class="term"><code class="code">(BDB:DBC-COUNT cursor)</code></span></dt><dd>Return count of duplicates
   (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/dbc_count.html"><code class="function">DBCursor-&gt;count</code></a>).
</dd><dt><span class="term"><code class="code">(BDB:DBC-DEL cursor)</code></span></dt><dd>Delete by cursor
   (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/dbc_del.html"><code class="function">DBCursor-&gt;del</code></a>).
</dd><dt><span class="term"><code class="code">(BDB:DBC-DUP cursor <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html" target="_top"><code class="literal">&amp;KEY</code></a> POSITION)</code></span></dt><dd>Duplicate a cursor
   (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/dbc_dup.html"><code class="function">DBCursor-&gt;dup</code></a>).
</dd><dt><span class="term"><code class="code">(BDB:DBC-GET cursor key data action
   <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html" target="_top"><code class="literal">&amp;KEY</code></a> DEGREE-2 DIRTY-READ MULTIPLE (ERROR <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_t.html" target="_top"><code class="constant">T</code></a>))</code></span></dt><dd><p>Retrieve by cursor
   (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/dbc_get.html"><code class="function">DBCursor-&gt;get</code></a>).
   If <code class="constant">:ERROR</code> is <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_nil.html" target="_top"><code class="constant">NIL</code></a> and the record is not found, no <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/contyp_error.html" target="_top"><code class="classname">ERROR</code></a> is <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_signal.html" target="_top"><code class="function">SIGNAL</code></a>ed,
   <code class="constant">:NOTFOUND</code> or <code class="constant">:KEYEMPTY</code>
   is returned instead, as appropriate.
   <em class="replaceable"><code>action</code></em> should be one of
   </p><table class="simplelist" border="0" summary="Simple list"><tr><td><code class="constant">:CURRENT</code></td><td><code class="constant">:GET-RECNO</code></td><td><code class="constant">:NEXT-DUP</code></td><td><code class="constant">:SET</code></td></tr><tr><td><code class="constant">:FIRST</code></td><td><code class="constant">:JOIN-ITEM</code></td><td><code class="constant">:NEXT-NODUP</code></td><td><code class="constant">:SET-RANGE</code></td></tr><tr><td><code class="constant">:GET-BOTH</code></td><td><code class="constant">:LAST</code></td><td><code class="constant">:PREV</code></td><td><code class="constant">:SET-RECNO</code></td></tr><tr><td><code class="constant">:GET-BOTH-RANGE</code></td><td><code class="constant">:NEXT</code></td><td><code class="constant">:PREV-NODUP</code></td><td> </td></tr></table><p>
</p></dd><dt><span class="term"><code class="code">(BDB:DBC-PUT cursor key data
   flag)</code></span></dt><dd>Store by cursor
   (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/dbc_put.html"><code class="function">DBCursor-&gt;put</code></a>).
</dd><dt><span class="term"><code class="code">(BDB:WITH-DBC (var <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html" target="_top"><code class="literal">&amp;REST</code></a>
   <em class="replaceable"><code>options</code></em>) <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/sec_3-4-4.html" target="_top"><code class="literal">&amp;BODY</code></a> <em class="replaceable"><code>body</code></em>))</code></span></dt><dd>Open a cursor, execute <em class="replaceable"><code>body</code></em>, close it.
   <em class="replaceable"><code>options</code></em> are passed to <a class="link" href="berkeley-db.html#make-dbc"><code class="function">BDB:MAKE-DBC</code></a>.
</dd></dl></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="bdb-lock"></a>33.6.8. Lock Subsystem</h3></div></div></div><div class="variablelist"><dl><dt><span class="term"><code class="code">(BDB:LOCK-DETECT dbe action)</code></span></dt><dd>Perform deadlock detection
   (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_lock_detect.html"><code class="function">DB_ENV-&gt;lock_detect</code></a>).
</dd><dt><span class="term"><code class="code">(BDB:LOCK-ID dbe)</code></span></dt><dd>Acquire a locker ID
  (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_lock_id.html"><code class="function">DB_ENV-&gt;lock_id</code></a>).
</dd><dt><span class="term"><code class="code">(BDB:LOCK-ID-FREE dbe id)</code></span></dt><dd>Release a locker ID
   (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_lock_id_free.html"><code class="function">DB_ENV-&gt;lock_id_free</code></a>).
   All associated locks should be released first.
</dd><dt><span class="term"><code class="code">(BDB:LOCK-GET dbe object locker
   mode <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html" target="_top"><code class="literal">&amp;KEY</code></a> NOWAIT)</code></span></dt><dd>Acquire a lock
   (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_lock_get.html"><code class="function">DB_ENV-&gt;lock_get</code></a>).
   The <span class="type">BDB:DBLOCK</span> object returned by this function will
   <span class="strong"><strong>not</strong></span> be released when the environment is closed.
   This permits long-lived locks.</dd><dt><span class="term"><code class="code">(BDB:LOCK-PUT dbe lock)</code></span></dt><dd>Release a lock
   (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_lock_put.html"><code class="function">DB_ENV-&gt;lock_put</code></a>).
</dd><dt><span class="term"><code class="code">(BDB:LOCK-CLOSE lock)</code></span></dt><dd><p>Release a lock
   (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_lock_put.html"><code class="function">DB_ENV-&gt;lock_put</code></a>) using the
   environment with which it has been acquired.
   This is used to <a class="link" href="final.html" title="31.8. Finalization"><code class="function">EXT:FINALIZE</code></a> <span class="type">BDB:DBLOCK</span> objects.</p><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Warning</h3><p>If that environment has already been closed, you are
    in a big trouble (segfault), so you better release your locks or do
    not drop them.</p></div></dd><dt><span class="term"><code class="code">(BDB:LOCK-STAT dbe <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html" target="_top"><code class="literal">&amp;KEY</code></a>
   STAT-CLEAR)</code></span></dt><dd>Return lock subsystem statistics
   (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_lock_stat.html"><code class="function">DB_ENV-&gt;lock_stat</code></a>).
</dd></dl></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="bdb-log"></a>33.6.9. Log Subsystem</h3></div></div></div><div class="toc"><dl><dt><span class="section"><a href="berkeley-db.html#bdb-log-cursor">33.6.9.1. Log Cursor Operations</a></span></dt><dt><span class="section"><a href="berkeley-db.html#bdb-log-seq">33.6.9.2. Log Sequence Numbers</a></span></dt></dl></div><div class="variablelist"><dl><dt><span class="term"><code class="code">(BDB:LOG-ARCHIVE dbe
   <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html" target="_top"><code class="literal">&amp;KEY</code></a> ARCH-ABS ARCH-DATA ARCH-LOG ARCH-REMOVE)</code></span></dt><dd>Return a list of log or database filenames
   (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_log_archive.html"><code class="function">DB_ENV-&gt;log_archive</code></a>).
</dd><dt><span class="term"><code class="code">(BDB:LOG-FILE dbe lsn)</code></span></dt><dd>Return the name of the file containing the record
   named by <em class="replaceable"><code>lsn</code></em>
   (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_log_file.html"><code class="function">DB_ENV-&gt;log_file</code></a>).
</dd><dt><span class="term"><code class="code">(BDB:LOG-FLUSH dbe lsn)</code></span></dt><dd>Flush log records to disk
   (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_log_flush.html"><code class="function">DB_ENV-&gt;log_flush</code></a>).
</dd><dt><span class="term"><code class="code">(BDB:LOG-PUT dbe data
   <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html" target="_top"><code class="literal">&amp;KEY</code></a> :FLUSH)</code></span></dt><dd>Write a log record
   (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_log_put.html"><code class="function">DB_ENV-&gt;log_put</code></a>).
</dd><dt><span class="term"><code class="code">(BDB:LOG-STAT dbe
   <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html" target="_top"><code class="literal">&amp;KEY</code></a> STAT-CLEAR)</code></span></dt><dd>Logging subsystem statistics
   (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_log_stat.html"><code class="function">DB_ENV-&gt;log_stat</code></a>).
</dd></dl></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="bdb-log-cursor"></a>33.6.9.1. Log Cursor Operations</h4></div></div></div><div class="variablelist"><dl><dt><span class="term"><code class="code">(BDB:LOG-CURSOR dbe)</code></span></dt><dd>Create a log cursor handle
   (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_log_cursor.html"><code class="function">DB_ENV-&gt;log_cursor</code></a>).
</dd><dt><span class="term"><code class="code">(BDB:LOGC-CLOSE logc)</code></span></dt><dd>Close a log cursor handle
   (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/logc_close.html"><code class="function">DB_LOGC-&gt;close</code></a>).
</dd><dt><span class="term"><code class="code">(BDB:LOGC-GET logc action
   <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html" target="_top"><code class="literal">&amp;KEY</code></a> TYPE ERROR)</code></span></dt><dd><p>Retrieve a log record
   (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/logc_get.html"><code class="function">DB_LOGC-&gt;get</code></a>).
   If <code class="constant">:ERROR</code> is <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_nil.html" target="_top"><code class="constant">NIL</code></a> and the record is not found, no <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/contyp_error.html" target="_top"><code class="classname">ERROR</code></a> is <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_signal.html" target="_top"><code class="function">SIGNAL</code></a>ed,
   <code class="constant">:NOTFOUND</code> is returned instead.
   </p><div class="variablelist"><p class="title"><b>Valid <em class="replaceable"><code>action</code></em>s</b></p><dl><dt><span class="term"><code class="constant">:CURRENT</code><br /></span><span class="term"><code class="constant">:FIRST</code><br /></span><span class="term"><code class="constant">:LAST</code><br /></span><span class="term"><code class="constant">:NEXT</code><br /></span><span class="term"><code class="constant">:PREV</code></span></dt><dd>Retrieve the appropriate record.
    </dd><dt><span class="term"><span class="type">DB:LSN</span></span></dt><dd>Retrieve the specified record, as
       with <code class="constant">DB_SET</code>.
   </dd></dl></div><p>
   Returns two values: the datum of type specified by the <code class="constant">:TYPE</code>
   argument and the <span class="type">DB:LSN</span> value of the record retrieved
   (when <em class="replaceable"><code>action</code></em> is a <span class="type">DB:LSN</span>, it
   is returned unchanged).
</p></dd></dl></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="bdb-log-seq"></a>33.6.9.2. Log Sequence Numbers</h4></div></div></div><p>Use <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_equalp.html" target="_top"><code class="function">EQUALP</code></a> to check similarity of <span class="type">BDB:LSN</span> objects.</p><div class="variablelist"><dl><dt><span class="term"><code class="code">(BDB:LOG-COMPARE lsn1 lsn2)</code></span></dt><dd>Compare two Log Sequence Numbers
   (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/log_compare.html"><code class="function">log_compare</code></a>).
</dd></dl></div></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="bdb-mem-pool"></a>33.6.10. Memory Pool Subsystem</h3></div></div></div><p>not implemented yet, patches are welcome</p>
<!--DB_ENV->set_cachesize Set the environment cache size DB_ENV->set_mp_mmapsize Set maximum mapped-in database file size DB_ENV->memp_register Register input/output functions for a file in a memory pool DB_ENV->memp_stat Return memory pool statistics DB_ENV->memp_sync Flush pages from a memory pool DB_ENV->memp_trickle Trickle flush pages from a memory pool Memory Pool Files DB_ENV->memp_fcreate Open a file in a memory pool DB_MPOOLFILE->close Close a file in a memory pool DB_MPOOLFILE->get Get page from a file in a memory pool DB_MPOOLFILE->open Open a file in a memory pool DB_MPOOLFILE->put Return a page to a memory pool DB_MPOOLFILE->set Set memory pool page status DB_MPOOLFILE->sync Flush pages from a file in a memory pool DB_MPOOLFILE->set_clear_len Set file page bytes to be cleared DB_MPOOLFILE->set_fileid Set file unique identifier DB_MPOOLFILE->set_ftype Set file type DB_MPOOLFILE->set_lsn_offset Set file log-sequence-number offset DB_MPOOLFILE->set_pgcookie Set file cookie for pgin/pgout-->
<!--variablelist> <varlistentry><term><code>()</code></term> <listitem><simpara></simpara></listitem></varlistentry> </variablelist-->
</div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="bdb-replication"></a>33.6.11. Replication</h3></div></div></div><p>not implemented yet, patches are welcome</p>
<!--DB_ENV->set_rep_transport Configure replication transport DB_ENV->rep_elect Hold a replication election DB_ENV->set_rep_limit Limit data sent in response to a single message DB_ENV->rep_process_message Process a replication message DB_ENV->rep_start Configure an environment for replication DB_ENV->rep_stat Replication statistics-->
<!--variablelist> <varlistentry><term><code>()</code></term> <listitem><simpara></simpara></listitem></varlistentry> </variablelist-->
</div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="bdb-sequences"></a>33.6.12. Sequences</h3></div></div></div><p>not implemented yet, patches are welcome</p>
<!--Sequences and Related Methods Description db_sequence_create Create a sequence handle DB_SEQUENCE->close Close a sequence DB_SEQUENCE->get Get the next sequence element(s) DB_SEQUENCE->get_dbp Return a handle for the underlying sequence database DB_SEQUENCE->get_key Return the key for a sequence DB_SEQUENCE->init_value Set the initial value of a sequence DB_SEQUENCE->open Open a sequence DB_SEQUENCE->remove Remove a sequence DB_SEQUENCE->stat Return sequence statistics Sequences Configuration DB_SEQUENCE->set_cachesize Set the cache size of a sequence DB_SEQUENCE->set_flags Set the flags for a sequence DB_SEQUENCE->set_range Set the range for a sequence-->
<!--variablelist> <varlistentry><term><code>()</code></term> <listitem><simpara></simpara></listitem></varlistentry> </variablelist-->
</div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="bdb-transaction"></a>33.6.13. Transaction Subsystem</h3></div></div></div><div class="variablelist"><dl><dt><span class="term"><code class="code">(BDB:TXN-BEGIN dbe <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html" target="_top"><code class="literal">&amp;KEY</code></a>
   DEGREE-2 PARENT DIRTY-READ NOSYNC NOWAIT SYNC)</code></span></dt><dd>Begin a transaction
   (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_txn_begin.html"><code class="function">DB_ENV-&gt;txn_begin</code></a>).
</dd><dt><span class="term"><code class="code">(BDB:TXN-ABORT txn)</code></span></dt><dd>Abort a transaction
   (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/txn_abort.html"><code class="function">DB_TXN-&gt;abort</code></a>).
</dd><dt><span class="term"><code class="code">(BDB:TXN-COMMIT txn <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html" target="_top"><code class="literal">&amp;KEY</code></a>
   NOSYNC SYNC)</code></span></dt><dd>Commit a transaction
   (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/txn_commit.html"><code class="function">DB_TXN-&gt;commit</code></a>).
</dd><dt><span class="term"><code class="code">(BDB:TXN-DISCARD txn)</code></span></dt><dd>Discard a transaction
   (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/txn_discard.html"><code class="function">DB_TXN-&gt;discard</code></a>).
</dd><dt><span class="term"><code class="code">(BDB:TXN-ID txn)</code></span></dt><dd>Return the transaction's ID
   (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/txn_id.html"><code class="function">DB_TXN-&gt;id</code></a>).
</dd><dt><span class="term"><code class="code">(BDB:TXN-CHECKPOINT dbe
   <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html" target="_top"><code class="literal">&amp;KEY</code></a> KBYTE MIN FORCE)</code></span></dt><dd>Checkpoint the transaction subsystem
   (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_txn_checkpoint.html"><code class="function">DB_ENV-&gt;txn_checkpoint</code></a>).
</dd><dt><span class="term"><code class="code">(BDB:TXN-PREPARE txn id)</code></span></dt><dd>Initiate the beginning of a two-phase commit
   (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/txn_prepare.html"><code class="function">DB_TXN-&gt;prepare</code></a>).
</dd><dt><span class="term"><code class="code">(BDB:TXN-RECOVER dbe <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html" target="_top"><code class="literal">&amp;KEY</code></a>
   FIRST NEXT)</code></span></dt><dd>Return a list of prepared but not yet resolved
   transactions (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_txn_recover.html"><code class="function">DB_ENV-&gt;txn_recover</code></a>).
</dd><dt><span class="term"><code class="code">(BDB:TXN-SET-TIMEOUT txn
   timeout which)</code></span></dt><dd>Set timeout values for locks or transactions for the
   specified transaction
   (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/txn_set_timeout.html"><code class="function">DB_TXN-&gt;set_timeout</code></a>).
</dd><dt><span class="term"><code class="code">(BDB:TXN-STAT dbe <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html" target="_top"><code class="literal">&amp;KEY</code></a>
   STAT-CLEAR)</code></span></dt><dd>Transaction subsystem statistics
   (<a class="bdb" href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_txn_stat.html"><code class="function">DB_ENV-&gt;txn_stat</code></a>).
</dd></dl></div></div></div><div class="bookinfo"><hr /><table width="100%" summary="impnotes meta info"><th><td align="left">These notes document <a class="ulink" href="http://clisp.cons.org" target="_top"><span class="command"><strong>CLISP</strong></span></a> version 2.46</td><td align="right">Last modified: 2008-07-02</td></th></table></div><div class="custom-footer"><hr /><table width="100%"><tr><td align="left"><a href="http://clisp.cons.org"><img src="clisp.png" width="48" height="48" alt="[CLISP home]" /></a></td><td align="center"><a href="http://sourceforge.net/donate/index.php?group_id=1355"><img src="http://images.sourceforge.net/images/project-support.jpg" width="88" height="32" alt="[Support CLISP]" /></a></td><td align="right"><a href="http://sourceforge.net"><img width="125" height="37" alt="[SourceForge]" src="http://sflogo.sourceforge.net/sflogo.php?group_id=1355&amp;type=2&amp;page=berkeley-db" /></a></td></tr></table></div><hr /><form method="get" action="http://www.google.com/custom" target="_top"><table width="100%" border="0"><tr><td nowrap="nowrap" align="center"><input type="hidden" name="domains" value="clisp.cons.org;clisp.podval.org;www.lisp.org" /><label for="sbi" style="display: none">Enter your search terms</label><input type="text" name="q" size="50" maxlength="255" id="sbi" value="33.6. Berkeley DB access" /><label for="sbb" style="display: none">Submit search form</label><input type="submit" name="sa" value="Google Search" id="sbb" /></td></tr><tr><td nowrap="nowrap" align="center"><input type="radio" name="sitesearch" value="" checked="1" id="ss0" /><label for="ss0" title="Search the Web"><small>Web</small></label><input type="radio" name="sitesearch" value="clisp.cons.org" id="ss1" /><label for="ss1" title="Search clisp.cons.org"><small>clisp.cons.org</small></label><input type="radio" name="sitesearch" value="clisp.podval.org" id="ss2" /><label for="ss2" title="Search clisp.podval.org"><small>clisp.podval.org</small></label><input type="radio" name="sitesearch" value="www.lisp.org" id="ss3" /><label for="ss3" title="Search www.lisp.org"><small>www.lisp.org</small></label><input type="hidden" name="client" value="pub-4445255502750357" /><input type="hidden" name="forid" value="1" /><input type="hidden" name="ie" value="UTF-8" /><input type="hidden" name="oe" value="UTF-8" /><input type="hidden" name="cof" value="GALT:#008000;GL:1;DIV:#336699;VLC:663399;AH:center;BGC:FFFFFF;LBGC:000000;ALC:0000FF;LC:0000FF;T:000000;GFNT:0000FF;GIMP:0000FF;LH:48;LW:48;L:http://clisp.cons.org/clisp.png;S:http://clisp.cons.org;FORID:1" /><input type="hidden" name="hl" value="en" /></td></tr></table></form><hr /><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="gdbm.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="ext-modules.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="dir-key.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">33.5. GDBM - The GNU database manager </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> 33.7. Directory Access</td></tr></table></div></body></html>
