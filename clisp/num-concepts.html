<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>12.2. Number Concepts</title><link rel="stylesheet" href="impnotes.css" type="text/css" /><link rev="made" href="mailto:clisp-list@lists.sourceforge.net" /><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot_7566" /><link rel="start" href="index.html" title="Implementation Notes for GNU CLISP" /><link rel="up" href="numbers.html" title="Chapter 12. Numbers" /><link rel="prev" href="num-types.html" title="12.1. Numeric Types" /><link rel="next" href="characters.html" title="Chapter 13. Characters" /><link rel="copyright" href="legalese.html" title="Legal Status of the CLISP Implementation Notes" /><meta name="date" content="'generated: 2008-07-02 11:52:30-04:00'" /><link rel="author" title="Authors" href="index.html#authors" /><link rel="contents" title="Table of Contents" href="index.html" /><link rel="glossary" href="glossary.html" /><link rel="help" href="faq.html#faq-help" title="How do I ask for help?" /><link rel="home" title="Home" href="http://clisp.cons.org" /><link rel="index" href="idx.html" /></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">12.2. Number Concepts
  </th></tr><tr><td width="20%" align="left"><a accesskey="p" href="num-types.html">Prev</a> </td><th width="60%" align="center">Chapter 12. Numbers </th><td width="20%" align="right"> <a accesskey="n" href="characters.html">Next</a></td></tr></table><hr /></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="num-concepts"></a>12.2. Number Concepts
  <a class="clhs" href="http://www.lisp.org/HyperSpec/Body/sec_12-1.html">[sec_12-1]</a></h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="num-concepts.html#num-ops">12.2.1. Numeric Operations
  </a></span></dt><dd><dl><dt><span class="section"><a href="num-concepts.html#int-func-ext">12.2.1.1. Additional Integer Functions</a></span></dt><dt><span class="section"><a href="num-concepts.html#float-decode">12.2.1.2. Function <code class="function">DECODE-FLOAT</code></a></span></dt><dt><span class="section"><a href="num-concepts.html#bool-ops">12.2.1.3. Boolean Operations
  </a></span></dt><dt><span class="section"><a href="num-concepts.html#byte-type">12.2.1.4. Byte Operations on Integers
  </a></span></dt><dt><span class="section"><a href="num-concepts.html#float-notes">12.2.1.5. Floating Point Arithmetics</a></span></dt></dl></dd><dt><span class="section"><a href="num-concepts.html#num-const">12.2.2. Implementation-Dependent Numeric Constants
  </a></span></dt><dd><dl><dt><span class="section"><a href="num-concepts.html#fixnum-lim">12.2.2.1. Fixnum Limits</a></span></dt><dt><span class="section"><a href="num-concepts.html#bignum-lim">12.2.2.2. Bignum Limits</a></span></dt><dt><span class="section"><a href="num-concepts.html#float-lim">12.2.2.3. Float Limits</a></span></dt></dl></dd><dt><span class="section"><a href="num-concepts.html#float-subst">12.2.3. Rule of Float Substitutability
  </a></span></dt><dt><span class="section"><a href="num-concepts.html#float-comp">12.2.4. Floating-point Computations
  </a></span></dt><dd><dl><dt><span class="section"><a href="num-concepts.html#flocont">12.2.4.1. Rule of Float Precision Contagion
  </a></span></dt><dt><span class="section"><a href="num-concepts.html#floratcont">12.2.4.2. Rule of Float and Rational Contagion
  </a></span></dt></dl></dd><dt><span class="section"><a href="num-concepts.html#complex-comp">12.2.5. Complex Computations
  </a></span></dt><dt><span class="section"><a href="num-concepts.html#complex-rational">12.2.6. Rule of Canonical Representation
  for Complex Rationals </a></span></dt><dt><span class="section"><a href="num-concepts.html#random-state">12.2.7. Random-State Operations
  </a></span></dt></dl></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="num-ops"></a>12.2.1. Numeric Operations
  <a class="clhs" href="http://www.lisp.org/HyperSpec/Body/sec_12-1-1.html">[sec_12-1-1]</a></h3></div></div></div><div class="toc"><dl><dt><span class="section"><a href="num-concepts.html#int-func-ext">12.2.1.1. Additional Integer Functions</a></span></dt><dt><span class="section"><a href="num-concepts.html#float-decode">12.2.1.2. Function <code class="function">DECODE-FLOAT</code></a></span></dt><dt><span class="section"><a href="num-concepts.html#bool-ops">12.2.1.3. Boolean Operations
  </a></span></dt><dt><span class="section"><a href="num-concepts.html#byte-type">12.2.1.4. Byte Operations on Integers
  </a></span></dt><dt><span class="section"><a href="num-concepts.html#float-notes">12.2.1.5. Floating Point Arithmetics</a></span></dt></dl></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="int-func-ext"></a>12.2.1.1. Additional Integer Functions</h4></div></div></div><p><a id="factorial"></a><b>Function <code class="function">EXT:!</code> </b><code class="code">(<code class="function">EXT:!</code> <em class="replaceable"><code>n</code></em>)</code> returns the
 factorial of <em class="replaceable"><code>n</code></em>, <em class="replaceable"><code>n</code></em> being a nonnegative <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/syscla_integer.html" target="_top"><code class="classname">INTEGER</code></a>.</p><p><a id="exquo"></a><b>Function <code class="function">EXT:EXQUO</code>. </b><code class="code">(<code class="function">EXT:EXQUO</code> <em class="replaceable"><code>x</code></em> <em class="replaceable"><code>y</code></em>)</code> returns
 the integer quotient <code class="varname">x/y</code> of two integers
 <em class="replaceable"><code>x</code></em>,<em class="replaceable"><code>y</code></em>, and <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_signal.html" target="_top"><code class="function">SIGNAL</code></a>s an <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/contyp_error.html" target="_top"><code class="classname">ERROR</code></a> when the quotient is not
 integer.  (This is more efficient than <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_sl.html" target="_top"><code class="function">/</code></a>.)</p><p><a id="xgcd"></a><b>Function <code class="function">EXT:XGCD</code>. </b><code class="code">(<code class="function">EXT:XGCD</code> <em class="replaceable"><code>x<sub>1</sub></code></em> ... <em class="replaceable"><code>x<sub>n</sub></code></em>)</code>
 returns the values <em class="replaceable"><code>l</code></em>, <em class="replaceable"><code>k<sub>1</sub></code></em>, ..., <em class="replaceable"><code>k<sub>n</sub></code></em>, where <em class="replaceable"><code>l</code></em> is the
 greatest common divisor of the integers <em class="replaceable"><code>x<sub>1</sub></code></em>, ..., <em class="replaceable"><code>x<sub>n</sub></code></em>, and
 <em class="replaceable"><code>k<sub>1</sub></code></em>, ..., <em class="replaceable"><code>k<sub>n</sub></code></em> are the integer coefficients such that
</p><pre class="programlisting">
<em class="replaceable"><code>l</code></em> = (<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_gcd.html" target="_top"><code class="function">GCD</code></a> <em class="replaceable"><code>x<sub>1</sub></code></em> ... <em class="replaceable"><code>x<sub>n</sub></code></em>)
  = (+ (* <em class="replaceable"><code>k<sub>1</sub></code></em> <em class="replaceable"><code>x<sub>1</sub></code></em>) ... (* <em class="replaceable"><code>k<sub>n</sub></code></em> <em class="replaceable"><code>x<sub>n</sub></code></em>))
</pre><p><a id="mod-expt"></a><b>Function <a class="link" href="num-concepts.html#mod-expt" title="Function EXT:MOD-EXPT"><code class="function">EXT:MOD-EXPT</code></a>. </b><code class="code">(<a class="link" href="num-concepts.html#mod-expt" title="Function EXT:MOD-EXPT"><code class="function">EXT:MOD-EXPT</code></a> <em class="replaceable"><code>k</code></em> <em class="replaceable"><code>l</code></em> <em class="replaceable"><code>m</code></em>)</code>
 is equivalent to <code class="code">(<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_modcm_rem.html" target="_top"><code class="function">MOD</code></a> (<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_expcm_expt.html" target="_top"><code class="function">EXPT</code></a> <em class="replaceable"><code>k</code></em> <em class="replaceable"><code>l</code></em>) <em class="replaceable"><code>m</code></em>)</code>
 except it is more efficient for very large arguments.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="float-decode"></a>12.2.1.2. Function <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_decode-fl_decode-float.html" target="_top"><code class="function">DECODE-FLOAT</code></a></h4></div></div></div><p><a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_decode-fl_decode-float.html" target="_top"><code class="function">FLOAT-RADIX</code></a> always returns <span class="returnvalue">2</span>.</p><p><code class="code">(<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_decode-fl_decode-float.html" target="_top"><code class="function">FLOAT-DIGITS</code></a> <em class="replaceable"><code>number</code></em> <em class="replaceable"><code>digits</code></em>)</code> coerces
 <em class="replaceable"><code>number</code></em> (a <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/syscla_real.html" target="_top"><code class="classname">REAL</code></a>) to a floating point number with at least
 <em class="replaceable"><code>digits</code></em> mantissa digits.  The following always evaluates to <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_t.html" target="_top"><code class="constant">T</code></a>:
 </p><pre class="programlisting">
(<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_eqcm_sleq__lteqcm_gteq.html" target="_top"><code class="function">&gt;=</code></a> (<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_decode-fl_decode-float.html" target="_top"><code class="function">FLOAT-DIGITS</code></a> (<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_decode-fl_decode-float.html" target="_top"><code class="function">FLOAT-DIGITS</code></a> <em class="replaceable"><code>number</code></em> <em class="replaceable"><code>digits</code></em>)) <em class="replaceable"><code>digits</code></em>)
</pre></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="bool-ops"></a>12.2.1.3. Boolean Operations
  <a class="clhs" href="http://www.lisp.org/HyperSpec/Body/convar_boole-_cm_boole-xor.html">[convar_boole-_cm_boole-xor]</a></h4></div></div></div><div class="table"><a id="bool-op-table"></a><p class="title"><b>Table 12.1. Boolean operations</b></p><div class="table-contents"><table summary="Boolean operations" border="1"><colgroup><col /><col /></colgroup><thead><tr><th align="left">constant</th><th align="left">value</th></tr></thead><tbody><tr><td align="left"><a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_boole-_cm_boole-xor.html" target="_top"><code class="constant">BOOLE-CLR</code></a></td><td align="left">0</td></tr><tr><td align="left"><a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_boole-_cm_boole-xor.html" target="_top"><code class="constant">BOOLE-SET</code></a></td><td align="left">15</td></tr><tr><td align="left"><a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_boole-_cm_boole-xor.html" target="_top"><code class="constant">BOOLE-1</code></a></td><td align="left">10</td></tr><tr><td align="left"><a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_boole-_cm_boole-xor.html" target="_top"><code class="constant">BOOLE-2</code></a></td><td align="left">12</td></tr><tr><td align="left"><a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_boole-_cm_boole-xor.html" target="_top"><code class="constant">BOOLE-C1</code></a></td><td align="left">5</td></tr><tr><td align="left"><a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_boole-_cm_boole-xor.html" target="_top"><code class="constant">BOOLE-C2</code></a></td><td align="left">3</td></tr><tr><td align="left"><a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_boole-_cm_boole-xor.html" target="_top"><code class="constant">BOOLE-AND</code></a></td><td align="left">8</td></tr><tr><td align="left"><a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_boole-_cm_boole-xor.html" target="_top"><code class="constant">BOOLE-IOR</code></a></td><td align="left">14</td></tr><tr><td align="left"><a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_boole-_cm_boole-xor.html" target="_top"><code class="constant">BOOLE-XOR</code></a></td><td align="left">6</td></tr><tr><td align="left"><a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_boole-_cm_boole-xor.html" target="_top"><code class="constant">BOOLE-EQV</code></a></td><td align="left">9</td></tr><tr><td align="left"><a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_boole-_cm_boole-xor.html" target="_top"><code class="constant">BOOLE-NAND</code></a></td><td align="left">7</td></tr><tr><td align="left"><a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_boole-_cm_boole-xor.html" target="_top"><code class="constant">BOOLE-NOR</code></a></td><td align="left">1</td></tr><tr><td align="left"><a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_boole-_cm_boole-xor.html" target="_top"><code class="constant">BOOLE-ANDC1</code></a></td><td align="left">4</td></tr><tr><td align="left"><a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_boole-_cm_boole-xor.html" target="_top"><code class="constant">BOOLE-ANDC2</code></a></td><td align="left">2</td></tr><tr><td align="left"><a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_boole-_cm_boole-xor.html" target="_top"><code class="constant">BOOLE-ORC1</code></a></td><td align="left">13</td></tr><tr><td align="left"><a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_boole-_cm_boole-xor.html" target="_top"><code class="constant">BOOLE-ORC2</code></a></td><td align="left">11</td></tr></tbody></table></div></div><br class="table-break" /></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="byte-type"></a>12.2.1.4. Byte Operations on Integers
  <a class="clhs" href="http://www.lisp.org/HyperSpec/Body/sec_12-1-1-3-2.html">[sec_12-1-1-3-2]</a></h4></div></div></div><p>Byte specifiers are objects of built-in type <a class="link" href="num-concepts.html#byte-type" title="12.2.1.4. Byte Operations on Integers"><span class="type">BYTE</span></a>,
 not <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/syscla_integer.html" target="_top"><code class="classname">INTEGER</code></a>s.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="float-notes"></a>12.2.1.5. Floating Point Arithmetics</h4></div></div></div><p><a id="expt"></a><b>Function <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_expcm_expt.html" target="_top"><code class="function">EXPT</code></a>. </b><code class="code">(<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_expcm_expt.html" target="_top"><code class="function">EXPT</code></a> <em class="replaceable"><code>base</code></em> <em class="replaceable"><code>exponent</code></em>)</code>
 is not very precise if <em class="replaceable"><code>exponent</code></em> has a large
 absolute value.</p><p><a id="log"></a><b>Function <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_log.html" target="_top"><code class="function">LOG</code></a>. </b><code class="code">(<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_log.html" target="_top"><code class="function">LOG</code></a> <em class="replaceable"><code>number</code></em> <em class="replaceable"><code>base</code></em>)</code> <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_signal.html" target="_top"><code class="function">SIGNAL</code></a>s an <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/contyp_error.html" target="_top"><code class="classname">ERROR</code></a> if
 <code class="literal"><em class="replaceable"><code>base</code></em> = 1</code>.</p><p><a id="pi"></a><b>Constant <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_pi.html" target="_top"><code class="constant">PI</code></a>. </b>The value of <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_pi.html" target="_top"><code class="constant">PI</code></a> is a <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/typ_short-flo_m_long-float.html" target="_top"><code class="classname">LONG-FLOAT</code></a> with the precision given
  by <code class="code">(<a class="link" href="num-concepts.html#lfd" title="Arbitrary Precision Floats"><code class="function">EXT:LONG-FLOAT-DIGITS</code></a>)</code>.  When this precision is changed, the value of <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_pi.html" target="_top"><code class="constant">PI</code></a> is
  automatically recomputed.  Therefore <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_pi.html" target="_top"><code class="constant">PI</code></a> is <span class="strong"><strong>not</strong></span> a <a class="clhs" href="http://www.lisp.org/HyperSpec/Body/sec_3-1-2-1-1-3.html">constant variable</a>.
</p><p><a id="ucpt"></a><b>Function <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_upgraded-_ex-part-type.html" target="_top"><code class="function">UPGRADED-COMPLEX-PART-TYPE</code></a>. </b>When the argument is not a <a class="" href="http://www.lisp.org/HyperSpec/Body/glo_r.html#recognizable_subtype">recognizable subtype</a> or <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/syscla_real.html" target="_top"><code class="classname">REAL</code></a>,
 <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_upgraded-_ex-part-type.html" target="_top"><code class="function">UPGRADED-COMPLEX-PART-TYPE</code></a> <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_signal.html" target="_top"><code class="function">SIGNAL</code></a>s an <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/contyp_error.html" target="_top"><code class="classname">ERROR</code></a>, otherwise it
 returns its argument (even though a <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/syscla_complex.html" target="_top"><code class="classname">COMPLEX</code></a> number in <a class="ulink" href="http://clisp.cons.org" target="_top"><span class="command"><strong>CLISP</strong></span></a> can
 always have <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_realpartcm_imagpart.html" target="_top"><code class="function">REALPART</code></a> and <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_realpartcm_imagpart.html" target="_top"><code class="function">IMAGPART</code></a> of any type) because it allows
 the most precise type inference.</p><p><a id="default-float-format"></a><b>Variable <a class="link" href="num-concepts.html#default-float-format" title="Variable CUSTOM:*DEFAULT-FLOAT-FORMAT*"><code class="varname">CUSTOM:*DEFAULT-FLOAT-FORMAT*</code></a>. </b>When rational numbers are to be converted to floats (due to
 <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_float.html" target="_top"><code class="function">FLOAT</code></a>, <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_coerce.html" target="_top"><code class="function">COERCE</code></a>, <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_sqrtcm_isqrt.html" target="_top"><code class="function">SQRT</code></a> or a transcendental function), the result
 type is given by the variable <a class="link" href="num-concepts.html#default-float-format" title="Variable CUSTOM:*DEFAULT-FLOAT-FORMAT*"><code class="varname">CUSTOM:*DEFAULT-FLOAT-FORMAT*</code></a>.
 See also <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/var_stread-de_oat-formatst.html" target="_top"><code class="varname">*READ-DEFAULT-FLOAT-FORMAT*</code></a>.</p><p><a id="no-underflow"></a><b>Macro <a class="link" href="num-concepts.html#no-underflow" title="Macro EXT:WITHOUT-FLOATING-POINT-UNDERFLOW"><code class="function">EXT:WITHOUT-FLOATING-POINT-UNDERFLOW</code></a>. </b>The macro <code class="code">(<a class="link" href="num-concepts.html#no-underflow" title="Macro EXT:WITHOUT-FLOATING-POINT-UNDERFLOW"><code class="function">EXT:WITHOUT-FLOATING-POINT-UNDERFLOW</code></a> {<em class="replaceable"><code>form</code></em>}*)</code> executes the
 <em class="replaceable"><code>form</code></em>s, with errors of type <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/contyp_floati_nt-underflow.html" target="_top"><code class="classname">FLOATING-POINT-UNDERFLOW</code></a> inhibited.
 Floating point operations will silently return zero instead of
 <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_signal.html" target="_top"><code class="function">SIGNAL</code></a>ing an <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/contyp_error.html" target="_top"><code class="classname">ERROR</code></a> of type <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/contyp_floati_nt-underflow.html" target="_top"><code class="classname">FLOATING-POINT-UNDERFLOW</code></a>.
</p><p><a id="float-invalid-op"></a><b>Condition <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/contyp_floati_id-operation.html" target="_top"><code class="classname">FLOATING-POINT-INVALID-OPERATION</code></a>. </b>This <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/contyp_condition.html" target="_top"><code class="classname">CONDITION</code></a> is never <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_signal.html" target="_top"><code class="function">SIGNAL</code></a>ed by <a class="ulink" href="http://clisp.cons.org" target="_top"><span class="command"><strong>CLISP</strong></span></a>.</p><p><a id="float-inexact"></a><b>Condition <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/contyp_floati_oint-inexact.html" target="_top"><code class="classname">FLOATING-POINT-INEXACT</code></a>. </b>This <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/contyp_condition.html" target="_top"><code class="classname">CONDITION</code></a> is never <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_signal.html" target="_top"><code class="function">SIGNAL</code></a>ed by <a class="ulink" href="http://clisp.cons.org" target="_top"><span class="command"><strong>CLISP</strong></span></a>.</p></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="num-const"></a>12.2.2. Implementation-Dependent Numeric Constants
  <a class="clhs" href="http://www.lisp.org/HyperSpec/Body/sec_12-1-2.html">[sec_12-1-2]</a></h3></div></div></div><div class="toc"><dl><dt><span class="section"><a href="num-concepts.html#fixnum-lim">12.2.2.1. Fixnum Limits</a></span></dt><dt><span class="section"><a href="num-concepts.html#bignum-lim">12.2.2.2. Bignum Limits</a></span></dt><dt><span class="section"><a href="num-concepts.html#float-lim">12.2.2.3. Float Limits</a></span></dt></dl></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="fixnum-lim"></a>12.2.2.1. Fixnum Limits</h4></div></div></div><div class="table"><a id="fixnum-lim-table"></a><p class="title"><b>Table 12.2. Fixnum limits</b></p><div class="table-contents"><table summary="Fixnum limits" border="1"><colgroup><col align="center" /><col align="center" /><col align="center" /></colgroup><thead><tr><th align="center">CPU type</th><th align="center">32-bit CPU</th><th align="center">64-bit CPU</th></tr></thead><tbody><tr><td align="center"><a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_most-p_ative-fixnum.html" target="_top"><code class="constant">MOST-POSITIVE-FIXNUM</code></a></td><td align="center">2<sup>24</sup>-1 = 16777215</td><td align="center">2<sup>48</sup>-1 = 281474976710655</td></tr><tr><td align="center"><a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_most-p_ative-fixnum.html" target="_top"><code class="constant">MOST-NEGATIVE-FIXNUM</code></a></td><td align="center">-2<sup>24</sup> = -16777216</td><td align="center">-2<sup>48</sup> = -281474976710656</td></tr></tbody></table></div></div><br class="table-break" /></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="bignum-lim"></a>12.2.2.2. Bignum Limits</h4></div></div></div><p><a class="ulink" href="http://www.lisp.org/HyperSpec/Body/typ_bignum.html" target="_top"><code class="classname">BIGNUM</code></a>s are limited in size.  Their maximum size is
 <code class="literal">32*(2<sup>16</sup>-2)=2097088</code> bits.
 The largest representable <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/typ_bignum.html" target="_top"><code class="classname">BIGNUM</code></a> is therefore
 <code class="literal">2<sup>2097088</sup>-1</code>.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="float-lim"></a>12.2.2.3. Float Limits</h4></div></div></div><p>Together with <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_pi.html" target="_top"><code class="constant">PI</code></a>, the other <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/typ_short-flo_m_long-float.html" target="_top"><code class="classname">LONG-FLOAT</code></a> constants
 </p><table class="simplelist" border="0" summary="Simple list"><tr><td><a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_most-p_d-long-float.html" target="_top"><code class="constant">LEAST-NEGATIVE-LONG-FLOAT</code></a></td><td><a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_short-_tive-epsilon.html" target="_top"><code class="constant">LONG-FLOAT-EPSILON</code></a></td></tr><tr><td><a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_most-p_d-long-float.html" target="_top"><code class="constant">LEAST-NEGATIVE-NORMALIZED-LONG-FLOAT</code></a></td><td><a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_short-_tive-epsilon.html" target="_top"><code class="constant">LONG-FLOAT-NEGATIVE-EPSILON</code></a></td></tr><tr><td><a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_most-p_d-long-float.html" target="_top"><code class="constant">LEAST-POSITIVE-LONG-FLOAT</code></a></td><td><a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_most-p_d-long-float.html" target="_top"><code class="constant">MOST-NEGATIVE-LONG-FLOAT</code></a></td></tr><tr><td><a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_most-p_d-long-float.html" target="_top"><code class="constant">LEAST-POSITIVE-NORMALIZED-LONG-FLOAT</code></a></td><td><a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_most-p_d-long-float.html" target="_top"><code class="constant">MOST-POSITIVE-LONG-FLOAT</code></a></td></tr></table><p>
 are recomputed whenever <code class="code">(<a class="link" href="num-concepts.html#lfd" title="Arbitrary Precision Floats"><code class="function">EXT:LONG-FLOAT-DIGITS</code></a>)</code> is <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/mac_setfcm_psetf.html" target="_top"><code class="function">SETF</code></a>ed.
 They are <span class="strong"><strong>not</strong></span> <a class="clhs" href="http://www.lisp.org/HyperSpec/Body/sec_3-1-2-1-1-3.html">constant variable</a>s.</p></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="float-subst"></a>12.2.3. Rule of Float Substitutability
  <a class="clhs" href="http://www.lisp.org/HyperSpec/Body/sec_12-1-3-3.html">[sec_12-1-3-3]</a></h3></div></div></div><p>When a mathematical function may return an exact (<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/syscla_rational.html" target="_top"><code class="classname">RATIONAL</code></a>) or
 inexact (<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/syscla_float.html" target="_top"><code class="classname">FLOAT</code></a>) result, it always returns the exact result.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="float-comp"></a>12.2.4. Floating-point Computations
  <a class="clhs" href="http://www.lisp.org/HyperSpec/Body/sec_12-1-4.html">[sec_12-1-4]</a></h3></div></div></div><div class="toc"><dl><dt><span class="section"><a href="num-concepts.html#flocont">12.2.4.1. Rule of Float Precision Contagion
  </a></span></dt><dt><span class="section"><a href="num-concepts.html#floratcont">12.2.4.2. Rule of Float and Rational Contagion
  </a></span></dt></dl></div><p>There are four floating point types: <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/typ_short-flo_m_long-float.html" target="_top"><code class="classname">SHORT-FLOAT</code></a>,
 <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/typ_short-flo_m_long-float.html" target="_top"><code class="classname">SINGLE-FLOAT</code></a>, <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/typ_short-flo_m_long-float.html" target="_top"><code class="classname">DOUBLE-FLOAT</code></a> and <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/typ_short-flo_m_long-float.html" target="_top"><code class="classname">LONG-FLOAT</code></a>:
</p><div class="informaltable"><a id="floating-types-table"></a><table border="1"><colgroup><col /><col /><col /><col /><col /></colgroup><thead><tr><th align="center">type</th><th align="center">sign</th><th align="center">mantissa</th><th align="center">exponent</th><th align="center">comment</th></tr></thead><tbody><tr><td align="center"><a class="ulink" href="http://www.lisp.org/HyperSpec/Body/typ_short-flo_m_long-float.html" target="_top"><code class="classname">SHORT-FLOAT</code></a></td><td align="center">1 bit</td><td align="center">16+1 bits</td><td align="center">8 bits</td><td align="center">immediate</td></tr><tr><td align="center"><a class="ulink" href="http://www.lisp.org/HyperSpec/Body/typ_short-flo_m_long-float.html" target="_top"><code class="classname">SINGLE-FLOAT</code></a></td><td align="center">1 bit</td><td align="center">23+1 bits</td><td align="center">8 bits</td><td align="center"><a class="ulink" href="http://grouper.ieee.org/groups/754/" target="_top">IEEE 754</a></td></tr><tr><td align="center"><a class="ulink" href="http://www.lisp.org/HyperSpec/Body/typ_short-flo_m_long-float.html" target="_top"><code class="classname">DOUBLE-FLOAT</code></a></td><td align="center">1 bit</td><td align="center">52+1 bits</td><td align="center">11 bits</td><td align="center"><a class="ulink" href="http://grouper.ieee.org/groups/754/" target="_top">IEEE 754</a></td></tr><tr><td align="center"><a class="ulink" href="http://www.lisp.org/HyperSpec/Body/typ_short-flo_m_long-float.html" target="_top"><code class="classname">LONG-FLOAT</code></a></td><td align="center">1 bit</td><td align="center">&gt;=64 bits</td><td align="center">32 bits</td><td align="center">variable
 length</td></tr></tbody></table></div><p>The single and double float formats are those of the <a class="ulink" href="http://grouper.ieee.org/groups/754/" target="_top">IEEE 754</a>
 “<span class="quote">Standard for Binary Floating-Point Arithmetic</span>”,
 except that <a class="ulink" href="http://clisp.cons.org" target="_top"><span class="command"><strong>CLISP</strong></span></a> does not support features like
 <code class="literal">±0</code>, <code class="literal">±inf</code>,
 <code class="literal">NaN</code>, gradual underflow, etc.
 <a class="ulink" href="http://www.lisp.org" target="_top"><span class="command"><strong>Common Lisp</strong></span></a> does not make use of these features, so, to reduce portability
 problems, <a class="ulink" href="http://clisp.cons.org" target="_top"><span class="command"><strong>CLISP</strong></span></a> by design returns the same floating point results on
 all platforms (<a class="ulink" href="http://clisp.cons.org" target="_top"><span class="command"><strong>CLISP</strong></span></a> has a floating-point emulation built in for
 platforms that do not support <a class="ulink" href="http://grouper.ieee.org/groups/754/" target="_top">IEEE 754</a>).  Note that
 </p><div class="itemizedlist"><ul type="disc"><li>When you got a <code class="literal">NaN</code>
    in your program, your program is broken, so you will spend time
    determining where the <code class="literal">NaN</code> came from.
    It is better to <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_signal.html" target="_top"><code class="function">SIGNAL</code></a> an <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/contyp_error.html" target="_top"><code class="classname">ERROR</code></a> in this case.</li><li>When you got unnormalized floats in your program,
    your results will have a greatly reduced accuracy anyway.
    Since <a class="ulink" href="http://clisp.cons.org" target="_top"><span class="command"><strong>CLISP</strong></span></a> has the means to cope with this - <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/typ_short-flo_m_long-float.html" target="_top"><code class="classname">LONG-FLOAT</code></a>s of
    <a class="link" href="num-concepts.html#lfd" title="Arbitrary Precision Floats">variable precision</a> - it does not
    need unnormalized floats.</li></ul></div><p>
 This is why <a href="features.html" class="olink"><code class="varname">*FEATURES*</code></a> does not contain the
 <code class="constant">:IEEE-FLOATING-POINT</code> keyword.</p><p><a id="lfd"></a><b>Arbitrary Precision Floats. </b><a class="ulink" href="http://www.lisp.org/HyperSpec/Body/typ_short-flo_m_long-float.html" target="_top"><code class="classname">LONG-FLOAT</code></a>s have variable mantissa length, which is a
 multiple of 16 (or 32, depending on the word size of the processor).
 The default length used when <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/typ_short-flo_m_long-float.html" target="_top"><code class="classname">LONG-FLOAT</code></a>s are <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_readcm_re_g-whitespace.html" target="_top"><code class="function">READ</code></a> is given by the
 <a class="" href="http://www.lisp.org/HyperSpec/Body/glo_p.html#place">place</a> <code class="code">(<a class="link" href="num-concepts.html#lfd" title="Arbitrary Precision Floats"><code class="function">EXT:LONG-FLOAT-DIGITS</code></a>)</code>.  It can be set by <code class="code">(<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/mac_setfcm_psetf.html" target="_top"><code class="function">SETF</code></a> (<a class="link" href="num-concepts.html#lfd" title="Arbitrary Precision Floats"><code class="function">EXT:LONG-FLOAT-DIGITS</code></a>) <em class="replaceable"><code>n</code></em>)</code>,
 where <em class="replaceable"><code>n</code></em> is a positive <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/syscla_integer.html" target="_top"><code class="classname">INTEGER</code></a>.  E.g., <code class="code">(<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/mac_setfcm_psetf.html" target="_top"><code class="function">SETF</code></a> (<a class="link" href="num-concepts.html#lfd" title="Arbitrary Precision Floats"><code class="function">EXT:LONG-FLOAT-DIGITS</code></a>)
 3322)</code> sets the default precision of <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/typ_short-flo_m_long-float.html" target="_top"><code class="classname">LONG-FLOAT</code></a>s to about
 1000 decimal digits.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="flocont"></a>12.2.4.1. Rule of Float Precision Contagion
  <a class="clhs" href="http://www.lisp.org/HyperSpec/Body/sec_12-1-4-4.html">[sec_12-1-4-4]</a></h4></div></div></div><p>The floating point contagion is controlled by the variable
 <a class="link" href="num-concepts.html#flocont" title="12.2.4.1. Rule of Float Precision Contagion"><code class="varname">CUSTOM:*FLOATING-POINT-CONTAGION-ANSI*</code></a>.  When it is non-<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_nil.html" target="_top"><code class="constant">NIL</code></a>, contagion is done as per the
 [<span class="citation"><a class="link" href="references.html#ansi-cl" title="ANSI INCITS 226-1994 (R1999) Information Technology - Programming Language - Common Lisp [formerly ANSI X3.226-1994 (R1999)]">ANSI CL standard</a></span>]: <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/typ_short-flo_m_long-float.html" target="_top"><code class="classname">SHORT-FLOAT</code></a> → <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/typ_short-flo_m_long-float.html" target="_top"><code class="classname">SINGLE-FLOAT</code></a> →
 <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/typ_short-flo_m_long-float.html" target="_top"><code class="classname">DOUBLE-FLOAT</code></a> → <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/typ_short-flo_m_long-float.html" target="_top"><code class="classname">LONG-FLOAT</code></a>.</p><div class="variablelist"><dl><dt><span class="term">Rationale:</span></dt><dd>See it pragmatically: save what you can and let
  others worry about the rest.</dd><dt><span class="term">Brief:</span></dt><dd><a class="ulink" href="http://www.lisp.org" target="_top"><span class="command"><strong>Common Lisp</strong></span></a> knows the number's precision, not accuracy, so
  preserving the precision can be accomplished reliably, while anything
  relating to the accuracy is just a speculation - only the user
  (programmer) knows what it is in each case.
 </dd><dt><span class="term">Detailed:</span></dt><dd>A computer float is an approximation of a real number.
  One can think of it as a random variable with the mean equal to
  itself and standard deviation equal to half the last significant digit.
  E.g., <code class="literal">1.5</code> is actually <code class="literal">1.5±0.05</code>.
  Consider adding <code class="literal">1.5</code> and <code class="literal">1.75</code>.
  [<span class="citation"><a class="link" href="references.html#ansi-cl" title="ANSI INCITS 226-1994 (R1999) Information Technology - Programming Language - Common Lisp [formerly ANSI X3.226-1994 (R1999)]">ANSI CL standard</a></span>] requires that <code class="code">(<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_pl.html" target="_top"><code class="function">+</code></a> 1.5 1.75)</code>
  return <code class="literal">3.25</code>, while traditional <a class="ulink" href="http://clisp.cons.org" target="_top"><span class="command"><strong>CLISP</strong></span></a> would return
  <code class="literal">3.3</code>.  The implied random variables are:
  <code class="literal">3.25±0.005</code> and <code class="literal">3.3±0.05</code>.
  Note that the traditional <a class="ulink" href="http://clisp.cons.org" target="_top"><span class="command"><strong>CLISP</strong></span></a> way <span class="strong"><strong>does</strong></span>
  lie about the mean: the mean <span class="strong"><strong>is</strong></span> <code class="literal">3.25</code> and
  nothing else, while the standard way
  <span class="strong"><strong>could</strong></span> be lying about the deviation
  (accuracy): if the implied accuracy of <code class="literal">1.5 (0.05)</code>
  is its actual accuracy, then the accuracy of the result cannot be
  smaller that that.  Therefore, since <a class="ulink" href="http://www.lisp.org" target="_top"><span class="command"><strong>Common Lisp</strong></span></a> has no way of knowing the
  actual accuracy, [<span class="citation"><a class="link" href="references.html#ansi-cl" title="ANSI INCITS 226-1994 (R1999) Information Technology - Programming Language - Common Lisp [formerly ANSI X3.226-1994 (R1999)]">ANSI CL standard</a></span>] (and all the other standard engineering
  programming languages, like <a class="ulink" href="http://c-faq.com/" target="_top"><span class="command"><strong>C</strong></span></a>, <a class="dict" href="http://foldoc.org/?query=Fortran"><span class="command"><strong>Fortran</strong></span></a>
  etc) decides that keeping the accuracy correct is the business of the
  programmer, while the language should preserve what it can - the precision.
  </dd><dt><span class="term">Experience:</span></dt><dd> Rounding errors accumulate, and if a computation
  is conducted with insufficient precision, an outright incorrect
  result can be returned.
  (E.g., <code class="code">E(x<sup>2</sup>) -
  E(x)<sup>2</sup></code> can be negative!)
  The user should not mix floats of different precision (that's what
  <a class="link" href="num-concepts.html#warn-fpc" title="Variable CUSTOM:*WARN-ON-FLOATING-POINT-CONTAGION*"><code class="varname">CUSTOM:*WARN-ON-FLOATING-POINT-CONTAGION*</code></a> is for), but one should not be penalized for this too
  harshly.</dd></dl></div><p>When <a class="link" href="num-concepts.html#flocont" title="12.2.4.1. Rule of Float Precision Contagion"><code class="varname">CUSTOM:*FLOATING-POINT-CONTAGION-ANSI*</code></a> is <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_nil.html" target="_top"><code class="constant">NIL</code></a>, the traditional <a class="ulink" href="http://clisp.cons.org" target="_top"><span class="command"><strong>CLISP</strong></span></a> method is used,
 namely the result of an arithmetic operation whose arguments are of
 different float types is rounded to the float format of the shortest
 (least precise) of the arguments: <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/syscla_rational.html" target="_top"><code class="classname">RATIONAL</code></a> →
 <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/typ_short-flo_m_long-float.html" target="_top"><code class="classname">LONG-FLOAT</code></a> → <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/typ_short-flo_m_long-float.html" target="_top"><code class="classname">DOUBLE-FLOAT</code></a> → <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/typ_short-flo_m_long-float.html" target="_top"><code class="classname">SINGLE-FLOAT</code></a>
 → <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/typ_short-flo_m_long-float.html" target="_top"><code class="classname">SHORT-FLOAT</code></a> (in contrast to
 <a class="clhs" href="http://www.lisp.org/HyperSpec/Body/sec_12-1-4-4.html">[sec_12-1-4-4]</a>!)</p><div class="variablelist"><dl><dt><span class="term">Rationale:</span></dt><dd> See it mathematically.  Add intervals:
  <code class="code">{1.0 ± 1e-8} + {1.0 ± 1e-16} = {2.0 ±
  1e-8}</code>.  So, if we add <code class="literal">1.0s0</code> and
  <code class="literal">1.0d0</code>, we should get <code class="literal">2.0s0</code>.
  </dd><dt><span class="term">Brief:</span></dt><dd>Do not suggest accuracy of a result by giving it a
  precision that is greater than its accuracy.
  </dd><dt><span class="term">Example:</span></dt><dd><code class="code">(<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_-.html" target="_top"><code class="function">-</code></a> (<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_pl.html" target="_top"><code class="function">+</code></a> 1.7 <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_pi.html" target="_top"><code class="constant">PI</code></a>) <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_pi.html" target="_top"><code class="constant">PI</code></a>)</code>
  should not return <code class="literal">1.700000726342836417234L0</code>, it
  should return <code class="literal">1.7f0</code> (or
  <code class="literal">1.700001f0</code> if there were rounding errors).
  </dd><dt><span class="term">Experience:</span></dt><dd>If in a computation using thousands of <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/typ_short-flo_m_long-float.html" target="_top"><code class="classname">SHORT-FLOAT</code></a>s,
  a <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/typ_short-flo_m_long-float.html" target="_top"><code class="classname">LONG-FLOAT</code></a> (like <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_pi.html" target="_top"><code class="constant">PI</code></a>) happens to be used, the long precision
  should not propagate throughout all the intermediate values.
  Otherwise, the long result would look precise, but its accuracy is
  only that of a <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/typ_short-flo_m_long-float.html" target="_top"><code class="classname">SHORT-FLOAT</code></a>; furthermore much computation time
  would be lost by calculating with <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/typ_short-flo_m_long-float.html" target="_top"><code class="classname">LONG-FLOAT</code></a>s when only
  <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/typ_short-flo_m_long-float.html" target="_top"><code class="classname">SHORT-FLOAT</code></a>s would be needed.
  </dd></dl></div><div class="simplesect" lang="en" xml:lang="en"><div class="titlepage"><div><div><h5 class="title"><a id="warn-fpc"></a>Variable <a class="link" href="num-concepts.html#warn-fpc" title="Variable CUSTOM:*WARN-ON-FLOATING-POINT-CONTAGION*"><code class="varname">CUSTOM:*WARN-ON-FLOATING-POINT-CONTAGION*</code></a></h5></div></div></div><p>If the variable <a class="link" href="num-concepts.html#warn-fpc" title="Variable CUSTOM:*WARN-ON-FLOATING-POINT-CONTAGION*"><code class="varname">CUSTOM:*WARN-ON-FLOATING-POINT-CONTAGION*</code></a> is non-<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_nil.html" target="_top"><code class="constant">NIL</code></a>, a <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/contyp_warning.html" target="_top"><code class="classname">WARNING</code></a> is emitted for
 every coercion involving different floating-point types.
 As explained above, float precision contagion is not a good idea.
 You can avoid the contagion by doing all your computations with the
 same floating-point type (and using <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_float.html" target="_top"><code class="function">FLOAT</code></a> to convert all constants,
 e.g., <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_pi.html" target="_top"><code class="constant">PI</code></a>, to your preferred type).</p><p>This variable helps you eliminate all occurrences of float
 precision contagion: set it to <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_t.html" target="_top"><code class="constant">T</code></a> to have <a class="ulink" href="http://clisp.cons.org" target="_top"><span class="command"><strong>CLISP</strong></span></a> <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_signal.html" target="_top"><code class="function">SIGNAL</code></a> a
 <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/contyp_warning.html" target="_top"><code class="classname">WARNING</code></a> on float precision contagion; set it to <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_error.html" target="_top"><code class="function">ERROR</code></a> to have
 <a class="ulink" href="http://clisp.cons.org" target="_top"><span class="command"><strong>CLISP</strong></span></a> <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_signal.html" target="_top"><code class="function">SIGNAL</code></a> an <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/contyp_error.html" target="_top"><code class="classname">ERROR</code></a> on float precision contagion, so that you
 can look at the stack backtrace.</p></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="floratcont"></a>12.2.4.2. Rule of Float and Rational Contagion
  <a class="clhs" href="http://www.lisp.org/HyperSpec/Body/sec_12-1-4-1.html">[sec_12-1-4-1]</a></h4></div></div></div><p>The contagion between floating point and rational numbers is controlled
 by the variable <a class="link" href="num-concepts.html#floratcont" title="12.2.4.2. Rule of Float and Rational Contagion"><code class="varname">CUSTOM:*FLOATING-POINT-RATIONAL-CONTAGION-ANSI*</code></a>.  When it is non-<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_nil.html" target="_top"><code class="constant">NIL</code></a>, contagion is done as per
 the [<span class="citation"><a class="link" href="references.html#ansi-cl" title="ANSI INCITS 226-1994 (R1999) Information Technology - Programming Language - Common Lisp [formerly ANSI X3.226-1994 (R1999)]">ANSI CL standard</a></span>]: <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/syscla_rational.html" target="_top"><code class="classname">RATIONAL</code></a> → <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/syscla_float.html" target="_top"><code class="classname">FLOAT</code></a>.</p><p>When <a class="link" href="num-concepts.html#floratcont" title="12.2.4.2. Rule of Float and Rational Contagion"><code class="varname">CUSTOM:*FLOATING-POINT-RATIONAL-CONTAGION-ANSI*</code></a> is <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_nil.html" target="_top"><code class="constant">NIL</code></a>, the traditional <a class="ulink" href="http://clisp.cons.org" target="_top"><span class="command"><strong>CLISP</strong></span></a> method is used,
 namely if the result is mathematically an exact rational number, this
 rational number is returned (in contrast to
 <a class="clhs" href="http://www.lisp.org/HyperSpec/Body/sec_12-1-4-1.html">[sec_12-1-4-1]</a>!)</p><p><a class="link" href="num-concepts.html#floratcont" title="12.2.4.2. Rule of Float and Rational Contagion"><code class="varname">CUSTOM:*FLOATING-POINT-RATIONAL-CONTAGION-ANSI*</code></a> has an effect only in those few cases when the mathematical
 result is exact although one of the arguments is a floating-point number,
 such as <code class="code">(<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_st.html" target="_top"><code class="function">*</code></a> 0 1.618)</code>, <code class="code">(<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_sl.html" target="_top"><code class="function">/</code></a> 0 1.618)</code>,
 <code class="code">(<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_asincm_acoscm_atan.html" target="_top"><code class="function">ATAN</code></a> 0 1.0)</code>, <code class="code">(<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_expcm_expt.html" target="_top"><code class="function">EXPT</code></a> 2.0 0)</code>,
 <code class="code">(<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_phase.html" target="_top"><code class="function">PHASE</code></a> 2.718)</code>.</p><div class="simplesect" lang="en" xml:lang="en"><div class="titlepage"><div><div><h5 class="title"><a id="warn-fprc"></a>Variable <a class="link" href="num-concepts.html#warn-fprc" title="Variable CUSTOM:*WARN-ON-FLOATING-POINT-RATIONAL-CONTAGION*"><code class="varname">CUSTOM:*WARN-ON-FLOATING-POINT-RATIONAL-CONTAGION*</code></a></h5></div></div></div><p>If the variable <a class="link" href="num-concepts.html#warn-fprc" title="Variable CUSTOM:*WARN-ON-FLOATING-POINT-RATIONAL-CONTAGION*"><code class="varname">CUSTOM:*WARN-ON-FLOATING-POINT-RATIONAL-CONTAGION*</code></a> is non-<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_nil.html" target="_top"><code class="constant">NIL</code></a>, a <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/contyp_warning.html" target="_top"><code class="classname">WARNING</code></a> is emitted for
 every avoidable coercion from a rational number to a floating-point number.
 You can avoid such coercions by calling <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_float.html" target="_top"><code class="function">FLOAT</code></a> to convert the particular
 rational numbers to your preferred floating-point type.</p><p>This variable helps you eliminate all occurrences of avoidable
 coercions to a floating-point number when a rational number result
 would be possible: set it to <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_t.html" target="_top"><code class="constant">T</code></a> to have <a class="ulink" href="http://clisp.cons.org" target="_top"><span class="command"><strong>CLISP</strong></span></a> <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_signal.html" target="_top"><code class="function">SIGNAL</code></a> a <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/contyp_warning.html" target="_top"><code class="classname">WARNING</code></a>
 in such situations; set it to <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_error.html" target="_top"><code class="function">ERROR</code></a> to have <a class="ulink" href="http://clisp.cons.org" target="_top"><span class="command"><strong>CLISP</strong></span></a> <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_signal.html" target="_top"><code class="function">SIGNAL</code></a> an
 <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/contyp_error.html" target="_top"><code class="classname">ERROR</code></a> in such situations, so that you can look at the stack
 backtrace.</p></div><div class="simplesect" lang="en" xml:lang="en"><div class="titlepage"><div><div><h5 class="title"><a id="phasecont"></a>Variable <a class="link" href="num-concepts.html#phasecont" title="Variable CUSTOM:*PHASE-ANSI*"><code class="varname">CUSTOM:*PHASE-ANSI*</code></a></h5></div></div></div><p>A similar variable, <a class="link" href="num-concepts.html#phasecont" title="Variable CUSTOM:*PHASE-ANSI*"><code class="varname">CUSTOM:*PHASE-ANSI*</code></a>, controls the return
 value of <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_phase.html" target="_top"><code class="function">PHASE</code></a> when the argument is an exact nonnegative <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/syscla_real.html" target="_top"><code class="classname">REAL</code></a>.
 Namely, if <a class="link" href="num-concepts.html#phasecont" title="Variable CUSTOM:*PHASE-ANSI*"><code class="varname">CUSTOM:*PHASE-ANSI*</code></a> is non-<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_nil.html" target="_top"><code class="constant">NIL</code></a>, it returns a floating-point zero;
 if <a class="link" href="num-concepts.html#phasecont" title="Variable CUSTOM:*PHASE-ANSI*"><code class="varname">CUSTOM:*PHASE-ANSI*</code></a> is <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_nil.html" target="_top"><code class="constant">NIL</code></a>, it returns an exact zero.  Example:
 <code class="code">(<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_phase.html" target="_top"><code class="function">PHASE</code></a> 2/3)</code></p></div></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="complex-comp"></a>12.2.5. Complex Computations
  <a class="clhs" href="http://www.lisp.org/HyperSpec/Body/sec_12-1-5.html">[sec_12-1-5]</a></h3></div></div></div><p>Complex numbers can have a real part and an imaginary part of
 different types. For example, <code class="code">(<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_sqrtcm_isqrt.html" target="_top"><code class="function">SQRT</code></a> -9.0)</code> evaluates to
 the number <span class="data"><code class="literal"><a class="clhs" href="http://www.lisp.org/HyperSpec/Body/sec_2-4-8-11.html"><span class="data"><code class="literal">#C</code></span></a>(0 3.0)</code></span>,
 which has a real part of exactly <code class="literal">0</code>,
 not only <span class="data"><code class="literal">0.0</code></span>
 (which would mean “<span class="quote">approximately 0</span>”).</p><p>The <a class="" href="http://www.lisp.org/HyperSpec/Body/glo_t.html#type_specifier">type specifier</a> for this is <span class="type"><code class="literal">(<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/syscla_complex.html" target="_top"><code class="classname">COMPLEX</code></a>
  <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/syscla_integer.html" target="_top"><code class="classname">INTEGER</code></a> <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/typ_short-flo_m_long-float.html" target="_top"><code class="classname">SINGLE-FLOAT</code></a>)</code></span>, and <span class="type"><code class="literal">(<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/syscla_complex.html" target="_top"><code class="classname">COMPLEX</code></a>
  <code class="varname">type-of-real-part</code>
  <code class="varname">type-of-imaginary-part</code>)</code></span> in general.</p><p>The <a class="" href="http://www.lisp.org/HyperSpec/Body/glo_t.html#type_specifier">type specifier</a> <span class="type"><code class="literal">(<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/syscla_complex.html" target="_top"><code class="classname">COMPLEX</code></a>
  <em class="replaceable"><code>type</code></em>)</code></span> is equivalent to <span class="type"><code class="literal">(<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/syscla_complex.html" target="_top"><code class="classname">COMPLEX</code></a>
  <em class="replaceable"><code>type</code></em> <em class="replaceable"><code>type</code></em>)</code></span>.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="complex-rational"></a>12.2.6. Rule of Canonical Representation
  for Complex Rationals <a class="clhs" href="http://www.lisp.org/HyperSpec/Body/sec_12-1-5-3.html">[sec_12-1-5-3]</a></h3></div></div></div><p>Complex numbers can have a real part and an imaginary part of
 different types.  If the imaginary part is <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_eql.html" target="_top"><code class="function">EQL</code></a> to <code class="literal">0</code>,
 the number is automatically converted to a real number.</p><p>This has the advantage that
 <code class="code">(<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/speope_letcm_letst.html" target="_top"><code class="function">LET</code></a> ((x (<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_sqrtcm_isqrt.html" target="_top"><code class="function">SQRT</code></a> -9.0))) (* x x))</code> - instead of
 evaluating to <span class="data"><code class="literal"><a class="clhs" href="http://www.lisp.org/HyperSpec/Body/sec_2-4-8-11.html"><span class="data"><code class="literal">#C</code></span></a>(-9.0 0.0)</code></span>,
 with <em class="replaceable"><code>x</code></em> = <span class="data"><code class="literal"><a class="clhs" href="http://www.lisp.org/HyperSpec/Body/sec_2-4-8-11.html"><span class="data"><code class="literal">#C</code></span></a>(0.0 3.0)</code></span> -
 evaluates to <span class="data"><code class="literal"><a class="clhs" href="http://www.lisp.org/HyperSpec/Body/sec_2-4-8-11.html"><span class="data"><code class="literal">#C</code></span></a>(-9.0 0)</code></span> =
 <span class="data"><code class="literal">-9.0</code></span>,
 with <em class="replaceable"><code>x</code></em> = <span class="data"><code class="literal"><a class="clhs" href="http://www.lisp.org/HyperSpec/Body/sec_2-4-8-11.html"><span class="data"><code class="literal">#C</code></span></a>(0 3.0)</code></span>.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="random-state"></a>12.2.7. Random-State Operations
  <a class="clhs" href="http://www.lisp.org/HyperSpec/Body/sec_12-1-7.html">[sec_12-1-7]</a></h3></div></div></div><p>To ease reproducibility, the variable <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/var_strandom-statest.html" target="_top"><code class="varname">*RANDOM-STATE*</code></a> is
 initialized to the same value on each invocation, so that
 </p><pre class="screen"><strong><code class="prompt">$</code></strong> clisp -norc <code class="option"><a href="clisp.html#opt-exec-expr" class="olink">-x</a></code> '(<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_random.html" target="_top"><code class="function">RANDOM</code></a> 1s0)'</pre><p>
 will always print the same number.</p><p>If you want a new random state on each invocation, you can arrange
 for that by using <a href="image.html#init-func" class="olink">init function</a>: </p><pre class="screen">
<strong><code class="prompt">$</code></strong> clisp -norc <code class="option"><a href="clisp.html#opt-exec-expr" class="olink">-x</a></code> '(<a href="image.html" class="olink"><code class="function">EXT:SAVEINITMEM</code></a> "foo" :init-function (<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/mac_lambda.html" target="_top"><code class="function">LAMBDA</code></a> () (<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/spefor_setq.html" target="_top"><code class="function">SETQ</code></a> <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/var_strandom-statest.html" target="_top"><code class="varname">*RANDOM-STATE*</code></a> (<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_make-random-state.html" target="_top"><code class="function">MAKE-RANDOM-STATE</code></a> <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_t.html" target="_top"><code class="constant">T</code></a>))))'
<strong><code class="prompt">$</code></strong> clisp -norc <code class="option"><a href="clisp.html#opt-memfile" class="olink">-M</a></code> foo.mem <code class="option"><a href="clisp.html#opt-exec-expr" class="olink">-x</a></code> '(<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_random.html" target="_top"><code class="function">RANDOM</code></a> 1s0)'</pre><p>
 or by placing <code class="code">(<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/spefor_setq.html" target="_top"><code class="function">SETQ</code></a> <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/var_strandom-statest.html" target="_top"><code class="varname">*RANDOM-STATE*</code></a>
    (<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_make-random-state.html" target="_top"><code class="function">MAKE-RANDOM-STATE</code></a> <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_t.html" target="_top"><code class="constant">T</code></a>))</code> into your <a href="clisp.html#opt-norc" class="olink">RC file</a>.</p></div></div><div class="bookinfo"><hr /><table width="100%" summary="impnotes meta info"><th><td align="left">These notes document <a class="ulink" href="http://clisp.cons.org" target="_top"><span class="command"><strong>CLISP</strong></span></a> version 2.46</td><td align="right">Last modified: 2008-07-02</td></th></table></div><div class="custom-footer"><hr /><table width="100%"><tr><td align="left"><a href="http://clisp.cons.org"><img src="clisp.png" width="48" height="48" alt="[CLISP home]" /></a></td><td align="center"><a href="http://sourceforge.net/donate/index.php?group_id=1355"><img src="http://images.sourceforge.net/images/project-support.jpg" width="88" height="32" alt="[Support CLISP]" /></a></td><td align="right"><a href="http://sourceforge.net"><img width="125" height="37" alt="[SourceForge]" src="http://sflogo.sourceforge.net/sflogo.php?group_id=1355&amp;type=2&amp;page=num-concepts" /></a></td></tr></table></div><hr /><form method="get" action="http://www.google.com/custom" target="_top"><table width="100%" border="0"><tr><td nowrap="nowrap" align="center"><input type="hidden" name="domains" value="clisp.cons.org;clisp.podval.org;www.lisp.org" /><label for="sbi" style="display: none">Enter your search terms</label><input type="text" name="q" size="50" maxlength="255" id="sbi" value="12.2. Number Concepts" /><label for="sbb" style="display: none">Submit search form</label><input type="submit" name="sa" value="Google Search" id="sbb" /></td></tr><tr><td nowrap="nowrap" align="center"><input type="radio" name="sitesearch" value="" checked="1" id="ss0" /><label for="ss0" title="Search the Web"><small>Web</small></label><input type="radio" name="sitesearch" value="clisp.cons.org" id="ss1" /><label for="ss1" title="Search clisp.cons.org"><small>clisp.cons.org</small></label><input type="radio" name="sitesearch" value="clisp.podval.org" id="ss2" /><label for="ss2" title="Search clisp.podval.org"><small>clisp.podval.org</small></label><input type="radio" name="sitesearch" value="www.lisp.org" id="ss3" /><label for="ss3" title="Search www.lisp.org"><small>www.lisp.org</small></label><input type="hidden" name="client" value="pub-4445255502750357" /><input type="hidden" name="forid" value="1" /><input type="hidden" name="ie" value="UTF-8" /><input type="hidden" name="oe" value="UTF-8" /><input type="hidden" name="cof" value="GALT:#008000;GL:1;DIV:#336699;VLC:663399;AH:center;BGC:FFFFFF;LBGC:000000;ALC:0000FF;LC:0000FF;T:000000;GFNT:0000FF;GIMP:0000FF;LH:48;LW:48;L:http://clisp.cons.org/clisp.png;S:http://clisp.cons.org;FORID:1" /><input type="hidden" name="hl" value="en" /></td></tr></table></form><hr /><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="num-types.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="numbers.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="characters.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">12.1. Numeric Types </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> Chapter 13. Characters
  </td></tr></table></div></body></html>
