<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>32.4. Socket Streams</title><link rel="stylesheet" href="impnotes.css" type="text/css" /><link rev="made" href="mailto:clisp-list@lists.sourceforge.net" /><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot_7566" /><link rel="start" href="index.html" title="Implementation Notes for GNU CLISP" /><link rel="up" href="ext-platform.html" title="Chapter 32. Platform Specific Extensions" /><link rel="prev" href="dffi.html" title="32.3. The Foreign Function Call Facility" /><link rel="next" href="quickstart.html" title="32.5. Quickstarting delivery with CLISP" /><link rel="copyright" href="legalese.html" title="Legal Status of the CLISP Implementation Notes" /><meta name="date" content="'generated: 2008-07-02 11:52:30-04:00'" /><link rel="author" title="Authors" href="index.html#authors" /><link rel="contents" title="Table of Contents" href="index.html" /><link rel="glossary" href="glossary.html" /><link rel="help" href="faq.html#faq-help" title="How do I ask for help?" /><link rel="home" title="Home" href="http://clisp.cons.org" /><link rel="index" href="idx.html" /></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">32.4. Socket Streams</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="dffi.html">Prev</a> </td><th width="60%" align="center">Chapter 32. Platform Specific Extensions</th><td width="20%" align="right"> <a accesskey="n" href="quickstart.html">Next</a></td></tr></table><hr /></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="socket"></a>32.4. Socket Streams</h2></div><div><h3 class="subtitle"><span class="plat-dep">Platform Dependent: <span class="plat-dep"><a class="ulink" href="http://www.unix.org/online.html" target="_top"><span class="strong"><strong>UNIX</strong></span></a>, <a class="ulink" href="http://winehq.org/" target="_top"><span class="platform">Win32</span></a> platforms only.</span></span></h3></div></div></div><div class="toc"><dl><dt><span class="section"><a href="socket.html#socket-intro">32.4.1. Introduction</a></span></dt><dt><span class="section"><a href="socket.html#socket-api">32.4.2. Socket API Reference</a></span></dt></dl></div><div class="list-of-examples"><p><b>List of Examples</b></p><dl><dt>32.13. <a href="socket.html#socket-ex-server">Lisp read-eval-print loop server</a></dt><dt>32.14. <a href="socket.html#socket-ex-client">Lisp <span class="command"><strong>HTTP</strong></span> client</a></dt></dl></div>
<!--#ifdef SOCKET_STREAMS-->
<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="socket-intro"></a>32.4.1. Introduction</h3></div></div></div><div class="list-of-examples"><p><b>List of Examples</b></p><dl><dt>32.13. <a href="socket.html#socket-ex-server">Lisp read-eval-print loop server</a></dt><dt>32.14. <a href="socket.html#socket-ex-client">Lisp <span class="command"><strong>HTTP</strong></span> client</a></dt></dl></div><p>Sockets are used for interprocess communications by processes
 running on the same host as well as by processes running on different
 hosts over a computer network.
 The most common kind of sockets is Internet stream sockets, and a
 high-level interface to them is described here.
 A more low level interface that closely follows the <a class="ulink" href="http://c-faq.com/" target="_top"><span class="command"><strong>C</strong></span></a> system
 calls is also available, see <a class="xref" href="rawsock.html" title="33.17. Raw Socket Access">Section 33.17, “Raw Socket Access”</a>.</p><p>Two main varieties of sockets are interfaced to:
 </p><div class="itemizedlist"><ul type="disc"><li>“<span class="quote">active</span>” sockets
    correspond to <a class="link" href="socket.html" title="32.4. Socket Streams"><code class="classname">SOCKET:SOCKET-STREAM</code></a>s which are <a class="" href="http://www.lisp.org/HyperSpec/Body/glo_b.html#bidirectional">bidirectional</a> <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/syscla_stream.html" target="_top"><code class="classname">STREAM</code></a>s
  </li><li>“<span class="quote">passive</span>” sockets correspond to
    <a class="link" href="socket.html" title="32.4. Socket Streams"><code class="classname">SOCKET:SOCKET-SERVER</code></a>s which are a special kind of objects that are used
    to allow the other side to initiate interaction with lisp.
</li></ul></div><div class="example"><a id="socket-ex-server"></a><p class="title"><b>Example 32.13. Lisp <a class="clhs" href="http://www.lisp.org/HyperSpec/Body/sec_25-1-1.html">read-eval-print loop</a> server</b></p><div class="example-contents"><p>Here is a simple lisp <a class="clhs" href="http://www.lisp.org/HyperSpec/Body/sec_25-1-1.html">read-eval-print loop</a> server that waits for a remote
 connection and evaluates forms read from it:
</p><pre class="programlisting">
(<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/speope_letcm_letst.html" target="_top"><code class="function">LET</code></a> ((server (<a class="link" href="socket.html#sose"><code class="function">SOCKET:SOCKET-SERVER</code></a>)))
  (<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_format.html" target="_top"><code class="function">FORMAT</code></a> t "~&amp;Waiting for a connection on ~S:~D~%"
          (<a class="link" href="socket.html#sose-hopo"><code class="function">SOCKET:SOCKET-SERVER-HOST</code></a> server) (<a class="link" href="socket.html#sose-hopo"><code class="function">SOCKET:SOCKET-SERVER-PORT</code></a> server))
  (<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/speope_unwind-protect.html" target="_top"><code class="function">UNWIND-PROTECT</code></a>
      ;; infinite loop, terminate with <span class="keycap"><strong>Control</strong></span>+<span class="keysym">C</span>
      (<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/mac_loop.html" target="_top"><code class="function">LOOP</code></a> (<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/mac_with-open-stream.html" target="_top"><code class="function">WITH-OPEN-STREAM</code></a> (socket (<a class="link" href="socket.html#so-accept"><code class="function">SOCKET:SOCKET-ACCEPT</code></a> server))
              (<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/mac_multiple-value-bind.html" target="_top"><code class="function">MULTIPLE-VALUE-BIND</code></a> (local-host local-port) (<a class="link" href="socket.html#sost-local"><code class="function">SOCKET:SOCKET-STREAM-LOCAL</code></a> socket)
                (<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/mac_multiple-value-bind.html" target="_top"><code class="function">MULTIPLE-VALUE-BIND</code></a> (remote-host remote-port) (<a class="link" href="socket.html#sost-peer"><code class="function">SOCKET:SOCKET-STREAM-PEER</code></a> socket)
                  (<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_format.html" target="_top"><code class="function">FORMAT</code></a> <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_t.html" target="_top"><code class="constant">T</code></a> "~&amp;Connection: ~S:~D -- ~S:~D~%"
                          remote-host remote-port local-host local-port)))
              ;; loop is terminated when the remote host closes the connection or on <a class="link" href="quit.html" title="31.3. Quitting CLISP"><code class="function">EXT:EXIT</code></a>
              (<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/mac_loop.html" target="_top"><code class="function">LOOP</code></a> (<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/mac_whencm_unless.html" target="_top"><code class="function">WHEN</code></a> (<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_eq.html" target="_top"><code class="function">EQ</code></a> :eof (<a class="link" href="socket.html#so-status"><code class="function">SOCKET:SOCKET-STATUS</code></a> (cons socket :input))) (<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/mac_return.html" target="_top"><code class="function">RETURN</code></a>))
                    (<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_writecm_p_rintcm_princ.html" target="_top"><code class="function">PRINT</code></a> (<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_eval.html" target="_top"><code class="function">EVAL</code></a> (<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_readcm_re_g-whitespace.html" target="_top"><code class="function">READ</code></a> socket)) socket)
                    ;; flush everything left in socket
                    (<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/mac_loop.html" target="_top"><code class="function">LOOP</code></a> :for c = (<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_read-char-no-hang.html" target="_top"><code class="function">READ-CHAR-NO-HANG</code></a> socket nil nil) :while c)
                    (<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_terpricm_fresh-line.html" target="_top"><code class="function">TERPRI</code></a> socket))))
    ;; make sure server is closed
    (<a class="link" href="socket.html#sose-close"><code class="function">SOCKET:SOCKET-SERVER-CLOSE</code></a> server)))
</pre><p>
</p><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">This opens a gaping security hole!</h3><p>Functions like <a href="shell.html#exec" class="olink"><code class="function">EXT:SHELL</code></a>, <a class="link" href="shell.html#exec" title="32.6.1. Shell"><code class="function">EXT:EXECUTE</code></a>, <a class="link" href="shell.html#run-prog"><code class="function">EXT:RUN-SHELL-COMMAND</code></a> will allow the
  remote host to execute arbitrary code with your permissions.
  While functions defined in lisp (like <a class="link" href="shell.html#run-prog"><code class="function">EXT:RUN-SHELL-COMMAND</code></a>) can be removed
  (using <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_fmakunbound.html" target="_top"><code class="function">FMAKUNBOUND</code></a>), the built-in functions (like <a href="shell.html#exec" class="olink"><code class="function">EXT:SHELL</code></a> and <a class="link" href="shell.html#exec" title="32.6.1. Shell"><code class="function">EXT:EXECUTE</code></a>)
  cannot be permanently removed from the run-time, and an experienced
  hacker will be able to invoke them even if you <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_fmakunbound.html" target="_top"><code class="function">FMAKUNBOUND</code></a> their names.
 </p><p>You should limit the socket server to local connections
  by passing the <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/syscla_string.html" target="_top"><code class="classname">STRING</code></a> <span class="data"><code class="literal">"127.0.0.1"</code></span>
  as the <code class="constant">:INTERFACE</code> argument to <a class="link" href="socket.html#sose"><code class="function">SOCKET:SOCKET-SERVER</code></a>.</p></div><p>
</p></div></div><br class="example-break" /><div class="example"><a id="socket-ex-client"></a><p class="title"><b>Example 32.14. Lisp <a class="ulink" href="http://www.w3.org/Protocols/" target="_top"><span class="command"><strong>HTTP</strong></span></a> client</b></p><div class="example-contents"><p>Here are a couple of simple lisp <a class="ulink" href="http://www.w3.org/Protocols/" target="_top"><span class="command"><strong>HTTP</strong></span></a> clients that fetch a web
 page and a binary file, and upload a file:
</p><pre class="programlisting">
(<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/mac_defun.html" target="_top"><code class="function">DEFUN</code></a> wget-text (host page file <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html" target="_top"><code class="literal">&amp;OPTIONAL</code></a> (port 80))
  ;; <a class="ulink" href="http://www.w3.org/Protocols/" target="_top"><span class="command"><strong>HTTP</strong></span></a> requires the <code class="constant">:DOS</code> <a class="link" href="encoding.html#newline" title="31.5.3. Line Terminators">line terminator</a>
  (<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/mac_with-open-stream.html" target="_top"><code class="function">WITH-OPEN-STREAM</code></a> (socket (<a class="link" href="socket.html#so-connect"><code class="function">SOCKET:SOCKET-CONNECT</code></a> port host <a class="link" href="open.html#extfmt"><code class="constant">:EXTERNAL-FORMAT</code></a> <code class="constant">:DOS</code>))
     (<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_format.html" target="_top"><code class="function">FORMAT</code></a> socket "GET ~A HTTP/1.0~2%" page)
     ;; dump the whole thing - header+data - into the output file
     (<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/mac_with-open-file.html" target="_top"><code class="function">WITH-OPEN-FILE</code></a> (out file :direction :output)
       (<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/mac_loop.html" target="_top"><code class="function">LOOP</code></a> :for line = (<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_read-line.html" target="_top"><code class="function">READ-LINE</code></a> socket nil nil) :while line
          :do (<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_write-str_m_write-line.html" target="_top"><code class="function">WRITE-LINE</code></a> line out)))))
(<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/mac_defun.html" target="_top"><code class="function">DEFUN</code></a> wget-binary (host page file <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html" target="_top"><code class="literal">&amp;OPTIONAL</code></a> (port 80))
  (<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/mac_with-open-stream.html" target="_top"><code class="function">WITH-OPEN-STREAM</code></a> (socket (<a class="link" href="socket.html#so-connect"><code class="function">SOCKET:SOCKET-CONNECT</code></a> port host <a class="link" href="open.html#extfmt"><code class="constant">:EXTERNAL-FORMAT</code></a> <code class="constant">:DOS</code>))
    (<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_format.html" target="_top"><code class="function">FORMAT</code></a> socket "GET ~A HTTP/1.0~2%" page)
    (<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/mac_loop.html" target="_top"><code class="function">LOOP</code></a> :with content-length :for line = (<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_read-line.html" target="_top"><code class="function">READ-LINE</code></a> socket nil nil)
      ;; header is separated from the data with a blank line
      :until (<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_zerop.html" target="_top"><code class="function">ZEROP</code></a> (<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_length.html" target="_top"><code class="function">LENGTH</code></a> line)) :do
      (<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/mac_whencm_unless.html" target="_top"><code class="function">WHEN</code></a> (<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_stringeqc_ng-not-lessp.html" target="_top"><code class="function">STRING=</code></a> line #1="Content-length: " :end1 #2=<a class="clhs" href="http://www.lisp.org/HyperSpec/Body/sec_2-4-8-6.html"><span class="data"><code class="literal">#.</code></span></a>(<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_length.html" target="_top"><code class="function">LENGTH</code></a> #1#))
        (<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/spefor_setq.html" target="_top"><code class="function">SETQ</code></a> content-length (<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_parse-integer.html" target="_top"><code class="function">PARSE-INTEGER</code></a> line :start #2#))
      ;; this will not work if the server does not supply the content-length header
      :finally (<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/mac_return.html" target="_top"><code class="function">RETURN</code></a> (<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/speope_letcm_letst.html" target="_top"><code class="function">LET</code></a> ((data (<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_make-array.html" target="_top"><code class="function">MAKE-ARRAY</code></a> content-length
                                               :element-type '<span class="type"><code class="literal">(<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/typ_unsigned-byte.html" target="_top"><code class="classname">UNSIGNED-BYTE</code></a> 8)</code></span>)))
                           ;; switch to binary i/o on socket
                           (<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/mac_setfcm_psetf.html" target="_top"><code class="function">SETF</code></a> (<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_stream-element-type.html" target="_top"><code class="function">STREAM-ELEMENT-TYPE</code></a> socket) '<span class="type"><code class="literal">(<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/typ_unsigned-byte.html" target="_top"><code class="classname">UNSIGNED-BYTE</code></a> 8)</code></span>)
                           ;; read the whole file in one system call
                           (<a class="link" href="bulk-io.html#rd-by-seq"><code class="function">EXT:READ-BYTE-SEQUENCE</code></a> data socket)
                           (<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/mac_with-open-file.html" target="_top"><code class="function">WITH-OPEN-FILE</code></a> (out file :direction :output
                                                <a class="link" href="open.html#eltype"><code class="constant">:ELEMENT-TYPE</code></a> '<span class="type"><code class="literal">(<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/typ_unsigned-byte.html" target="_top"><code class="classname">UNSIGNED-BYTE</code></a> 8)</code></span>)
                             ;; write the whole file in one system call
                             (<a class="link" href="bulk-io.html#wr-by-seq"><code class="function">EXT:WRITE-BYTE-SEQUENCE</code></a> data out))
                           data))))))
(<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/mac_defun.html" target="_top"><code class="function">DEFUN</code></a> wput (host page file <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html" target="_top"><code class="literal">&amp;OPTIONAL</code></a> (port 80))
  (<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/mac_with-open-stream.html" target="_top"><code class="function">WITH-OPEN-STREAM</code></a> (socket (<a class="link" href="socket.html#so-connect"><code class="function">SOCKET:SOCKET-CONNECT</code></a> port host <a class="link" href="open.html#extfmt"><code class="constant">:EXTERNAL-FORMAT</code></a> <code class="constant">:DOS</code>))
    (<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/mac_with-open-file.html" target="_top"><code class="function">WITH-OPEN-FILE</code></a> (in file :direction :inptut <a class="link" href="open.html#eltype"><code class="constant">:ELEMENT-TYPE</code></a> '<span class="type"><code class="literal">(<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/typ_unsigned-byte.html" target="_top"><code class="classname">UNSIGNED-BYTE</code></a> 8)</code></span>)
      (<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/speope_letcm_letst.html" target="_top"><code class="function">LET*</code></a> ((length (<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_file-length.html" target="_top"><code class="function">FILE-LENGTH</code></a> in))
             (data (<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_make-array.html" target="_top"><code class="function">MAKE-ARRAY</code></a> length :element-type '<span class="type"><code class="literal">(<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/typ_unsigned-byte.html" target="_top"><code class="classname">UNSIGNED-BYTE</code></a> 8)</code></span>)))
        ;; some servers may not understand the "Content-length" header
        (<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_format.html" target="_top"><code class="function">FORMAT</code></a> socket "PUT ~A HTTP/1.0~%Content-length: ~D~2%" page length)
        (<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/mac_setfcm_psetf.html" target="_top"><code class="function">SETF</code></a> (<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_stream-element-type.html" target="_top"><code class="function">STREAM-ELEMENT-TYPE</code></a> socket) '<span class="type"><code class="literal">(<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/typ_unsigned-byte.html" target="_top"><code class="classname">UNSIGNED-BYTE</code></a> 8)</code></span>)
        (<a class="link" href="bulk-io.html#rd-by-seq"><code class="function">EXT:READ-BYTE-SEQUENCE</code></a> data in)
        (<a class="link" href="bulk-io.html#wr-by-seq"><code class="function">EXT:WRITE-BYTE-SEQUENCE</code></a> data socket)))
    ;; not necessary if the server understands the "Content-length" header
    (<a class="link" href="socket.html#sost-shut"><code class="function">SOCKET:SOCKET-STREAM-SHUTDOWN</code></a> socket :output)
    ;; get the server response
    (<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/mac_loop.html" target="_top"><code class="function">LOOP</code></a> :for line = (<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_read-line.html" target="_top"><code class="function">READ-LINE</code></a> socket nil nil) :while line :collect line)))
</pre></div></div><br class="example-break" /></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="socket-api"></a>32.4.2. Socket API Reference</h3></div></div></div><div class="variablelist"><dl><dt><a id="sose"></a><span class="term"><code class="code">(<a class="link" href="socket.html#sose"><code class="function">SOCKET:SOCKET-SERVER</code></a> <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html" target="_top"><code class="literal">&amp;OPTIONAL</code></a> <em class="replaceable"><code>port</code></em>
     <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html" target="_top"><code class="literal">&amp;KEY</code></a> <code class="constant">:INTERFACE</code>
     <code class="constant">:BACKLOG</code>)</code></span></dt><dd>This function creates a socket an binds a port to
    the socket.  The server exists to watch for client connect attempts.
    The optional argument is the port to use (non-negative <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/typ_fixnum.html" target="_top"><code class="classname">FIXNUM</code></a>).
    The <code class="constant">:BACKLOG</code> parameter defines maximum length
    of queue of pending connections (see
    <a class="unix" href="http://www.opengroup.org/onlinepubs/009695399/functions/listen.html"><code class="function">listen</code></a>) and defaults to 1.
    The <code class="constant">:INTERFACE</code> is either a <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/syscla_string.html" target="_top"><code class="classname">STRING</code></a>,
    interpreted as the IP address that will be bound, or a socket, from
    whose peer the connections will be made.
    Default is (for backward compatibility) to bind to all local
    interfaces, but for security reasons it is advisable to bind to
    loopback <span class="data"><code class="literal">"127.0.0.1"</code></span> if you need only
    local connections.</dd><dt><a id="sose-close"></a><span class="term"><code class="code">(<a class="link" href="socket.html#sose-close"><code class="function">SOCKET:SOCKET-SERVER-CLOSE</code></a> <em class="replaceable"><code>socket-server</code></em>)</code></span></dt><dd>Closes down the server socket.
    <a class="link" href="close.html" title="21.12. Function CLOSE">Just like streams</a>,
    <a class="link" href="socket.html" title="32.4. Socket Streams"><code class="classname">SOCKET:SOCKET-SERVER</code></a>s are closed at <a href="gc.html" class="olink">garbage-collect</a>ion.  You should not rely on
    this however, because <a href="gc.html" class="olink">garbage-collect</a>ion times are not deterministic.
 </dd><dt><a id="sose-hopo"></a><span class="term"><code class="code">(<a class="link" href="socket.html#sose-hopo"><code class="function">SOCKET:SOCKET-SERVER-HOST</code></a> <em class="replaceable"><code>socket-server</code></em>)</code><br /></span><span class="term"><code class="code">(<a class="link" href="socket.html#sose-hopo"><code class="function">SOCKET:SOCKET-SERVER-PORT</code></a> <em class="replaceable"><code>socket-server</code></em>)</code></span></dt><dd>Returns the host mask indicating which hosts can
    connect to this server and the port which was bound using <a class="link" href="socket.html#sose"><code class="function">SOCKET:SOCKET-SERVER</code></a>.
 </dd><dt><a id="so-wait"></a><span class="term"><code class="code">(<a class="link" href="socket.html#so-wait"><code class="function">SOCKET:SOCKET-WAIT</code></a>
    <em class="replaceable"><code>socket-server</code></em> <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html" target="_top"><code class="literal">&amp;OPTIONAL</code></a> <a class="link" href="socket.html#timeout-opt">[<em class="replaceable"><code>seconds</code></em> [<em class="replaceable"><code>microseconds</code></em>]]</a>)</code></span></dt><dd><a id="timeout-opt"></a>Wait for a fixed time for a
    connection on the <em class="replaceable"><code>socket-server</code></em> (a <a class="link" href="socket.html" title="32.4. Socket Streams"><code class="classname">SOCKET:SOCKET-SERVER</code></a>).
    Without a timeout argument, <a class="link" href="socket.html#so-wait"><code class="function">SOCKET:SOCKET-WAIT</code></a> blocks indefinitely.
    When timeout is zero, poll.
    Returns <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_t.html" target="_top"><code class="constant">T</code></a> when a connection is available (i.e., <a class="link" href="socket.html#so-accept"><code class="function">SOCKET:SOCKET-ACCEPT</code></a> will
    not block) and <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_nil.html" target="_top"><code class="constant">NIL</code></a> on timeout.</dd><dt><a id="so-accept"></a><span class="term"><code class="code">(<a class="link" href="socket.html#so-accept"><code class="function">SOCKET:SOCKET-ACCEPT</code></a> <em class="replaceable"><code>socket-server</code></em>
    <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html" target="_top"><code class="literal">&amp;KEY</code></a> <a class="link" href="open.html#eltype"><code class="constant">:ELEMENT-TYPE</code></a> <a class="link" href="open.html#extfmt"><code class="constant">:EXTERNAL-FORMAT</code></a> <a class="link" href="open.html#buffered"><code class="constant">:BUFFERED</code></a> <a class="link" href="socket.html#timeout-k"><code class="constant">:TIMEOUT</code></a>)</code></span></dt><dd><a id="timeout-k"></a>Creates the server-side <a class="" href="http://www.lisp.org/HyperSpec/Body/glo_b.html#bidirectional">bidirectional</a>
    <a class="link" href="socket.html" title="32.4. Socket Streams"><code class="classname">SOCKET:SOCKET-STREAM</code></a> for the connection.
   Waits for an attempt to connect to the server for no more than
   <a class="link" href="socket.html#timeout-k"><code class="constant">:TIMEOUT</code></a> <a class="clhs" href="http://www.lisp.org/HyperSpec/Body/sec_25-1-4-4.html">seconds</a> (which may be a non-negative <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/syscla_real.html" target="_top"><code class="classname">REAL</code></a> or a
   list <span class="data"><code class="literal">(sec usec)</code></span> or a pair
   <span class="data"><code class="literal">(sec . usec)</code></span>).
   <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_signal.html" target="_top"><code class="function">SIGNAL</code></a>s an <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/contyp_error.html" target="_top"><code class="classname">ERROR</code></a> if no connection is made in that time.
  </dd><dt><a id="so-connect"></a><span class="term"><code class="code">(<a class="link" href="socket.html#so-connect"><code class="function">SOCKET:SOCKET-CONNECT</code></a>
    <em class="replaceable"><code>port</code></em> <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html" target="_top"><code class="literal">&amp;OPTIONAL</code></a> [<em class="replaceable"><code>host</code></em>] <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html" target="_top"><code class="literal">&amp;KEY</code></a>
    <a class="link" href="open.html#eltype"><code class="constant">:ELEMENT-TYPE</code></a> <a class="link" href="open.html#extfmt"><code class="constant">:EXTERNAL-FORMAT</code></a> <a class="link" href="open.html#buffered"><code class="constant">:BUFFERED</code></a> <a class="link" href="socket.html#timeout-k"><code class="constant">:TIMEOUT</code></a>)</code></span></dt><dd>Attempts to create a client-side <a class="" href="http://www.lisp.org/HyperSpec/Body/glo_b.html#bidirectional">bidirectional</a>
   <a class="link" href="socket.html" title="32.4. Socket Streams"><code class="classname">SOCKET:SOCKET-STREAM</code></a>.  Blocks until the server accepts the connection, for
   no more than <a class="link" href="socket.html#timeout-k"><code class="constant">:TIMEOUT</code></a> <a class="clhs" href="http://www.lisp.org/HyperSpec/Body/sec_25-1-4-4.html">seconds</a>.  If it is 0, returns immediately
   and (probably) blocks on the next i/o operation (you can use
   <a class="link" href="socket.html#so-status"><code class="function">SOCKET:SOCKET-STATUS</code></a> to check whether it will actually block).
 </dd><dt><a id="so-status"></a><span class="term"><code class="code">(<a class="link" href="socket.html#so-status"><code class="function">SOCKET:SOCKET-STATUS</code></a>
                 <em class="replaceable"><code>socket-stream-or-list</code></em>
                 <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html" target="_top"><code class="literal">&amp;OPTIONAL</code></a> <a class="link" href="socket.html#timeout-opt">[<em class="replaceable"><code>seconds</code></em> [<em class="replaceable"><code>microseconds</code></em>]]</a>)</code></span></dt><dd><p>Checks whether it is possible to read from or write
    to a <a class="link" href="socket.html" title="32.4. Socket Streams"><code class="classname">SOCKET:SOCKET-STREAM</code></a> or whether a connection is available on a
    <a class="link" href="socket.html" title="32.4. Socket Streams"><code class="classname">SOCKET:SOCKET-SERVER</code></a> without blocking.</p><p>This is similar to <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_listen.html" target="_top"><code class="function">LISTEN</code></a>, which checks only one
    <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/syscla_stream.html" target="_top"><code class="classname">STREAM</code></a> and only for input, and <a class="link" href="socket.html#so-wait"><code class="function">SOCKET:SOCKET-WAIT</code></a>, which works only with
    <a class="link" href="socket.html" title="32.4. Socket Streams"><code class="classname">SOCKET:SOCKET-SERVER</code></a>s.</p><p>We define <em class="replaceable"><code>status</code></em> for a <a class="link" href="socket.html" title="32.4. Socket Streams"><code class="classname">SOCKET:SOCKET-SERVER</code></a> or a <a class="link" href="socket.html" title="32.4. Socket Streams"><code class="classname">SOCKET:SOCKET-STREAM</code></a>
    to be <code class="constant">:ERROR</code> if any i/o operation will cause an <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/contyp_error.html" target="_top"><code class="classname">ERROR</code></a>.</p><p>Additionally, for a <a class="link" href="socket.html" title="32.4. Socket Streams"><code class="classname">SOCKET:SOCKET-SERVER</code></a>, we define
    <em class="replaceable"><code>status</code></em> to be <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_t.html" target="_top"><code class="constant">T</code></a> if a connection is available, i.e.,
    is <a class="link" href="socket.html#so-accept"><code class="function">SOCKET:SOCKET-ACCEPT</code></a> will not block, and <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_nil.html" target="_top"><code class="constant">NIL</code></a> otherwise.</p><p>Additionally, for a <a class="link" href="socket.html" title="32.4. Socket Streams"><code class="classname">SOCKET:SOCKET-STREAM</code></a>, we define <em class="replaceable"><code>status</code></em> in the
    given <em class="replaceable"><code>direction</code></em> (one of <code class="constant">:INPUT</code>, <code class="constant">:OUTPUT</code>, and <code class="constant">:IO</code>) to be
    </p><div class="variablelist"><a id="so-status-values"></a><p class="title"><b>Possible status values for various directions:</b></p><table border="0"><col align="left" valign="top" /><tbody><tr><td><p><span class="term"><code class="constant">:INPUT</code> status:</span></p></td><td><div class="variablelist"><table border="0"><col align="left" valign="top" /><tbody><tr><td><p><span class="term"><a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_nil.html" target="_top"><code class="constant">NIL</code></a></span></p></td><td>reading will block
        </td></tr><tr><td><p><span class="term"><code class="constant">:INPUT</code></span></p></td><td>some input is available
        </td></tr><tr><td><p><span class="term"><code class="constant">:EOF</code></span></p></td><td>the stream has reached its end
       </td></tr></tbody></table></div></td></tr><tr><td><p><span class="term"><code class="constant">:OUTPUT</code> status:</span></p></td><td><div class="variablelist"><table border="0"><col align="left" valign="top" /><tbody><tr><td><p><span class="term"><a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_nil.html" target="_top"><code class="constant">NIL</code></a></span></p></td><td>writing will block
        </td></tr><tr><td><p><span class="term"><code class="constant">:OUTPUT</code></span></p></td><td>output to the stream will not block
       </td></tr></tbody></table></div></td></tr><tr><td><p><span class="term"><code class="constant">:IO</code> status:</span></p></td><td><div class="informaltable"><a id="so-status-i-o"></a><table border="1"><colgroup><col align="center" /><col align="center" /><col align="center" /><col align="center" /></colgroup><thead><tr><th rowspan="2" align="center" valign="bottom">output status</th><th colspan="3" align="center">input status</th></tr><tr><th align="center"><a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_nil.html" target="_top"><code class="constant">NIL</code></a></th><th align="center"><code class="constant">:INPUT</code></th><th align="center"><code class="constant">:EOF</code></th></tr></thead><tbody><tr><td align="center"><a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_nil.html" target="_top"><code class="constant">NIL</code></a></td><td align="center"><a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_nil.html" target="_top"><code class="constant">NIL</code></a></td><td align="center"><code class="constant">:INPUT</code></td><td align="center"><code class="constant">:EOF</code></td></tr><tr><td align="center"><code class="constant">:OUTPUT</code></td><td align="center"><code class="constant">:OUTPUT</code></td><td align="center"><code class="constant">:IO</code></td><td align="center"><code class="constant">:APPEND</code></td></tr></tbody></table></div></td></tr></tbody></table></div><div class="variablelist"><p class="title"><b>Possible values of
     <em class="replaceable"><code>socket-stream-or-list</code></em>:</b></p><dl><dt><span class="term"><a class="link" href="socket.html" title="32.4. Socket Streams"><code class="classname">SOCKET:SOCKET-STREAM</code></a> or <a class="link" href="socket.html" title="32.4. Socket Streams"><code class="classname">SOCKET:SOCKET-SERVER</code></a></span></dt><dd>Returns the appropriate status, as defined
       above (<code class="constant">:IO</code> status for <a class="link" href="socket.html" title="32.4. Socket Streams"><code class="classname">SOCKET:SOCKET-STREAM</code></a>)
    </dd><dt><span class="term"><code class="code">(<a class="link" href="socket.html" title="32.4. Socket Streams"><code class="classname">SOCKET:SOCKET-STREAM</code></a> . <em class="replaceable"><code>direction</code></em>)</code></span></dt><dd>Return the status in the specified direction
    </dd><dt><span class="term">a non-empty list of the above</span></dt><dd>Return a list of values, one for each element of the
       argument list (a la <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_mapccm_ma_istcm_mapcon.html" target="_top"><code class="function">MAPCAR</code></a>)</dd></dl></div><p>If you want to avoid <a class="" href="http://www.lisp.org/HyperSpec/Body/glo_c.html#cons">cons</a>ing[3] up a <a class="" href="http://www.lisp.org/HyperSpec/Body/glo_f.html#fresh">fresh</a> list, you can
    make the elements of <em class="replaceable"><code>socket-stream-or-list</code></em>
    to be <span class="data"><code class="literal">(<em class="replaceable"><code>socket-stream</code></em> <em class="replaceable"><code>direction</code></em> .
     <em class="replaceable"><code>x</code></em>)</code></span> or <span class="data"><code class="literal">(<em class="replaceable"><code>socket-server</code></em> . <em class="replaceable"><code>x</code></em>)</code></span>.
    Then <a class="link" href="socket.html#so-status"><code class="function">SOCKET:SOCKET-STATUS</code></a> will destructively modify its argument and replace
    <em class="replaceable"><code>x</code></em> or <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_nil.html" target="_top"><code class="constant">NIL</code></a> with the status and return the modified list.
    You can pass this modified list to <a class="link" href="socket.html#so-status"><code class="function">SOCKET:SOCKET-STATUS</code></a> again.</p><p>The optional arguments specify the timeout. <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_nil.html" target="_top"><code class="constant">NIL</code></a> means
    wait forever, <code class="literal">0</code> means poll.</p><p>The second value returned is the number of objects with
    non-<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_nil.html" target="_top"><code class="constant">NIL</code></a> status, i.e., “<span class="quote">actionable</span>” objects.
    <a class="link" href="socket.html#so-status"><code class="function">SOCKET:SOCKET-STATUS</code></a> returns either due to a timeout or when this number is
    positive, i.e., if the timeout was <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_nil.html" target="_top"><code class="constant">NIL</code></a> and <a class="link" href="socket.html#so-status"><code class="function">SOCKET:SOCKET-STATUS</code></a> did
    return, then the second value is positive (this is the reason <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_nil.html" target="_top"><code class="constant">NIL</code></a>
    is <span class="strong"><strong>not</strong></span> treated as an empty <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/syscla_list.html" target="_top"><code class="classname">LIST</code></a>, but as an invalid
    argument).</p><p>This is the interface to <a class="unix" href="http://www.opengroup.org/onlinepubs/009695399/functions/select.html"><code class="function">select</code></a>
    (on some platforms, <a class="unix" href="http://www.opengroup.org/onlinepubs/009695399/functions/poll.html"><code class="function">poll</code></a>),
    so it will work on any <a class="ulink" href="http://clisp.cons.org" target="_top"><span class="command"><strong>CLISP</strong></span></a> <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/syscla_stream.html" target="_top"><code class="classname">STREAM</code></a> which is based on a
    <a class="unix" href="http://www.opengroup.org/onlinepubs/009695399/basedefs/xbd_chap03.html#tag_03_165">file descriptor</a>, e.g., <a href="terminal.html#with-kbd" class="olink"><code class="varname">EXT:*KEYBOARD-INPUT*</code></a> and <a class="link" href="open.html" title="21.11. Function OPEN">file</a>/<a class="link" href="shell.html#pipe" title="32.6.2. Pipes">pipe</a>/<a class="link" href="socket.html" title="32.4. Socket Streams">socket</a> <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/syscla_stream.html" target="_top"><code class="classname">STREAM</code></a>s, as well as
    on <a class="link" href="rawsock.html" title="33.17. Raw Socket Access">raw sockets</a>.</p></dd><dt><a id="sost-hopo"></a><span class="term"><code class="code">(<a class="link" href="socket.html#sost-hopo"><code class="function">SOCKET:SOCKET-STREAM-HOST</code></a> <em class="replaceable"><code>socket-stream</code></em>)</code><br /></span><span class="term"><code class="code">(<a class="link" href="socket.html#sost-hopo"><code class="function">SOCKET:SOCKET-STREAM-PORT</code></a> <em class="replaceable"><code>socket-stream</code></em>)</code></span></dt><dd>These two functions return information about the
    <a class="link" href="socket.html" title="32.4. Socket Streams"><code class="classname">SOCKET:SOCKET-STREAM</code></a>.</dd><dt><a id="sost-peer"></a><span class="term"><code class="code">(<a class="link" href="socket.html#sost-peer"><code class="function">SOCKET:SOCKET-STREAM-PEER</code></a>
    <em class="replaceable"><code>socket-stream</code></em> [<em class="replaceable"><code>do-not-resolve-p</code></em>])</code></span></dt><dd><p>Given a <a class="link" href="socket.html" title="32.4. Socket Streams"><code class="classname">SOCKET:SOCKET-STREAM</code></a>, this function returns the
    name of the host on the opposite side of the connection and its port
    number; the server-side can use this to see who connected.</p><p>When the optional second argument is non-<a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_nil.html" target="_top"><code class="constant">NIL</code></a>, the hostname
    resolution is disabled and just the IP address is returned, without
    the <acronym class="acronym" title="Fully Qualified Domain Name">FQDN</acronym>.
 </p><p>The <em class="replaceable"><code>socket-stream</code></em> argument can also be a
                       <a class="link" href="rawsock.html" title="33.17. Raw Socket Access">raw socket</a>.</p></dd><dt><a id="sost-local"></a><span class="term"><code class="code">(<a class="link" href="socket.html#sost-local"><code class="function">SOCKET:SOCKET-STREAM-LOCAL</code></a>
    <em class="replaceable"><code>socket-stream</code></em> [<em class="replaceable"><code>do-not-resolve-p</code></em>])</code></span></dt><dd><p>The dual to <a class="link" href="socket.html#sost-peer"><code class="function">SOCKET:SOCKET-STREAM-PEER</code></a> - same information,
   host name and port number, but for the local host.
   The difference from <a class="link" href="socket.html#sost-hopo"><code class="function">SOCKET:SOCKET-STREAM-HOST</code></a> and <a class="link" href="socket.html#sost-hopo"><code class="function">SOCKET:SOCKET-STREAM-PORT</code></a> is that this function
   asks the OS (and thus returns the correct trusted values) while the
   other two are just accessors to the internal data structure, and
   basically return the arguments given to the function which created
   the <em class="replaceable"><code>socket-stream</code></em>.</p><p>The <em class="replaceable"><code>socket-stream</code></em> argument can also be a
                       <a class="link" href="rawsock.html" title="33.17. Raw Socket Access">raw socket</a>.</p></dd><dt><a id="sost-shut"></a><span class="term"><code class="code">(<a class="link" href="socket.html#sost-shut"><code class="function">SOCKET:SOCKET-STREAM-SHUTDOWN</code></a> <em class="replaceable"><code>socket-stream</code></em>
    <em class="replaceable"><code>direction</code></em>)</code></span></dt><dd><p>Some protocols provide for closing the connection
   in one <em class="replaceable"><code>direction</code></em> using <a class="unix" href="http://www.opengroup.org/onlinepubs/009695399/functions/shutdown.html"><code class="function">shutdown</code></a>.
   This function provides an interface to this <a class="ulink" href="http://www.unix.org/online.html" target="_top"><span class="strong"><strong>UNIX</strong></span></a> system call.
   <em class="replaceable"><code>direction</code></em> should be <code class="constant">:INPUT</code> or <code class="constant">:OUTPUT</code>.  Note that you
   should still call <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_close.html" target="_top"><code class="function">CLOSE</code></a> after you are done with your <em class="replaceable"><code>socket-stream</code></em>; this
   is best accomplished by using <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/mac_with-open-stream.html" target="_top"><code class="function">WITH-OPEN-STREAM</code></a>.</p><p>All <a class="link" href="socket.html" title="32.4. Socket Streams"><code class="classname">SOCKET:SOCKET-STREAM</code></a>s are <a class="" href="http://www.lisp.org/HyperSpec/Body/glo_b.html#bidirectional">bidirectional</a> <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/syscla_stream.html" target="_top"><code class="classname">STREAM</code></a>s (i.e., both <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_input-str_put-stream-p.html" target="_top"><code class="function">INPUT-STREAM-P</code></a>
   and <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_input-str_put-stream-p.html" target="_top"><code class="function">OUTPUT-STREAM-P</code></a> return <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_t.html" target="_top"><code class="constant">T</code></a> for them).
   <a class="link" href="socket.html#sost-shut"><code class="function">SOCKET:SOCKET-STREAM-SHUTDOWN</code></a> <span class="emphasis"><em>breaks</em></span> this and turns its argument
   stream into an <a class="" href="http://www.lisp.org/HyperSpec/Body/glo_i.html#input">input</a> <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/syscla_stream.html" target="_top"><code class="classname">STREAM</code></a> (if <em class="replaceable"><code>direction</code></em> is <code class="constant">:OUTPUT</code>) or <a class="" href="http://www.lisp.org/HyperSpec/Body/glo_o.html#output">output</a> <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/syscla_stream.html" target="_top"><code class="classname">STREAM</code></a> (if
   <em class="replaceable"><code>direction</code></em> is <code class="constant">:INPUT</code>).
    Thus, the following important invariant is preserved: whenever
   </p><div class="itemizedlist"><ul type="disc"><li>a <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/syscla_stream.html" target="_top"><code class="classname">STREAM</code></a> is open
    (i.e., <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_open-stream-p.html" target="_top"><code class="function">OPEN-STREAM-P</code></a> returns <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_t.html" target="_top"><code class="constant">T</code></a>) and</li><li>a <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/syscla_stream.html" target="_top"><code class="classname">STREAM</code></a> is an <a class="" href="http://www.lisp.org/HyperSpec/Body/glo_i.html#input">input</a> <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/syscla_stream.html" target="_top"><code class="classname">STREAM</code></a> (i.e., <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_input-str_put-stream-p.html" target="_top"><code class="function">INPUT-STREAM-P</code></a>
     returns <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_t.html" target="_top"><code class="constant">T</code></a>)</li></ul></div><p>
   the <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/syscla_stream.html" target="_top"><code class="classname">STREAM</code></a> can be read from (e.g., with <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_read-char.html" target="_top"><code class="function">READ-CHAR</code></a> or <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/fun_read-byte.html" target="_top"><code class="function">READ-BYTE</code></a>).
   </p><p>The <em class="replaceable"><code>socket-stream</code></em> argument can also be a
                       <a class="link" href="rawsock.html" title="33.17. Raw Socket Access">raw socket</a>.</p></dd><dt><a id="so-opt"></a><span class="term"><code class="code">(<a class="link" href="socket.html#so-opt"><code class="function">SOCKET:SOCKET-OPTIONS</code></a> <em class="replaceable"><code>socket-server</code></em> <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/sec_3-4-1.html" target="_top"><code class="literal">&amp;REST</code></a>
    {<em class="replaceable"><code>option</code></em>}*)</code></span></dt><dd><p>Query and, optionally, set socket options using
   <a class="unix" href="http://www.opengroup.org/onlinepubs/009695399/functions/getsockopt.html"><code class="function">getsockopt</code></a>
   and <a class="unix" href="http://www.opengroup.org/onlinepubs/009695399/functions/setsockopt.html"><code class="function">setsockopt</code></a>.
   An <em class="replaceable"><code>option</code></em> is a keyword, optionally followed by the new value.
   When the new value is not supplied,
   <a class="unix" href="http://www.opengroup.org/onlinepubs/009695399/functions/setsockopt.html"><code class="function">setsockopt</code></a> is not called.
   For each option the old (or current, if new value was not supplied)
   value is returned.  E.g., <code class="code">(<a class="link" href="socket.html#so-opt"><code class="function">SOCKET:SOCKET-OPTIONS</code></a> <em class="replaceable"><code>socket-server</code></em>
   :SO-LINGER 1 :SO-RCVLOWAT)</code> returns 2 values: <a class="ulink" href="http://www.lisp.org/HyperSpec/Body/convar_nil.html" target="_top"><code class="constant">NIL</code></a>, the old
   value of the <code class="constant">:SO-LINGER</code> option, and 1, the
   current value of the <code class="constant">:SO-RCVLOWAT</code> option.
  </p><p>The <em class="replaceable"><code>socket-stream</code></em> argument can also be a
                       <a class="link" href="rawsock.html" title="33.17. Raw Socket Access">raw socket</a>.</p></dd><dt><a id="so-handles"></a><span class="term"><code class="code">(<a class="link" href="socket.html#so-handles"><code class="function">SOCKET:STREAM-HANDLES</code></a>
    <em class="replaceable"><code>stream</code></em>)</code></span></dt><dd>Return the input and output OS <a class="unix" href="http://www.opengroup.org/onlinepubs/009695399/basedefs/xbd_chap03.html#tag_03_165">file descriptor</a>s of the
    <em class="replaceable"><code>stream</code></em> as <a class="" href="http://www.lisp.org/HyperSpec/Body/glo_m.html#multiple_values">multiple values</a>.  See <a class="xref" href="rawsock.html" title="33.17. Raw Socket Access">Section 33.17, “Raw Socket Access”</a>.
 </dd></dl></div></div>
<!--#endif-->
</div><div class="bookinfo"><hr /><table width="100%" summary="impnotes meta info"><th><td align="left">These notes document <a class="ulink" href="http://clisp.cons.org" target="_top"><span class="command"><strong>CLISP</strong></span></a> version 2.46</td><td align="right">Last modified: 2008-07-02</td></th></table></div><div class="custom-footer"><hr /><table width="100%"><tr><td align="left"><a href="http://clisp.cons.org"><img src="clisp.png" width="48" height="48" alt="[CLISP home]" /></a></td><td align="center"><a href="http://sourceforge.net/donate/index.php?group_id=1355"><img src="http://images.sourceforge.net/images/project-support.jpg" width="88" height="32" alt="[Support CLISP]" /></a></td><td align="right"><a href="http://sourceforge.net"><img width="125" height="37" alt="[SourceForge]" src="http://sflogo.sourceforge.net/sflogo.php?group_id=1355&amp;type=2&amp;page=socket" /></a></td></tr></table></div><hr /><form method="get" action="http://www.google.com/custom" target="_top"><table width="100%" border="0"><tr><td nowrap="nowrap" align="center"><input type="hidden" name="domains" value="clisp.cons.org;clisp.podval.org;www.lisp.org" /><label for="sbi" style="display: none">Enter your search terms</label><input type="text" name="q" size="50" maxlength="255" id="sbi" value="32.4. Socket Streams" /><label for="sbb" style="display: none">Submit search form</label><input type="submit" name="sa" value="Google Search" id="sbb" /></td></tr><tr><td nowrap="nowrap" align="center"><input type="radio" name="sitesearch" value="" checked="1" id="ss0" /><label for="ss0" title="Search the Web"><small>Web</small></label><input type="radio" name="sitesearch" value="clisp.cons.org" id="ss1" /><label for="ss1" title="Search clisp.cons.org"><small>clisp.cons.org</small></label><input type="radio" name="sitesearch" value="clisp.podval.org" id="ss2" /><label for="ss2" title="Search clisp.podval.org"><small>clisp.podval.org</small></label><input type="radio" name="sitesearch" value="www.lisp.org" id="ss3" /><label for="ss3" title="Search www.lisp.org"><small>www.lisp.org</small></label><input type="hidden" name="client" value="pub-4445255502750357" /><input type="hidden" name="forid" value="1" /><input type="hidden" name="ie" value="UTF-8" /><input type="hidden" name="oe" value="UTF-8" /><input type="hidden" name="cof" value="GALT:#008000;GL:1;DIV:#336699;VLC:663399;AH:center;BGC:FFFFFF;LBGC:000000;ALC:0000FF;LC:0000FF;T:000000;GFNT:0000FF;GIMP:0000FF;LH:48;LW:48;L:http://clisp.cons.org/clisp.png;S:http://clisp.cons.org;FORID:1" /><input type="hidden" name="hl" value="en" /></td></tr></table></form><hr /><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="dffi.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="ext-platform.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="quickstart.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">32.3. The Foreign Function Call Facility </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> 32.5. Quickstarting delivery with <span class="command"><strong>CLISP</strong></span></td></tr></table></div></body></html>
