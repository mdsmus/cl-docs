<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html>
<head>
<meta name="generator" content=
"HTML Tidy for Linux/x86 (vers 12 April 2005), see www.w3.org">
<title>CLHS: Chapter 20</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="f_merge_.htm">
<link rel="UP" href="../Front/Contents.htm">
<link rel="NEXT" href="20_a.htm">
<title>CLHS: Section 20.1</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="20_.htm">
<link rel="UP" href="20_.htm">
<link rel="NEXT" href="20_aa.htm">
<title>CLHS: Section 20.1.1</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="20_a.htm">
<link rel="UP" href="20_a.htm">
<link rel="NEXT" href="20_ab.htm">
<title>CLHS: Section 20.1.2</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="20_aa.htm">
<link rel="UP" href="20_a.htm">
<link rel="NEXT" href="20_ac.htm">
<title>CLHS: Section 20.1.3</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="20_ab.htm">
<link rel="UP" href="20_a.htm">
<link rel="NEXT" href="20_aca.htm">
<title>CLHS: Section 20.1.3.1</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="20_ac.htm">
<link rel="UP" href="20_ac.htm">
<link rel="NEXT" href="c_files.htm">
</head>
<body>
<p><a name="chaptwenty" id="chaptwenty"></a><a name="files" id=
"files"></a></p>
<h2>20. Files</h2>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>20.1 File System Concepts</h2>
<p>This section describes the Common Lisp interface to file
systems. The model used by this interface assumes that <a rel=
"DEFINITION" href="26_glo_f.htm#file"><i>files</i></a> are named by
<a rel="DEFINITION" href=
"26_glo_f.htm#filename"><i>filenames</i></a>, that a <a rel=
"DEFINITION" href="26_glo_f.htm#filename"><i>filename</i></a> can
be represented by a <a rel="DEFINITION" href=
"26_glo_p.htm#pathname"><i>pathname</i></a> <a rel="DEFINITION"
href="26_glo_o.htm#object"><i>object</i></a>, and that given a
<a rel="DEFINITION" href=
"26_glo_p.htm#pathname"><i>pathname</i></a> a <a rel="DEFINITION"
href="26_glo_s.htm#stream"><i>stream</i></a> can be constructed
that connects to a <a rel="DEFINITION" href=
"26_glo_f.htm#file"><i>file</i></a> whose <a rel="DEFINITION" href=
"26_glo_f.htm#filename"><i>filename</i></a> it represents.</p>
<p>For information about opening and closing <a rel="DEFINITION"
href="26_glo_f.htm#file"><i>files</i></a>, and manipulating their
contents, see <a rel="CHILD" href="21_.htm">Section 21
(Streams)</a>.</p>
<p>The next figure lists some <a rel="DEFINITION" href=
"26_glo_o.htm#operator"><i>operators</i></a> that are applicable to
<a rel="DEFINITION" href="26_glo_f.htm#file"><i>files</i></a> and
directories.</p>
<pre>
<a rel="DEFINITION" href=
"f_cmp_fi.htm#compile-file">compile-file</a>  <a rel="DEFINITION"
href="f_file_l.htm#file-length">file-length</a>      <a rel=
"DEFINITION" href="f_open.htm#open">open</a>            
<a rel="DEFINITION" href=
"f_del_fi.htm#delete-file">delete-file</a>   <a rel="DEFINITION"
href="f_file_p.htm#file-position">file-position</a>    <a rel=
"DEFINITION" href="f_probe_.htm#probe-file">probe-file</a>      
<a rel="DEFINITION" href=
"f_dir.htm#directory">directory</a>     <a rel="DEFINITION" href=
"f_file_w.htm#file-write-date">file-write-date</a>  <a rel=
"DEFINITION" href="f_rn_fil.htm#rename-file">rename-file</a>     
<a rel="DEFINITION" href=
"f_file_a.htm#file-author">file-author</a>   <a rel="DEFINITION"
href="f_load.htm#load">load</a>             <a rel="DEFINITION"
href="m_w_open.htm#with-open-file">with-open-file</a>  
</pre>
<p><b>Figure 20-1. File and Directory Operations</b></p>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>20.1.1 Coercion of Streams to Pathnames</h2>
<p>A <a rel="DEFINITION" href=
"26_glo_s.htm#stream_associated_with_a_file"><i>stream associated
with a file</i></a> is either a <a rel="DEFINITION" href=
"26_glo_f.htm#file_stream"><i>file stream</i></a> or a <a rel=
"DEFINITION" href="26_glo_s.htm#synonym_stream"><i>synonym
stream</i></a> whose target is a <a rel="DEFINITION" href=
"26_glo_s.htm#stream_associated_with_a_file"><i>stream associated
with a file</i></a>. Such streams can be used as <a rel=
"DEFINITION" href="26_glo_p.htm#pathname_designator"><i>pathname
designators</i></a>.</p>
<p>Normally, when a <a rel="DEFINITION" href=
"26_glo_s.htm#stream_associated_with_a_file"><i>stream associated
with a file</i></a> is used as a <a rel="DEFINITION" href=
"26_glo_p.htm#pathname_designator"><i>pathname designator</i></a>,
it denotes the <a rel="DEFINITION" href=
"26_glo_p.htm#pathname"><i>pathname</i></a> used to open the
<a rel="DEFINITION" href="26_glo_f.htm#file"><i>file</i></a>; this
may be, but is not required to be, the actual name of the <a rel=
"DEFINITION" href="26_glo_f.htm#file"><i>file</i></a>.</p>
<p>Some functions, such as <a rel="DEFINITION" href=
"f_tn.htm#truename"><b>truename</b></a> and <a rel="DEFINITION"
href="f_del_fi.htm#delete-file"><b>delete-file</b></a>, coerce
<a rel="DEFINITION" href="26_glo_s.htm#stream"><i>streams</i></a>
to <a rel="DEFINITION" href=
"26_glo_p.htm#pathname"><i>pathnames</i></a> in a different way
that involves referring to the actual <a rel="DEFINITION" href=
"26_glo_f.htm#file"><i>file</i></a> that is open, which might or
might not be the file whose name was opened originally. Such
special situations are always notated specifically and are not the
default.</p>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>20.1.2 File Operations on Open and Closed Streams</h2>
<p>Many <a rel="DEFINITION" href=
"26_glo_f.htm#function"><i>functions</i></a> that perform <a rel=
"DEFINITION" href="26_glo_f.htm#file"><i>file</i></a> operations
accept either <a rel="DEFINITION" href=
"26_glo_o.htm#open"><i>open</i></a> or <a rel="DEFINITION" href=
"26_glo_c.htm#closed"><i>closed</i></a> <a rel="DEFINITION" href=
"26_glo_s.htm#stream"><i>streams</i></a> as <a rel="DEFINITION"
href="26_glo_a.htm#argument"><i>arguments</i></a>; see <a rel=
"CHILD" href="21_ac.htm">Section 21.1.3 (Stream Arguments to
Standardized Functions)</a>.</p>
<p>Of these, the <a rel="DEFINITION" href=
"26_glo_f.htm#function"><i>functions</i></a> in the next figure
treat <a rel="DEFINITION" href="26_glo_o.htm#open"><i>open</i></a>
and <a rel="DEFINITION" href=
"26_glo_c.htm#closed"><i>closed</i></a> <a rel="DEFINITION" href=
"26_glo_s.htm#stream"><i>streams</i></a> differently.</p>
<pre>
<a rel="DEFINITION" href=
"f_del_fi.htm#delete-file">delete-file</a>  <a rel="DEFINITION"
href="f_file_a.htm#file-author">file-author</a>      <a rel=
"DEFINITION" href="f_probe_.htm#probe-file">probe-file</a>  
<a rel="DEFINITION" href=
"f_dir.htm#directory">directory</a>    <a rel="DEFINITION" href=
"f_file_w.htm#file-write-date">file-write-date</a>  <a rel=
"DEFINITION" href="f_tn.htm#truename">truename</a>    
</pre>
<p><b>Figure 20-2. File Functions that Treat Open and Closed
Streams Differently</b></p>
<p>Since treatment of <a rel="DEFINITION" href=
"26_glo_o.htm#open"><i>open</i></a> <a rel="DEFINITION" href=
"26_glo_s.htm#stream"><i>streams</i></a> by the <a rel="DEFINITION"
href="26_glo_f.htm#file_system"><i>file system</i></a> may vary
considerably between <a rel="DEFINITION" href=
"26_glo_i.htm#implementation"><i>implementations</i></a>, however,
a <a rel="DEFINITION" href="26_glo_c.htm#closed"><i>closed</i></a>
<a rel="DEFINITION" href="26_glo_s.htm#stream"><i>stream</i></a>
might be the most reliable kind of <a rel="DEFINITION" href=
"26_glo_a.htm#argument"><i>argument</i></a> for some of these
functions---in particular, those in the next figure. For example,
in some <a rel="DEFINITION" href="26_glo_f.htm#file_system"><i>file
systems</i></a>, <a rel="DEFINITION" href=
"26_glo_o.htm#open"><i>open</i></a> <a rel="DEFINITION" href=
"26_glo_f.htm#file"><i>files</i></a> are written under temporary
names and not renamed until <a rel="DEFINITION" href=
"26_glo_c.htm#closed"><i>closed</i></a> and/or are held invisible
until <a rel="DEFINITION" href=
"26_glo_c.htm#closed"><i>closed</i></a>. In general, any code that
is intended to be portable should use such <a rel="DEFINITION"
href="26_glo_f.htm#function"><i>functions</i></a> carefully.</p>
<pre>
<a rel="DEFINITION" href=
"f_dir.htm#directory">directory</a>  <a rel="DEFINITION" href=
"f_probe_.htm#probe-file">probe-file</a>  <a rel="DEFINITION" href=
"f_tn.htm#truename">truename</a>  
</pre>
<p><b>Figure 20-3. File Functions where Closed Streams Might Work
Best</b></p>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>20.1.3 Truenames</h2>
<p>Many <a rel="DEFINITION" href="26_glo_f.htm#file_system"><i>file
systems</i></a> permit more than one <a rel="DEFINITION" href=
"26_glo_f.htm#filename"><i>filename</i></a> to designate a
particular <a rel="DEFINITION" href=
"26_glo_f.htm#file"><i>file</i></a>.</p>
<p>Even where multiple names are possible, most <a rel="DEFINITION"
href="26_glo_f.htm#file_system"><i>file systems</i></a> have a
convention for generating a canonical <a rel="DEFINITION" href=
"26_glo_f.htm#filename"><i>filename</i></a> in such situations.
Such a canonical <a rel="DEFINITION" href=
"26_glo_f.htm#filename"><i>filename</i></a> (or the <a rel=
"DEFINITION" href="26_glo_p.htm#pathname"><i>pathname</i></a>
representing such a <a rel="DEFINITION" href=
"26_glo_f.htm#filename"><i>filename</i></a>) is called a <a rel=
"DEFINITION" href="26_glo_t.htm#truename"><i>truename</i></a>.</p>
<p>The <a rel="DEFINITION" href=
"26_glo_t.htm#truename"><i>truename</i></a> of a <a rel=
"DEFINITION" href="26_glo_f.htm#file"><i>file</i></a> may differ
from other <a rel="DEFINITION" href=
"26_glo_f.htm#filename"><i>filenames</i></a> for the file because
of symbolic links, version numbers, logical device translations in
the <a rel="DEFINITION" href="26_glo_f.htm#file_system"><i>file
system</i></a>, <a rel="DEFINITION" href=
"26_glo_l.htm#logical_pathname"><i>logical pathname</i></a>
translations within Common Lisp, or other artifacts of the <a rel=
"DEFINITION" href="26_glo_f.htm#file_system"><i>file
system</i></a>.</p>
<p>The <a rel="DEFINITION" href=
"26_glo_t.htm#truename"><i>truename</i></a> for a <a rel=
"DEFINITION" href="26_glo_f.htm#file"><i>file</i></a> is often, but
not necessarily, unique for each <a rel="DEFINITION" href=
"26_glo_f.htm#file"><i>file</i></a>. For instance, a Unix <a rel=
"DEFINITION" href="26_glo_f.htm#file"><i>file</i></a> with multiple
hard links could have several <a rel="DEFINITION" href=
"26_glo_t.htm#truename"><i>truenames</i></a>.</p>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>20.1.3.1 Examples of Truenames</h2>
<p>For example, a DEC TOPS-20 system with <a rel="DEFINITION" href=
"26_glo_f.htm#file"><i>files</i></a>
<tt>PS:&lt;JOE&gt;FOO.TXT.1</tt> and
<tt>PS:&lt;JOE&gt;FOO.TXT.2</tt> might permit the second <a rel=
"DEFINITION" href="26_glo_f.htm#file"><i>file</i></a> to be
referred to as <tt>PS:&lt;JOE&gt;FOO.TXT.0</tt>, since the
"<tt>.0</tt>" notation denotes "newest" version of several <a rel=
"DEFINITION" href="26_glo_f.htm#file"><i>files</i></a>. In the same
<a rel="DEFINITION" href="26_glo_f.htm#file_system"><i>file
system</i></a>, a "logical device" "<tt>JOE:</tt>" might be taken
to refer to <tt>PS:&lt;JOE&gt;</tt>" and so the names
<tt>JOE:FOO.TXT.2</tt> or <tt>JOE:FOO.TXT.0</tt> might refer to
<tt>PS:&lt;JOE&gt;FOO.TXT.2</tt>. In all of these cases, the
<a rel="DEFINITION" href=
"26_glo_t.htm#truename"><i>truename</i></a> of the file would
probably be <tt>PS:&lt;JOE&gt;FOO.TXT.2</tt>.</p>
<p>If a <a rel="DEFINITION" href=
"26_glo_f.htm#file"><i>file</i></a> is a symbolic link to another
<a rel="DEFINITION" href="26_glo_f.htm#file"><i>file</i></a> (in a
<a rel="DEFINITION" href="26_glo_f.htm#file_system"><i>file
system</i></a> permitting such a thing), it is conventional for the
<a rel="DEFINITION" href=
"26_glo_t.htm#truename"><i>truename</i></a> to be the canonical
name of the <a rel="DEFINITION" href=
"26_glo_f.htm#file"><i>file</i></a> after any symbolic links have
been followed; that is, it is the canonical name of the <a rel=
"DEFINITION" href="26_glo_f.htm#file"><i>file</i></a> whose
contents would become available if an <a rel="DEFINITION" href=
"26_glo_i.htm#input"><i>input</i></a> <a rel="DEFINITION" href=
"26_glo_s.htm#stream"><i>stream</i></a> to that <a rel="DEFINITION"
href="26_glo_f.htm#file"><i>file</i></a> were opened.</p>
<p>In the case of a <a rel="DEFINITION" href=
"26_glo_f.htm#file"><i>file</i></a> still being created (that is,
of an <a rel="DEFINITION" href=
"26_glo_o.htm#output"><i>output</i></a> <a rel="DEFINITION" href=
"26_glo_s.htm#stream"><i>stream</i></a> open to such a <a rel=
"DEFINITION" href="26_glo_f.htm#file"><i>file</i></a>), the exact
<a rel="DEFINITION" href=
"26_glo_t.htm#truename"><i>truename</i></a> of the file might not
be known until the <a rel="DEFINITION" href=
"26_glo_s.htm#stream"><i>stream</i></a> is closed. In this case,
the <a rel="DEFINITION" href=
"26_glo_f.htm#function"><i>function</i></a> <a rel="DEFINITION"
href="f_tn.htm#truename"><b>truename</b></a> might return different
values for such a <a rel="DEFINITION" href=
"26_glo_s.htm#stream"><i>stream</i></a> before and after it was
closed. In fact, before it is closed, the name returned might not
even be a valid name in the <a rel="DEFINITION" href=
"26_glo_f.htm#file_system"><i>file system</i></a>---for example,
while a file is being written, it might have version
<tt>:newest</tt> and might only take on a specific numeric value
later when the file is closed even in a <a rel="DEFINITION" href=
"26_glo_f.htm#file_system"><i>file system</i></a> where all files
have numeric versions.</p>
</body>
</html>
