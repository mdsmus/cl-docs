<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html>
<head>
<meta name="generator" content=
"HTML Tidy for Linux/x86 (vers 12 April 2005), see www.w3.org">
<title>CLHS: Chapter 6</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="e_undefi.htm">
<link rel="UP" href="../Front/Contents.htm">
<link rel="NEXT" href="06_a.htm">
<title>CLHS: Section 6.1</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="06_.htm">
<link rel="UP" href="06_.htm">
<link rel="NEXT" href="06_aa.htm">
<title>CLHS: Section 6.1.1</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="06_a.htm">
<link rel="UP" href="06_a.htm">
<link rel="NEXT" href="06_aaa.htm">
<title>CLHS: Section 6.1.1.1</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="06_aa.htm">
<link rel="UP" href="06_aa.htm">
<link rel="NEXT" href="06_aaaa.htm">
<title>CLHS: Section 6.1.1.1.1</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="06_aaa.htm">
<link rel="UP" href="06_aaa.htm">
<link rel="NEXT" href="06_aaab.htm">
<title>CLHS: Section 6.1.1.1.2</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="06_aaaa.htm">
<link rel="UP" href="06_aaa.htm">
<link rel="NEXT" href="06_aab.htm">
<title>CLHS: Section 6.1.1.2</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="06_aaab.htm">
<link rel="UP" href="06_aa.htm">
<link rel="NEXT" href="06_aac.htm">
<title>CLHS: Section 6.1.1.3</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="06_aab.htm">
<link rel="UP" href="06_aa.htm">
<link rel="NEXT" href="06_aad.htm">
<title>CLHS: Section 6.1.1.4</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="06_aac.htm">
<link rel="UP" href="06_aa.htm">
<link rel="NEXT" href="06_aae.htm">
<title>CLHS: Section 6.1.1.5</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="06_aad.htm">
<link rel="UP" href="06_aa.htm">
<link rel="NEXT" href="06_aaea.htm">
<title>CLHS: Section 6.1.1.5.1</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="06_aae.htm">
<link rel="UP" href="06_aae.htm">
<link rel="NEXT" href="06_aaeb.htm">
<title>CLHS: Section 6.1.1.5.2</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="06_aaea.htm">
<link rel="UP" href="06_aae.htm">
<link rel="NEXT" href="06_aaec.htm">
<title>CLHS: Section 6.1.1.5.3</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="06_aaeb.htm">
<link rel="UP" href="06_aae.htm">
<link rel="NEXT" href="06_aaed.htm">
<title>CLHS: Section 6.1.1.5.4</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="06_aaec.htm">
<link rel="UP" href="06_aae.htm">
<link rel="NEXT" href="06_aaee.htm">
<title>CLHS: Section 6.1.1.5.5</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="06_aaed.htm">
<link rel="UP" href="06_aae.htm">
<link rel="NEXT" href="06_aaef.htm">
<title>CLHS: Section 6.1.1.5.6</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="06_aaee.htm">
<link rel="UP" href="06_aae.htm">
<link rel="NEXT" href="06_aaf.htm">
<title>CLHS: Section 6.1.1.6</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="06_aaef.htm">
<link rel="UP" href="06_aa.htm">
<link rel="NEXT" href="06_aag.htm">
<title>CLHS: Section 6.1.1.7</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="06_aaf.htm">
<link rel="UP" href="06_aa.htm">
<link rel="NEXT" href="06_aah.htm">
<title>CLHS: Section 6.1.1.8</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="06_aag.htm">
<link rel="UP" href="06_aa.htm">
<link rel="NEXT" href="06_ab.htm">
<title>CLHS: Section 6.1.2</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="06_aah.htm">
<link rel="UP" href="06_a.htm">
<link rel="NEXT" href="06_aba.htm">
<title>CLHS: Section 6.1.2.1</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="06_ab.htm">
<link rel="UP" href="06_ab.htm">
<link rel="NEXT" href="06_abaa.htm">
<title>CLHS: Section 6.1.2.1.1</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="06_aba.htm">
<link rel="UP" href="06_aba.htm">
<link rel="NEXT" href="06_abaaa.htm">
<title>CLHS: Section 6.1.2.1.1.1</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="06_abaa.htm">
<link rel="UP" href="06_abaa.htm">
<link rel="NEXT" href="06_abab.htm">
<title>CLHS: Section 6.1.2.1.2</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="06_abaaa.htm">
<link rel="UP" href="06_aba.htm">
<link rel="NEXT" href="06_ababa.htm">
<title>CLHS: Section 6.1.2.1.2.1</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="06_abab.htm">
<link rel="UP" href="06_abab.htm">
<link rel="NEXT" href="06_abac.htm">
<title>CLHS: Section 6.1.2.1.3</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="06_ababa.htm">
<link rel="UP" href="06_aba.htm">
<link rel="NEXT" href="06_abaca.htm">
<title>CLHS: Section 6.1.2.1.3.1</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="06_abac.htm">
<link rel="UP" href="06_abac.htm">
<link rel="NEXT" href="06_abad.htm">
<title>CLHS: Section 6.1.2.1.4</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="06_abaca.htm">
<link rel="UP" href="06_aba.htm">
<link rel="NEXT" href="06_abada.htm">
<title>CLHS: Section 6.1.2.1.4.1</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="06_abad.htm">
<link rel="UP" href="06_abad.htm">
<link rel="NEXT" href="06_abae.htm">
<title>CLHS: Section 6.1.2.1.5</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="06_abada.htm">
<link rel="UP" href="06_aba.htm">
<link rel="NEXT" href="06_abaea.htm">
<title>CLHS: Section 6.1.2.1.5.1</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="06_abae.htm">
<link rel="UP" href="06_abae.htm">
<link rel="NEXT" href="06_abaf.htm">
<title>CLHS: Section 6.1.2.1.6</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="06_abaea.htm">
<link rel="UP" href="06_aba.htm">
<link rel="NEXT" href="06_abag.htm">
<title>CLHS: Section 6.1.2.1.7</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="06_abaf.htm">
<link rel="UP" href="06_aba.htm">
<link rel="NEXT" href="06_abaga.htm">
<title>CLHS: Section 6.1.2.1.7.1</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="06_abag.htm">
<link rel="UP" href="06_abag.htm">
<link rel="NEXT" href="06_abb.htm">
<title>CLHS: Section 6.1.2.2</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="06_abaga.htm">
<link rel="UP" href="06_ab.htm">
<link rel="NEXT" href="06_abba.htm">
<title>CLHS: Section 6.1.2.2.1</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="06_abb.htm">
<link rel="UP" href="06_abb.htm">
<link rel="NEXT" href="06_ac.htm">
<title>CLHS: Section 6.1.3</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="06_abba.htm">
<link rel="UP" href="06_a.htm">
<link rel="NEXT" href="06_aca.htm">
<title>CLHS: Section 6.1.3.1</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="06_ac.htm">
<link rel="UP" href="06_ac.htm">
<link rel="NEXT" href="06_acb.htm">
<title>CLHS: Section 6.1.3.2</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="06_aca.htm">
<link rel="UP" href="06_ac.htm">
<link rel="NEXT" href="06_acc.htm">
<title>CLHS: Section 6.1.3.3</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="06_acb.htm">
<link rel="UP" href="06_ac.htm">
<link rel="NEXT" href="06_acd.htm">
<title>CLHS: Section 6.1.3.4</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="06_acc.htm">
<link rel="UP" href="06_ac.htm">
<link rel="NEXT" href="06_ace.htm">
<title>CLHS: Section 6.1.3.5</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="06_acd.htm">
<link rel="UP" href="06_ac.htm">
<link rel="NEXT" href="06_ad.htm">
<title>CLHS: Section 6.1.4</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="06_ace.htm">
<link rel="UP" href="06_a.htm">
<link rel="NEXT" href="06_ada.htm">
<title>CLHS: Section 6.1.4.1</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="06_ad.htm">
<link rel="UP" href="06_ad.htm">
<link rel="NEXT" href="06_adb.htm">
<title>CLHS: Section 6.1.4.2</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="06_ada.htm">
<link rel="UP" href="06_ad.htm">
<link rel="NEXT" href="06_adc.htm">
<title>CLHS: Section 6.1.4.3</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="06_adb.htm">
<link rel="UP" href="06_ad.htm">
<link rel="NEXT" href="06_ae.htm">
<title>CLHS: Section 6.1.5</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="06_adc.htm">
<link rel="UP" href="06_a.htm">
<link rel="NEXT" href="06_aea.htm">
<title>CLHS: Section 6.1.5.1</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="06_ae.htm">
<link rel="UP" href="06_ae.htm">
<link rel="NEXT" href="06_af.htm">
<title>CLHS: Section 6.1.6</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="06_aea.htm">
<link rel="UP" href="06_a.htm">
<link rel="NEXT" href="06_afa.htm">
<title>CLHS: Section 6.1.6.1</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="06_af.htm">
<link rel="UP" href="06_af.htm">
<link rel="NEXT" href="06_ag.htm">
<title>CLHS: Section 6.1.7</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="06_afa.htm">
<link rel="UP" href="06_a.htm">
<link rel="NEXT" href="06_aga.htm">
<title>CLHS: Section 6.1.7.1</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="06_ag.htm">
<link rel="UP" href="06_ag.htm">
<link rel="NEXT" href="06_agaa.htm">
<title>CLHS: Section 6.1.7.1.1</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="06_aga.htm">
<link rel="UP" href="06_aga.htm">
<link rel="NEXT" href="06_agb.htm">
<title>CLHS: Section 6.1.7.2</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="06_agaa.htm">
<link rel="UP" href="06_ag.htm">
<link rel="NEXT" href="06_ah.htm">
<title>CLHS: Section 6.1.8</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="06_agb.htm">
<link rel="UP" href="06_a.htm">
<link rel="NEXT" href="06_aha.htm">
<title>CLHS: Section 6.1.8.1</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="06_ah.htm">
<link rel="UP" href="06_ah.htm">
<link rel="NEXT" href="06_ai.htm">
<title>CLHS: Section 6.1.9</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="06_aha.htm">
<link rel="UP" href="06_a.htm">
<link rel="NEXT" href="c_iterat.htm">
</head>
<body>
<p><a name="chapsix" id="chapsix"></a><a name="iteration" id=
"iteration"></a></p>
<h2>6. Iteration</h2>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>6.1 The LOOP Facility</h2>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>6.1.1 Overview of the Loop Facility</h2>
<p>The <a rel="DEFINITION" href="m_loop.htm#loop"><b>loop</b></a>
<a rel="DEFINITION" href="26_glo_m.htm#macro"><i>macro</i></a>
performs iteration.</p>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>6.1.1.1 Simple vs Extended Loop</h2>
<p><a rel="DEFINITION" href="m_loop.htm#loop"><b>loop</b></a>
<a rel="DEFINITION" href="26_glo_f.htm#form"><i>forms</i></a> are
partitioned into two categories: simple <a rel="DEFINITION" href=
"m_loop.htm#loop"><b>loop</b></a> <a rel="DEFINITION" href=
"26_glo_f.htm#form"><i>forms</i></a> and extended <a rel=
"DEFINITION" href="m_loop.htm#loop"><b>loop</b></a> <a rel=
"DEFINITION" href="26_glo_f.htm#form"><i>forms</i></a>.</p>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>6.1.1.1.1 Simple Loop</h2>
<p>A simple <a rel="DEFINITION" href=
"m_loop.htm#loop"><b>loop</b></a> <a rel="DEFINITION" href=
"26_glo_f.htm#form"><i>form</i></a> is one that has a body
containing only <a rel="DEFINITION" href=
"26_glo_c.htm#compound_form"><i>compound forms</i></a>. Each
<a rel="DEFINITION" href="26_glo_f.htm#form"><i>form</i></a> is
<i>evaluated</i> in turn from left to right. When the last
<i>form</i> has been <i>evaluated</i>, then the first <i>form</i>
is evaluated again, and so on, in a never-ending cycle. A simple
<a rel="DEFINITION" href="m_loop.htm#loop"><b>loop</b></a> <a rel=
"DEFINITION" href="26_glo_f.htm#form"><i>form</i></a> establishes
an <a rel="DEFINITION" href=
"26_glo_i.htm#implicit_block"><i>implicit block</i></a> named
<a rel="DEFINITION" href="a_nil.htm#nil"><b>nil</b></a>. The
execution of a simple <a rel="DEFINITION" href=
"m_loop.htm#loop"><b>loop</b></a> can be terminated by explicitly
transfering control to the <a rel="DEFINITION" href=
"26_glo_i.htm#implicit_block"><i>implicit block</i></a> (using
<a rel="DEFINITION" href="m_return.htm#return"><b>return</b></a> or
<a rel="DEFINITION" href=
"s_ret_fr.htm#return-from"><b>return-from</b></a>) or to some
<a rel="DEFINITION" href="26_glo_e.htm#exit_point"><i>exit
point</i></a> outside of the <a rel="DEFINITION" href=
"26_glo_b.htm#block"><i>block</i></a> (e.g., using <a rel=
"DEFINITION" href="s_throw.htm#throw"><b>throw</b></a>, <a rel=
"DEFINITION" href="s_go.htm#go"><b>go</b></a>, or <a rel=
"DEFINITION" href=
"s_ret_fr.htm#return-from"><b>return-from</b></a>).</p>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>6.1.1.1.2 Extended Loop</h2>
<p>An extended <a rel="DEFINITION" href=
"m_loop.htm#loop"><b>loop</b></a> <a rel="DEFINITION" href=
"26_glo_f.htm#form"><i>form</i></a> is one that has a body
containing <a rel="DEFINITION" href=
"26_glo_a.htm#atomic"><i>atomic</i></a> <a rel="DEFINITION" href=
"26_glo_e.htm#expression"><i>expressions</i></a>. When the <a rel=
"DEFINITION" href="m_loop.htm#loop"><b>loop</b></a> <a rel=
"DEFINITION" href="26_glo_m.htm#macro"><i>macro</i></a> processes
such a <a rel="DEFINITION" href=
"26_glo_f.htm#form"><i>form</i></a>, it invokes a facility that is
commonly called "the Loop Facility."</p>
<p>The Loop Facility provides standardized access to mechanisms
commonly used in iterations through Loop schemas, which are
introduced by <a rel="DEFINITION" href=
"26_glo_l.htm#loop_keyword"><i>loop keywords</i></a>.</p>
<p>The body of an extended <a rel="DEFINITION" href=
"m_loop.htm#loop"><b>loop</b></a> <a rel="DEFINITION" href=
"26_glo_f.htm#form"><i>form</i></a> is divided into <a rel=
"DEFINITION" href="m_loop.htm#loop"><b>loop</b></a> clauses, each
which is in turn made up of <a rel="DEFINITION" href=
"26_glo_l.htm#loop_keyword"><i>loop keywords</i></a> and <a rel=
"DEFINITION" href="26_glo_f.htm#form"><i>forms</i></a>.</p>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>6.1.1.2 Loop Keywords</h2>
<p><a rel="DEFINITION" href="26_glo_l.htm#loop_keyword"><i>Loop
keywords</i></a> are not true <a rel="DEFINITION" href=
"26_glo_k.htm#keyword"><i>keywords</i></a>[1]; they are special
<a rel="DEFINITION" href="26_glo_s.htm#symbol"><i>symbols</i></a>,
recognized by <a rel="DEFINITION" href=
"26_glo_n.htm#name"><i>name</i></a> rather than <a rel="DEFINITION"
href="26_glo_o.htm#object"><i>object</i></a> identity, that are
meaningful only to the <a rel="DEFINITION" href=
"m_loop.htm#loop"><b>loop</b></a> facility. A <a rel="DEFINITION"
href="26_glo_l.htm#loop_keyword"><i>loop keyword</i></a> is a
<a rel="DEFINITION" href="26_glo_s.htm#symbol"><i>symbol</i></a>
but is recognized by its <a rel="DEFINITION" href=
"26_glo_n.htm#name"><i>name</i></a> (not its identity), regardless
of the <a rel="DEFINITION" href=
"26_glo_p.htm#package"><i>packages</i></a> in which it is <a rel=
"DEFINITION" href=
"26_glo_a.htm#accessible"><i>accessible</i></a>.</p>
<p>In general, <a rel="DEFINITION" href=
"26_glo_l.htm#loop_keyword"><i>loop keywords</i></a> are not
<a rel="DEFINITION" href="26_glo_e.htm#external_symbol"><i>external
symbols</i></a> of the <tt>COMMON-LISP</tt> package, except in the
coincidental situation that a <a rel="DEFINITION" href=
"26_glo_s.htm#symbol"><i>symbol</i></a> with the same name as a
<a rel="DEFINITION" href="26_glo_l.htm#loop_keyword"><i>loop
keyword</i></a> was needed for some other purpose in Common Lisp.
For example, there is a <a rel="DEFINITION" href=
"26_glo_s.htm#symbol"><i>symbol</i></a> in the <tt>COMMON-LISP</tt>
package whose <a rel="DEFINITION" href=
"26_glo_n.htm#name"><i>name</i></a> is <tt>"UNLESS"</tt> but not
one whose <a rel="DEFINITION" href=
"26_glo_n.htm#name"><i>name</i></a> is <tt>"UNTIL"</tt>.</p>
<p>If no <a rel="DEFINITION" href=
"26_glo_l.htm#loop_keyword"><i>loop keywords</i></a> are supplied
in a <a rel="DEFINITION" href="m_loop.htm#loop"><b>loop</b></a>
<a rel="DEFINITION" href="26_glo_f.htm#form"><i>form</i></a>, the
Loop Facility executes the loop body repeatedly; see <a rel="CHILD"
href="06_aaaa.htm">Section 6.1.1.1.1 (Simple Loop)</a>.</p>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>6.1.1.3 Parsing Loop Clauses</h2>
<p>The syntactic parts of an extended <a rel="DEFINITION" href=
"m_loop.htm#loop"><b>loop</b></a> <a rel="DEFINITION" href=
"26_glo_f.htm#form"><i>form</i></a> are called clauses; the rules
for parsing are determined by that clause's keyword. The following
example shows a <a rel="DEFINITION" href=
"m_loop.htm#loop"><b>loop</b></a> <a rel="DEFINITION" href=
"26_glo_f.htm#form"><i>form</i></a> with six clauses:</p>
<pre>
 (loop for i from 1 to (compute-top-value)       ; first clause
       while (not (unacceptable i))              ; second clause
       collect (square i)                        ; third clause
       do (format t "Working on ~D now" i)       ; fourth clause
       when (evenp i)                            ; fifth clause
         do (format t "~D is a non-odd number" i)
       finally (format t "About to exit!"))      ; sixth clause
</pre>
<p>Each <a rel="DEFINITION" href=
"26_glo_l.htm#loop_keyword"><i>loop keyword</i></a> introduces
either a compound loop clause or a simple loop clause that can
consist of a <a rel="DEFINITION" href=
"26_glo_l.htm#loop_keyword"><i>loop keyword</i></a> followed by a
single <a rel="DEFINITION" href=
"26_glo_f.htm#form"><i>form</i></a>. The number of <a rel=
"DEFINITION" href="26_glo_f.htm#form"><i>forms</i></a> in a clause
is determined by the <a rel="DEFINITION" href=
"26_glo_l.htm#loop_keyword"><i>loop keyword</i></a> that begins the
clause and by the auxiliary keywords in the clause. The keywords
<tt>do</tt>, <tt>doing</tt>, <tt>initially</tt>, and
<tt>finally</tt> are the only loop keywords that can take any
number of <a rel="DEFINITION" href=
"26_glo_f.htm#form"><i>forms</i></a> and group them as an <a rel=
"DEFINITION" href="26_glo_i.htm#implicit_progn"><i>implicit
progn</i></a>.</p>
<p>Loop clauses can contain auxiliary keywords, which are sometimes
called prepositions. For example, the first clause in the code
above includes the prepositions <tt>from</tt> and <tt>to</tt>,
which mark the value from which stepping begins and the value at
which stepping ends.</p>
<p>For detailed information about <a rel="DEFINITION" href=
"m_loop.htm#loop"><b>loop</b></a> syntax, see the <a rel=
"DEFINITION" href="26_glo_m.htm#macro"><i>macro</i></a> <a rel=
"DEFINITION" href="m_loop.htm#loop"><b>loop</b></a>.</p>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>6.1.1.4 Expanding Loop Forms</h2>
<p>A <a rel="DEFINITION" href="m_loop.htm#loop"><b>loop</b></a>
<a rel="DEFINITION" href="26_glo_m.htm#macro_form"><i>macro
form</i></a> expands into a <a rel="DEFINITION" href=
"26_glo_f.htm#form"><i>form</i></a> containing one or more binding
forms (that <a rel="DEFINITION" href=
"26_glo_e.htm#establish"><i>establish</i></a> <a rel="DEFINITION"
href="26_glo_b.htm#binding"><i>bindings</i></a> of loop variables)
and a <a rel="DEFINITION" href="s_block.htm#block"><b>block</b></a>
and a <a rel="DEFINITION" href=
"s_tagbod.htm#tagbody"><b>tagbody</b></a> (that express a looping
control structure). The variables established in <a rel=
"DEFINITION" href="m_loop.htm#loop"><b>loop</b></a> are bound as if
by <a rel="DEFINITION" href="s_let_l.htm#let"><b>let</b></a> or
<a rel="DEFINITION" href=
"a_lambda.htm#lambda"><b>lambda</b></a>.</p>
<p>Implementations can interleave the setting of initial values
with the <a rel="DEFINITION" href=
"26_glo_b.htm#binding"><i>bindings</i></a>. However, the assignment
of the initial values is always calculated in the order specified
by the user. A variable is thus sometimes bound to a meaningless
value of the correct <a rel="DEFINITION" href=
"26_glo_t.htm#type"><i>type</i></a>, and then later in the prologue
it is set to the true initial value by using <a rel="DEFINITION"
href="s_setq.htm#setq"><b>setq</b></a>. One implication of this
interleaving is that it is <a rel="DEFINITION" href=
"26_glo_i.htm#implementation-dependent"><i>implementation-dependent</i></a>
whether the <a rel="DEFINITION" href=
"26_glo_l.htm#lexical_environment"><i>lexical environment</i></a>
in which the initial value <a rel="DEFINITION" href=
"26_glo_f.htm#form"><i>forms</i></a> (variously called the
<i>form1</i>, <i>form2</i>, <i>form3</i>, <i>step-fun</i>,
<i>vector</i>, <i>hash-table</i>, and <i>package</i>) in any
<i>for-as-subclause</i>, except <i>for-as-equals-then</i>, are
<i>evaluated</i> includes only the loop variables preceding that
<a rel="DEFINITION" href="26_glo_f.htm#form"><i>form</i></a> or
includes more or all of the loop variables; the <i>form1</i> and
<i>form2</i> in a <i>for-as-equals-then</i> form includes the
<a rel="DEFINITION" href=
"26_glo_l.htm#lexical_environment"><i>lexical environment</i></a>
of all the loop variables.</p>
<p>After the <a rel="DEFINITION" href=
"26_glo_f.htm#form"><i>form</i></a> is expanded, it consists of
three basic parts in the <a rel="DEFINITION" href=
"s_tagbod.htm#tagbody"><b>tagbody</b></a>: the loop prologue, the
loop body, and the loop epilogue.</p>
<dl>
<dt><b>Loop prologue</b><br></dt>
<dd>The loop prologue contains <a rel="DEFINITION" href=
"26_glo_f.htm#form"><i>forms</i></a> that are executed before
iteration begins, such as any automatic variable initializations
prescribed by the <i>variable</i> clauses, along with any
<tt>initially</tt> clauses in the order they appear in the
source.</dd>
<dt><b>Loop body</b><br></dt>
<dd>The loop body contains those <a rel="DEFINITION" href=
"26_glo_f.htm#form"><i>forms</i></a> that are executed during
iteration, including application-specific calculations, termination
tests, and variable <i>stepping</i>[1].</dd>
<dt><b>Loop epilogue</b><br></dt>
<dd>The loop epilogue contains <a rel="DEFINITION" href=
"26_glo_f.htm#form"><i>forms</i></a> that are executed after
iteration terminates, such as <tt>finally</tt> clauses, if any,
along with any implicit return value from an <i>accumulation</i>
clause or an <i>termination-test</i> clause.</dd>
</dl>
<p>Some clauses from the source <a rel="DEFINITION" href=
"26_glo_f.htm#form"><i>form</i></a> contribute code only to the
loop prologue; these clauses must come before other clauses that
are in the main body of the <a rel="DEFINITION" href=
"m_loop.htm#loop"><b>loop</b></a> form. Others contribute code only
to the loop epilogue. All other clauses contribute to the final
translated <a rel="DEFINITION" href=
"26_glo_f.htm#form"><i>form</i></a> in the same order given in the
original source <a rel="DEFINITION" href=
"26_glo_f.htm#form"><i>form</i></a> of the <a rel="DEFINITION"
href="m_loop.htm#loop"><b>loop</b></a>.</p>
<p>Expansion of the <a rel="DEFINITION" href=
"m_loop.htm#loop"><b>loop</b></a> macro produces an <a rel=
"DEFINITION" href="26_glo_i.htm#implicit_block"><i>implicit
block</i></a> named <a rel="DEFINITION" href=
"a_nil.htm#nil"><b>nil</b></a> unless <tt>named</tt> is supplied.
Thus, <a rel="DEFINITION" href=
"s_ret_fr.htm#return-from"><b>return-from</b></a> (and sometimes
<a rel="DEFINITION" href="m_return.htm#return"><b>return</b></a>)
can be used to return values from <a rel="DEFINITION" href=
"m_loop.htm#loop"><b>loop</b></a> or to exit <a rel="DEFINITION"
href="m_loop.htm#loop"><b>loop</b></a>.</p>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>6.1.1.5 Summary of Loop Clauses</h2>
<p>Loop clauses fall into one of the following categories:</p>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>6.1.1.5.1 Summary of Variable Initialization and Stepping
Clauses</h2>
<p>The <tt>for</tt> and <tt>as</tt> constructs provide iteration
control clauses that establish a variable to be initialized.
<tt>for</tt> and <tt>as</tt> clauses can be combined with the loop
keyword <tt>and</tt> to get <a rel="DEFINITION" href=
"26_glo_p.htm#parallel"><i>parallel</i></a> initialization and
<i>stepping</i>[1]. Otherwise, the initialization and
<i>stepping</i>[1] are <a rel="DEFINITION" href=
"26_glo_s.htm#sequential"><i>sequential</i></a>.</p>
<p>The <tt>with</tt> construct is similar to a single <a rel=
"DEFINITION" href="s_let_l.htm#let"><b>let</b></a> clause.
<tt>with</tt> clauses can be combined using the <a rel="DEFINITION"
href="26_glo_l.htm#loop_keyword"><i>loop keyword</i></a>
<tt>and</tt> to get <a rel="DEFINITION" href=
"26_glo_p.htm#parallel"><i>parallel</i></a> initialization.</p>
<p>For more information, see <a rel="CHILD" href=
"06_ab.htm">Section 6.1.2 (Variable Initialization and Stepping
Clauses)</a>.</p>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>6.1.1.5.2 Summary of Value Accumulation Clauses</h2>
<p>The <tt>collect</tt> (or <tt>collecting</tt>) construct takes
one <a rel="DEFINITION" href="26_glo_f.htm#form"><i>form</i></a> in
its clause and adds the value of that <a rel="DEFINITION" href=
"26_glo_f.htm#form"><i>form</i></a> to the end of a <a rel=
"DEFINITION" href="26_glo_l.htm#list"><i>list</i></a> of values. By
default, the <a rel="DEFINITION" href=
"26_glo_l.htm#list"><i>list</i></a> of values is returned when the
<a rel="DEFINITION" href="m_loop.htm#loop"><b>loop</b></a>
finishes.</p>
<p>The <tt>append</tt> (or <tt>appending</tt>) construct takes one
<a rel="DEFINITION" href="26_glo_f.htm#form"><i>form</i></a> in its
clause and appends the value of that <a rel="DEFINITION" href=
"26_glo_f.htm#form"><i>form</i></a> to the end of a <a rel=
"DEFINITION" href="26_glo_l.htm#list"><i>list</i></a> of values. By
default, the <a rel="DEFINITION" href=
"26_glo_l.htm#list"><i>list</i></a> of values is returned when the
<a rel="DEFINITION" href="m_loop.htm#loop"><b>loop</b></a>
finishes.</p>
<p>The <tt>nconc</tt> (or <tt>nconcing</tt>) construct is similar
to the <tt>append</tt> construct, but its <a rel="DEFINITION" href=
"26_glo_l.htm#list"><i>list</i></a> values are concatenated as if
by the function <tt>nconc</tt>. By default, the <a rel="DEFINITION"
href="26_glo_l.htm#list"><i>list</i></a> of values is returned when
the <a rel="DEFINITION" href="m_loop.htm#loop"><b>loop</b></a>
finishes.</p>
<p>The <tt>sum</tt> (or <tt>summing</tt>) construct takes one
<a rel="DEFINITION" href="26_glo_f.htm#form"><i>form</i></a> in its
clause that must evaluate to a <a rel="DEFINITION" href=
"26_glo_n.htm#number"><i>number</i></a> and accumulates the sum of
all these <a rel="DEFINITION" href=
"26_glo_n.htm#number"><i>numbers</i></a>. By default, the
cumulative sum is returned when the <a rel="DEFINITION" href=
"m_loop.htm#loop"><b>loop</b></a> finishes.</p>
<p>The <tt>count</tt> (or <tt>counting</tt>) construct takes one
<a rel="DEFINITION" href="26_glo_f.htm#form"><i>form</i></a> in its
clause and counts the number of times that the <a rel="DEFINITION"
href="26_glo_f.htm#form"><i>form</i></a> evaluates to <a rel=
"DEFINITION" href="26_glo_t.htm#true"><i>true</i></a>. By default,
the count is returned when the <a rel="DEFINITION" href=
"m_loop.htm#loop"><b>loop</b></a> finishes.</p>
<p>The <tt>minimize</tt> (or <tt>minimizing</tt>) construct takes
one <a rel="DEFINITION" href="26_glo_f.htm#form"><i>form</i></a> in
its clause and determines the minimum value obtained by evaluating
that <a rel="DEFINITION" href="26_glo_f.htm#form"><i>form</i></a>.
By default, the minimum value is returned when the <a rel=
"DEFINITION" href="m_loop.htm#loop"><b>loop</b></a> finishes.</p>
<p>The <tt>maximize</tt> (or <tt>maximizing</tt>) construct takes
one <a rel="DEFINITION" href="26_glo_f.htm#form"><i>form</i></a> in
its clause and determines the maximum value obtained by evaluating
that <a rel="DEFINITION" href="26_glo_f.htm#form"><i>form</i></a>.
By default, the maximum value is returned when the <a rel=
"DEFINITION" href="m_loop.htm#loop"><b>loop</b></a> finishes.</p>
<p>For more information, see <a rel="CHILD" href=
"06_ac.htm">Section 6.1.3 (Value Accumulation Clauses)</a>.</p>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>6.1.1.5.3 Summary of Termination Test Clauses</h2>
<p>The <tt>for</tt> and <tt>as</tt> constructs provide a
termination test that is determined by the iteration control
clause.</p>
<p>The <tt>repeat</tt> construct causes termination after a
specified number of iterations. (It uses an internal variable to
keep track of the number of iterations.)</p>
<p>The <tt>while</tt> construct takes one <a rel="DEFINITION" href=
"26_glo_f.htm#form"><i>form</i></a>, a <i>test</i>, and terminates
the iteration if the <i>test</i> evaluates to <a rel="DEFINITION"
href="26_glo_f.htm#false"><i>false</i></a>. A <tt>while</tt> clause
is equivalent to the expression <tt>(if (not</tt> <i>test</i><tt>)
(loop-finish))</tt>.</p>
<p>The <tt>until</tt> construct is the inverse of <tt>while</tt>;
it terminates the iteration if the <i>test</i> evaluates to any
<a rel="DEFINITION" href="26_glo_n.htm#non-nil"><i>non-nil</i></a>
value. An <tt>until</tt> clause is equivalent to the expression
<tt>(if</tt> <i>test</i> <tt>(loop-finish))</tt>.</p>
<p>The <tt>always</tt> construct takes one <a rel="DEFINITION"
href="26_glo_f.htm#form"><i>form</i></a> and terminates the <a rel=
"DEFINITION" href="m_loop.htm#loop"><b>loop</b></a> if the <a rel=
"DEFINITION" href="26_glo_f.htm#form"><i>form</i></a> ever
evaluates to <a rel="DEFINITION" href=
"26_glo_f.htm#false"><i>false</i></a>; in this case, the <a rel=
"DEFINITION" href="m_loop.htm#loop"><b>loop</b></a> <a rel=
"DEFINITION" href="26_glo_f.htm#form"><i>form</i></a> returns
<a rel="DEFINITION" href="a_nil.htm#nil"><b>nil</b></a>. Otherwise,
it provides a default return value of <a rel="DEFINITION" href=
"a_t.htm#t"><b>t</b></a>.</p>
<p>The <tt>never</tt> construct takes one <a rel="DEFINITION" href=
"26_glo_f.htm#form"><i>form</i></a> and terminates the <a rel=
"DEFINITION" href="m_loop.htm#loop"><b>loop</b></a> if the <a rel=
"DEFINITION" href="26_glo_f.htm#form"><i>form</i></a> ever
evaluates to <a rel="DEFINITION" href=
"26_glo_t.htm#true"><i>true</i></a>; in this case, the <a rel=
"DEFINITION" href="m_loop.htm#loop"><b>loop</b></a> <a rel=
"DEFINITION" href="26_glo_f.htm#form"><i>form</i></a> returns
<a rel="DEFINITION" href="a_nil.htm#nil"><b>nil</b></a>. Otherwise,
it provides a default return value of <a rel="DEFINITION" href=
"a_t.htm#t"><b>t</b></a>.</p>
<p>The <tt>thereis</tt> construct takes one <a rel="DEFINITION"
href="26_glo_f.htm#form"><i>form</i></a> and terminates the <a rel=
"DEFINITION" href="m_loop.htm#loop"><b>loop</b></a> if the <a rel=
"DEFINITION" href="26_glo_f.htm#form"><i>form</i></a> ever
evaluates to a <a rel="DEFINITION" href=
"26_glo_n.htm#non-nil"><i>non-nil</i></a> <a rel="DEFINITION" href=
"26_glo_o.htm#object"><i>object</i></a>; in this case, the <a rel=
"DEFINITION" href="m_loop.htm#loop"><b>loop</b></a> <a rel=
"DEFINITION" href="26_glo_f.htm#form"><i>form</i></a> returns that
<a rel="DEFINITION" href="26_glo_o.htm#object"><i>object</i></a>.
Otherwise, it provides a default return value of <a rel=
"DEFINITION" href="a_nil.htm#nil"><b>nil</b></a>.</p>
<p>If multiple termination test clauses are specified, the <a rel=
"DEFINITION" href="m_loop.htm#loop"><b>loop</b></a> <a rel=
"DEFINITION" href="26_glo_f.htm#form"><i>form</i></a> terminates if
any are satisfied.</p>
<p>For more information, see <a rel="CHILD" href=
"06_ad.htm">Section 6.1.4 (Termination Test Clauses)</a>.</p>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>6.1.1.5.4 Summary of Unconditional Execution Clauses</h2>
<p>The <tt>do</tt> (or <tt>doing</tt>) construct evaluates all
<a rel="DEFINITION" href="26_glo_f.htm#form"><i>forms</i></a> in
its clause.</p>
<p>The <tt>return</tt> construct takes one <a rel="DEFINITION"
href="26_glo_f.htm#form"><i>form</i></a>. Any <a rel="DEFINITION"
href="26_glo_v.htm#value"><i>values</i></a> returned by the <a rel=
"DEFINITION" href="26_glo_f.htm#form"><i>form</i></a> are
immediately returned by the <a rel="DEFINITION" href=
"m_loop.htm#loop"><b>loop</b></a> form. It is equivalent to the
clause <tt>do (return-from</tt> <i>block-name</i>
<i>value</i><tt>)</tt>, where <i>block-name</i> is the name
specified in a <tt>named</tt> clause, or <a rel="DEFINITION" href=
"a_nil.htm#nil"><b>nil</b></a> if there is no <tt>named</tt>
clause.</p>
<p>For more information, see <a rel="CHILD" href=
"06_ae.htm">Section 6.1.5 (Unconditional Execution
Clauses)</a>.</p>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>6.1.1.5.5 Summary of Conditional Execution Clauses</h2>
<p>The <tt>if</tt> and <tt>when</tt> constructs take one <a rel=
"DEFINITION" href="26_glo_f.htm#form"><i>form</i></a> as a test and
a clause that is executed when the test <a rel="DEFINITION" href=
"26_glo_y.htm#yield"><i>yields</i></a> <a rel="DEFINITION" href=
"26_glo_t.htm#true"><i>true</i></a>. The clause can be a value
accumulation, unconditional, or another conditional clause; it can
also be any combination of such clauses connected by the <a rel=
"DEFINITION" href="m_loop.htm#loop"><b>loop</b></a> <tt>and</tt>
keyword.</p>
<p>The <a rel="DEFINITION" href="m_loop.htm#loop"><b>loop</b></a>
<tt>unless</tt> construct is similar to the <a rel="DEFINITION"
href="m_loop.htm#loop"><b>loop</b></a> <tt>when</tt> construct
except that it complements the test result.</p>
<p>The <a rel="DEFINITION" href="m_loop.htm#loop"><b>loop</b></a>
<tt>else</tt> construct provides an optional component of
<tt>if</tt>, <tt>when</tt>, and <tt>unless</tt> clauses that is
executed when an <tt>if</tt> or <tt>when</tt> test <a rel=
"DEFINITION" href="26_glo_y.htm#yield"><i>yields</i></a> <a rel=
"DEFINITION" href="26_glo_f.htm#false"><i>false</i></a> or when an
<tt>unless</tt> test <a rel="DEFINITION" href=
"26_glo_y.htm#yield"><i>yields</i></a> <a rel="DEFINITION" href=
"26_glo_t.htm#true"><i>true</i></a>. The component is one of the
clauses described under <tt>if</tt>.</p>
<p>The <a rel="DEFINITION" href="m_loop.htm#loop"><b>loop</b></a>
<tt>end</tt> construct provides an optional component to mark the
end of a conditional clause.</p>
<p>For more information, see <a rel="CHILD" href=
"06_af.htm">Section 6.1.6 (Conditional Execution Clauses)</a>.</p>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>6.1.1.5.6 Summary of Miscellaneous Clauses</h2>
<p>The <a rel="DEFINITION" href="m_loop.htm#loop"><b>loop</b></a>
<tt>named</tt> construct gives a name for the <a rel="DEFINITION"
href="26_glo_b.htm#block"><i>block</i></a> of the loop.</p>
<p>The <a rel="DEFINITION" href="m_loop.htm#loop"><b>loop</b></a>
<tt>initially</tt> construct causes its <a rel="DEFINITION" href=
"26_glo_f.htm#form"><i>forms</i></a> to be evaluated in the loop
prologue, which precedes all <a rel="DEFINITION" href=
"m_loop.htm#loop"><b>loop</b></a> code except for initial settings
supplied by the constructs <tt>with</tt>, <tt>for</tt>, or
<tt>as</tt>.</p>
<p>The <a rel="DEFINITION" href="m_loop.htm#loop"><b>loop</b></a>
<tt>finally</tt> construct causes its <a rel="DEFINITION" href=
"26_glo_f.htm#form"><i>forms</i></a> to be evaluated in the loop
epilogue after normal iteration terminates.</p>
<p>For more information, see <a rel="CHILD" href=
"06_ag.htm">Section 6.1.7 (Miscellaneous Clauses)</a>.</p>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>6.1.1.6 Order of Execution</h2>
<p>With the exceptions listed below, clauses are executed in the
loop body in the order in which they appear in the source.
Execution is repeated until a clause terminates the <a rel=
"DEFINITION" href="m_loop.htm#loop"><b>loop</b></a> or until a
<a rel="DEFINITION" href="m_return.htm#return"><b>return</b></a>,
<a rel="DEFINITION" href="s_go.htm#go"><b>go</b></a>, or <a rel=
"DEFINITION" href="s_throw.htm#throw"><b>throw</b></a> form is
encountered which transfers control to a point outside of the loop.
The following actions are exceptions to the linear order of
execution:</p>
<dl>
<dt>* All variables are initialized first, regardless of where the
establishing clauses appear in the source. The order of
initialization follows the order of these clauses.<br></dt>
<dt>* The code for any <tt>initially</tt> clauses is collected into
one <a rel="DEFINITION" href="s_progn.htm#progn"><b>progn</b></a>
in the order in which the clauses appear in the source. The
collected code is executed once in the loop prologue after any
implicit variable initializations.<br></dt>
<dt>* The code for any <tt>finally</tt> clauses is collected into
one <a rel="DEFINITION" href="s_progn.htm#progn"><b>progn</b></a>
in the order in which the clauses appear in the source. The
collected code is executed once in the loop epilogue before any
implicit values from the accumulation clauses are returned.
Explicit returns anywhere in the source, however, will exit the
<a rel="DEFINITION" href="m_loop.htm#loop"><b>loop</b></a> without
executing the epilogue code.<br></dt>
<dt>* A <tt>with</tt> clause introduces a variable <a rel=
"DEFINITION" href="26_glo_b.htm#binding"><i>binding</i></a> and an
optional initial value. The initial values are calculated in the
order in which the <tt>with</tt> clauses occur.<br></dt>
<dt>* Iteration control clauses implicitly perform the following
actions:<br></dt>
<dd>
<dl>
<dt>-- initialize variables;<br></dt>
<dt>-- <a rel="DEFINITION" href="26_glo_s.htm#step"><i>step</i></a>
variables, generally between each execution of the loop
body;<br></dt>
<dt>-- perform termination tests, generally just before the
execution of the loop body.<br></dt>
</dl>
</dd>
</dl>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>6.1.1.7 Destructuring</h2>
<p>The <i>d-type-spec</i> argument is used for destructuring. If
the <i>d-type-spec</i> argument consists solely of the <a rel=
"DEFINITION" href="26_glo_t.htm#type"><i>type</i></a> <a rel=
"DEFINITION" href="t_fixnum.htm#fixnum"><b>fixnum</b></a>, <a rel=
"DEFINITION" href="t_float.htm#float"><b>float</b></a>, <a rel=
"DEFINITION" href="t_t.htm#t"><b>t</b></a>, or <a rel="DEFINITION"
href="a_nil.htm#nil"><b>nil</b></a>, the <tt>of-type</tt> keyword
is optional. The <tt>of-type</tt> construct is optional in these
cases to provide backwards compatibility; thus, the following two
expressions are the same:</p>
<pre>
;;; This expression uses the old syntax for type specifiers.
 (loop for i fixnum upfrom 3 ...)
 
;;; This expression uses the new syntax for type specifiers.
 (loop for i of-type fixnum upfrom 3 ...)

;; Declare X and Y to be of type VECTOR and FIXNUM respectively.
 (loop for (x y) of-type (vector fixnum) 
       in l do ...)
</pre>
<p>A <a rel="DEFINITION" href="26_glo_t.htm#type_specifier"><i>type
specifier</i></a> for a destructuring pattern is a <a rel=
"DEFINITION" href="26_glo_t.htm#tree"><i>tree</i></a> of <a rel=
"DEFINITION" href="26_glo_t.htm#type_specifier"><i>type
specifiers</i></a> with the same shape as the <a rel="DEFINITION"
href="26_glo_t.htm#tree"><i>tree</i></a> of <a rel="DEFINITION"
href="26_glo_v.htm#variable"><i>variable</i></a> <a rel=
"DEFINITION" href="26_glo_n.htm#name"><i>names</i></a>, with the
following exceptions:</p>
<dl>
<dt>* When aligning the <a rel="DEFINITION" href=
"26_glo_t.htm#tree"><i>trees</i></a>, an <a rel="DEFINITION" href=
"26_glo_a.htm#atom"><i>atom</i></a> in the <a rel="DEFINITION"
href="26_glo_t.htm#tree"><i>tree</i></a> of <a rel="DEFINITION"
href="26_glo_t.htm#type_specifier"><i>type specifiers</i></a> that
matches a <a rel="DEFINITION" href=
"26_glo_c.htm#cons"><i>cons</i></a> in the variable tree declares
the same <a rel="DEFINITION" href=
"26_glo_t.htm#type"><i>type</i></a> for each variable in the
subtree rooted at the <a rel="DEFINITION" href=
"26_glo_c.htm#cons"><i>cons</i></a>.<br></dt>
<dt>* A <a rel="DEFINITION" href=
"26_glo_c.htm#cons"><i>cons</i></a> in the <a rel="DEFINITION"
href="26_glo_t.htm#tree"><i>tree</i></a> of <a rel="DEFINITION"
href="26_glo_t.htm#type_specifier"><i>type specifiers</i></a> that
matches an <a rel="DEFINITION" href=
"26_glo_a.htm#atom"><i>atom</i></a> in the <a rel="DEFINITION"
href="26_glo_t.htm#tree"><i>tree</i></a> of <a rel="DEFINITION"
href="26_glo_v.htm#variable"><i>variable</i></a> <a rel=
"DEFINITION" href="26_glo_n.htm#name"><i>names</i></a> is a
<i>compound type specifer</i>.<br></dt>
</dl>
<p>Destructuring allows <a rel="DEFINITION" href=
"26_glo_b.htm#binding"><i>binding</i></a> of a set of variables to
a corresponding set of values anywhere that a value can normally be
bound to a single variable. During <a rel="DEFINITION" href=
"m_loop.htm#loop"><b>loop</b></a> expansion, each variable in the
variable list is matched with the values in the values list. If
there are more variables in the variable list than there are values
in the values list, the remaining variables are given a value of
<a rel="DEFINITION" href="a_nil.htm#nil"><b>nil</b></a>. If there
are more values than variables listed, the extra values are
discarded.</p>
<p>To assign values from a list to the variables <tt>a</tt>,
<tt>b</tt>, and <tt>c</tt>, the <tt>for</tt> clause could be used
to bind the variable <tt>numlist</tt> to the <a rel="DEFINITION"
href="26_glo_c.htm#car"><i>car</i></a> of the supplied <i>form</i>,
and then another <tt>for</tt> clause could be used to bind the
variables <tt>a</tt>, <tt>b</tt>, and <tt>c</tt> <a rel=
"DEFINITION" href=
"26_glo_s.htm#sequentially"><i>sequentially</i></a>.</p>
<pre>
;; Collect values by using FOR constructs.
 (loop for numlist in '((1 2 4.0) (5 6 8.3) (8 9 10.4))
       for a of-type integer = (first numlist)
       and b of-type integer = (second numlist)
       and c of-type float = (third numlist)
       collect (list c b a))
=&gt;  ((4.0 2 1) (8.3 6 5) (10.4 9 8))
</pre>
<p>Destructuring makes this process easier by allowing the
variables to be bound in each loop iteration. <a rel="DEFINITION"
href="26_glo_t.htm#type"><i>Types</i></a> can be declared by using
a list of <i>type-spec</i> arguments. If all the <a rel=
"DEFINITION" href="26_glo_t.htm#type"><i>types</i></a> are the
same, a shorthand destructuring syntax can be used, as the second
example illustrates.</p>
<pre>
;; Destructuring simplifies the process.
 (loop for (a b c) of-type (integer integer float) in
       '((1 2 4.0) (5 6 8.3) (8 9 10.4))
       collect (list c b a))
=&gt;  ((4.0 2 1) (8.3 6 5) (10.4 9 8))
 

;; If all the types are the same, this way is even simpler.
 (loop for (a b c) of-type float in
       '((1.0 2.0 4.0) (5.0 6.0 8.3) (8.0 9.0 10.4))
       collect (list c b a))
=&gt;  ((4.0 2.0 1.0) (8.3 6.0 5.0) (10.4 9.0 8.0))
</pre>
<p>If destructuring is used to declare or initialize a number of
groups of variables into <a rel="DEFINITION" href=
"26_glo_t.htm#type"><i>types</i></a>, the <a rel="DEFINITION" href=
"26_glo_l.htm#loop_keyword"><i>loop keyword</i></a> <tt>and</tt>
can be used to simplify the process further.</p>
<pre>
;; Initialize and declare variables in parallel by using the AND construct.
 (loop with (a b) of-type float = '(1.0 2.0)
       and (c d) of-type integer = '(3 4)
       and (e f)
       return (list a b c d e f))
=&gt;  (1.0 2.0 3 4 NIL NIL)
</pre>
<p>If <a rel="DEFINITION" href="a_nil.htm#nil"><b>nil</b></a> is
used in a destructuring list, no variable is provided for its
place.</p>
<pre>
 (loop for (a nil b) = '(1 2 3)
       do (return (list a b)))
=&gt;  (1 3)
</pre>
<p>Note that <a rel="DEFINITION" href=
"26_glo_d.htm#dotted_list"><i>dotted lists</i></a> can specify
destructuring.</p>
<pre>
 (loop for (x . y) = '(1 . 2)
       do (return y))
=&gt;  2
 (loop for ((a . b) (c . d)) of-type ((float . float) (integer . integer)) in
       '(((1.2 . 2.4) (3 . 4)) ((3.4 . 4.6) (5 . 6)))
       collect (list a b c d))
=&gt;  ((1.2 2.4 3 4) (3.4 4.6 5 6))
</pre>
<p>An error of <a rel="DEFINITION" href=
"26_glo_t.htm#type"><i>type</i></a> <a rel="DEFINITION" href=
"e_progra.htm#program-error"><b>program-error</b></a> is signaled
(at macro expansion time) if the same variable is bound twice in
any variable-binding clause of a single <a rel="DEFINITION" href=
"m_loop.htm#loop"><b>loop</b></a> expression. Such variables
include local variables, iteration control variables, and variables
found by destructuring.</p>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>6.1.1.8 Restrictions on Side-Effects</h2>
<p>See <a rel="CHILD" href="03_f.htm">Section 3.6 (Traversal Rules
and Side Effects)</a>.</p>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>6.1.2 Variable Initialization and Stepping Clauses</h2>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>6.1.2.1 Iteration Control</h2>
<p>Iteration control clauses allow direction of <a rel="DEFINITION"
href="m_loop.htm#loop"><b>loop</b></a> iteration. The <a rel=
"DEFINITION" href="26_glo_l.htm#loop_keyword"><i>loop
keywords</i></a> <tt>for</tt> and <tt>as</tt> designate iteration
control clauses. Iteration control clauses differ with respect to
the specification of termination tests and to the initialization
and <i>stepping</i>[1] of loop variables. Iteration clauses by
themselves do not cause the Loop Facility to return values, but
they can be used in conjunction with value-accumulation clauses to
return values.</p>
<p>All variables are initialized in the loop prologue. A <a rel=
"DEFINITION" href="26_glo_v.htm#variable"><i>variable</i></a>
<a rel="DEFINITION" href="26_glo_b.htm#binding"><i>binding</i></a>
has <a rel="DEFINITION" href=
"26_glo_l.htm#lexical_scope"><i>lexical scope</i></a> unless it is
proclaimed <a rel="DEFINITION" href=
"d_specia.htm#special"><b>special</b></a>; thus, by default, the
variable can be <i>accessed</i> only by <a rel="DEFINITION" href=
"26_glo_f.htm#form"><i>forms</i></a> that lie textually within the
<a rel="DEFINITION" href="m_loop.htm#loop"><b>loop</b></a>.
Stepping assignments are made in the loop body before any other
<a rel="DEFINITION" href="26_glo_f.htm#form"><i>forms</i></a> are
evaluated in the body.</p>
<p>The variable argument in iteration control clauses can be a
destructuring list. A destructuring list is a <a rel="DEFINITION"
href="26_glo_t.htm#tree"><i>tree</i></a> whose <a rel="DEFINITION"
href="26_glo_n.htm#non-nil"><i>non-nil</i></a> <a rel="DEFINITION"
href="26_glo_a.htm#atom"><i>atoms</i></a> are <a rel="DEFINITION"
href="26_glo_v.htm#variable"><i>variable</i></a> <a rel=
"DEFINITION" href="26_glo_n.htm#name"><i>names</i></a>. See <a rel=
"CHILD" href="06_aag.htm">Section 6.1.1.7 (Destructuring)</a>.</p>
<p>The iteration control clauses <tt>for</tt>, <tt>as</tt>, and
<tt>repeat</tt> must precede any other loop clauses, except
<tt>initially</tt>, <tt>with</tt>, and <tt>named</tt>, since they
establish variable <a rel="DEFINITION" href=
"26_glo_b.htm#binding"><i>bindings</i></a>. When iteration control
clauses are used in a <a rel="DEFINITION" href=
"m_loop.htm#loop"><b>loop</b></a>, the corresponding termination
tests in the loop body are evaluated before any other loop body
code is executed.</p>
<p>If multiple iteration clauses are used to control iteration,
variable initialization and <i>stepping</i>[1] occur <a rel=
"DEFINITION" href=
"26_glo_s.htm#sequentially"><i>sequentially</i></a> by default. The
<tt>and</tt> construct can be used to connect two or more iteration
clauses when <a rel="DEFINITION" href=
"26_glo_s.htm#sequential"><i>sequential</i></a> <a rel="DEFINITION"
href="26_glo_b.htm#binding"><i>binding</i></a> and
<i>stepping</i>[1] are not necessary. The iteration behavior of
clauses joined by <tt>and</tt> is analogous to the behavior of the
macro <a rel="DEFINITION" href="m_do_do.htm#do"><b>do</b></a> with
respect to <a rel="DEFINITION" href=
"m_do_do.htm#doST"><b>do*</b></a>.</p>
<p>The <tt>for</tt> and <tt>as</tt> clauses iterate by using one or
more local loop variables that are initialized to some value and
that can be modified or <i>stepped</i>[1] after each iteration. For
these clauses, iteration terminates when a local variable reaches
some supplied value or when some other loop clause terminates
iteration. At each iteration, variables can be <i>stepped</i>[1] by
an increment or a decrement or can be assigned a new value by the
evaluation of a <a rel="DEFINITION" href=
"26_glo_f.htm#form"><i>form</i></a>). Destructuring can be used to
assign values to variables during iteration.</p>
<p>The <tt>for</tt> and <tt>as</tt> keywords are synonyms; they can
be used interchangeably. There are seven syntactic formats for
these constructs. In each syntactic format, the <a rel="DEFINITION"
href="26_glo_t.htm#type"><i>type</i></a> of <i>var</i> can be
supplied by the optional <i>type-spec</i> argument. If <i>var</i>
is a destructuring list, the <a rel="DEFINITION" href=
"26_glo_t.htm#type"><i>type</i></a> supplied by the
<i>type-spec</i> argument must appropriately match the elements of
the list. By convention, <tt>for</tt> introduces new iterations and
<tt>as</tt> introduces iterations that depend on a previous
iteration specification.</p>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>6.1.2.1.1 The for-as-arithmetic subclause</h2>
<p>In the <i>for-as-arithmetic</i> subclause, the <tt>for</tt> or
<tt>as</tt> construct iterates from the value supplied by
<i>form1</i> to the value supplied by <i>form2</i> in increments or
decrements denoted by <i>form3</i>. Each expression is evaluated
only once and must evaluate to a <a rel="DEFINITION" href=
"26_glo_n.htm#number"><i>number</i></a>. The variable <i>var</i> is
bound to the value of <i>form1</i> in the first iteration and is
<i>stepped</i>[1] by the value of <i>form3</i> in each succeeding
iteration, or by 1 if <i>form3</i> is not provided. The following
<a rel="DEFINITION" href="26_glo_l.htm#loop_keyword"><i>loop
keywords</i></a> serve as valid prepositions within this syntax. At
least one of the prepositions must be used; and at most one from
each line may be used in a single subclause.</p>
<dl>
<dt><tt>from</tt> | <tt>downfrom</tt> | <tt>upfrom</tt><br></dt>
<dt><tt>to</tt> | <tt>downto</tt> | <tt>upto</tt> | <tt>below</tt>
| <tt>above</tt><br></dt>
<dt><tt>by</tt><br></dt>
</dl>
<p>The prepositional phrases in each subclause may appear in any
order. For example, either "<tt>from x by y</tt>" or "<tt>by y from
x</tt>" is permitted. However, because left-to-right order of
evaluation is preserved, the effects will be different in the case
of side effects. Consider:</p>
<pre>
(let ((x 1)) (loop for i from x by (incf x) to 10 collect i))
=&gt;  (1 3 5 7 9)
(let ((x 1)) (loop for i by (incf x) from x to 10 collect i))
=&gt;  (2 4 6 8 10)
</pre>
<p>The descriptions of the prepositions follow:</p>
<dl>
<dt><tt>from</tt><br></dt>
<dd>The <a rel="DEFINITION" href=
"26_glo_l.htm#loop_keyword"><i>loop keyword</i></a> <tt>from</tt>
specifies the value from which <i>stepping</i>[1] begins, as
supplied by <i>form1</i>. <i>Stepping</i>[1] is incremental by
default. If decremental <i>stepping</i>[1] is desired, the
preposition <tt>downto</tt> or <tt>above</tt> must be used with
<i>form2</i>. For incremental <i>stepping</i>[1], the default
<tt>from</tt> value is 0.</dd>
<dt><tt>downfrom, upfrom</tt><br></dt>
<dd>The <a rel="DEFINITION" href=
"26_glo_l.htm#loop_keyword"><i>loop keyword</i></a>
<tt>downfrom</tt> indicates that the variable <i>var</i> is
decreased in decrements supplied by <i>form3</i>; the <a rel=
"DEFINITION" href="26_glo_l.htm#loop_keyword"><i>loop
keyword</i></a> <tt>upfrom</tt> indicates that <i>var</i> is
increased in increments supplied by <i>form3</i>.</dd>
<dt><tt>to</tt><br></dt>
<dd>The <a rel="DEFINITION" href=
"26_glo_l.htm#loop_keyword"><i>loop keyword</i></a> <tt>to</tt>
marks the end value for <i>stepping</i>[1] supplied in
<i>form2</i>. <i>Stepping</i>[1] is incremental by default. If
decremental <i>stepping</i>[1] is desired, the preposition
<tt>downfrom</tt> must be used with <i>form1</i>, or else the
preposition <tt>downto</tt> or <tt>above</tt> should be used
instead of <tt>to</tt> with <i>form2</i>.</dd>
<dt><tt>downto, upto</tt><br></dt>
<dd>The <a rel="DEFINITION" href=
"26_glo_l.htm#loop_keyword"><i>loop keyword</i></a> <tt>downto</tt>
specifies decremental <i>stepping</i>; the <a rel="DEFINITION"
href="26_glo_l.htm#loop_keyword"><i>loop keyword</i></a>
<tt>upto</tt> specifies incremental <i>stepping</i>. In both cases,
the amount of change on each step is specified by <i>form3</i>, and
the <a rel="DEFINITION" href="m_loop.htm#loop"><b>loop</b></a>
terminates when the variable <i>var</i> passes the value of
<i>form2</i>. Since there is no default for <i>form1</i> in
decremental <i>stepping</i>[1], a <i>form1</i> value must be
supplied (using <tt>from</tt> or <tt>downfrom</tt>) when
<tt>downto</tt> is supplied.</dd>
<dt><tt>below, above</tt><br></dt>
<dd>The <a rel="DEFINITION" href=
"26_glo_l.htm#loop_keyword"><i>loop keywords</i></a> <tt>below</tt>
and <tt>above</tt> are analogous to <tt>upto</tt> and
<tt>downto</tt> respectively. These keywords stop iteration just
before the value of the variable <i>var</i> reaches the value
supplied by <i>form2</i>; the end value of <i>form2</i> is not
included. Since there is no default for <i>form1</i> in decremental
<i>stepping</i>[1], a <i>form1</i> value must be supplied (using
<tt>from</tt> or <tt>downfrom</tt>) when <tt>above</tt> is
supplied.</dd>
<dt><tt>by</tt><br></dt>
<dd>The <a rel="DEFINITION" href=
"26_glo_l.htm#loop_keyword"><i>loop keyword</i></a> <tt>by</tt>
marks the increment or decrement supplied by <i>form3</i>. The
value of <i>form3</i> can be any positive <a rel="DEFINITION" href=
"26_glo_n.htm#number"><i>number</i></a>. The default value is
1.</dd>
</dl>
<p>In an iteration control clause, the <tt>for</tt> or <tt>as</tt>
construct causes termination when the supplied limit is reached.
That is, iteration continues until the value <i>var</i> is stepped
to the exclusive or inclusive limit supplied by <i>form2</i>. The
range is exclusive if <i>form3</i> increases or decreases
<i>var</i> to the value of <i>form2</i> without reaching that
value; the loop keywords <tt>below</tt> and <tt>above</tt> provide
exclusive limits. An inclusive limit allows <i>var</i> to attain
the value of <i>form2</i>; <tt>to</tt>, <tt>downto</tt>, and
<tt>upto</tt> provide inclusive limits.</p>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>6.1.2.1.1.1 Examples of for-as-arithmetic subclause</h2>
<pre>
;; Print some numbers.
 (loop for i from 1 to 3
       do (print i))
&gt;&gt;  1
&gt;&gt;  2
&gt;&gt;  3
=&gt;  NIL
 
;; Print every third number.
 (loop for i from 10 downto 1 by 3
       do (print i))
&gt;&gt;  10 
&gt;&gt;  7 
&gt;&gt;  4 
&gt;&gt;  1 
=&gt;  NIL
 
;; Step incrementally from the default starting value.
 (loop for i below 3
       do (print i))
&gt;&gt;  0
&gt;&gt;  1
&gt;&gt;  2
=&gt;  NIL
</pre>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>6.1.2.1.2 The for-as-in-list subclause</h2>
<p>In the <i>for-as-in-list</i> subclause, the <tt>for</tt> or
<tt>as</tt> construct iterates over the contents of a <a rel=
"DEFINITION" href="26_glo_l.htm#list"><i>list</i></a>. It checks
for the end of the <a rel="DEFINITION" href=
"26_glo_l.htm#list"><i>list</i></a> as if by using <a rel=
"DEFINITION" href="f_endp.htm#endp"><b>endp</b></a>. The variable
<i>var</i> is bound to the successive elements of the <a rel=
"DEFINITION" href="26_glo_l.htm#list"><i>list</i></a> in
<i>form1</i> before each iteration. At the end of each iteration,
the function <i>step-fun</i> is applied to the <a rel="DEFINITION"
href="26_glo_l.htm#list"><i>list</i></a>; the default value for
<i>step-fun</i> is <a rel="DEFINITION" href=
"f_car_c.htm#cdr"><b>cdr</b></a>. The <a rel="DEFINITION" href=
"26_glo_l.htm#loop_keyword"><i>loop keywords</i></a> <tt>in</tt>
and <tt>by</tt> serve as valid prepositions in this syntax. The
<tt>for</tt> or <tt>as</tt> construct causes termination when the
end of the <a rel="DEFINITION" href=
"26_glo_l.htm#list"><i>list</i></a> is reached.</p>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>6.1.2.1.2.1 Examples of for-as-in-list subclause</h2>
<pre>
;; Print every item in a list.
 (loop for item in '(1 2 3) do (print item))
&gt;&gt;  1
&gt;&gt;  2
&gt;&gt;  3
=&gt;  NIL
 
;; Print every other item in a list.
 (loop for item in '(1 2 3 4 5) by #'cddr
       do (print item))
&gt;&gt;  1
&gt;&gt;  3
&gt;&gt;  5
=&gt;  NIL
 
;; Destructure a list, and sum the x values using fixnum arithmetic.
 (loop for (item . x) of-type (t . fixnum) in '((A . 1) (B . 2) (C . 3))
       unless (eq item 'B) sum x)
=&gt;  4
</pre>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>6.1.2.1.3 The for-as-on-list subclause</h2>
<p>In the <i>for-as-on-list</i> subclause, the <tt>for</tt> or
<tt>as</tt> construct iterates over a <a rel="DEFINITION" href=
"26_glo_l.htm#list"><i>list</i></a>. It checks for the end of the
<a rel="DEFINITION" href="26_glo_l.htm#list"><i>list</i></a> as if
by using <a rel="DEFINITION" href=
"f_atom.htm#atom"><b>atom</b></a>. The variable <i>var</i> is bound
to the successive tails of the <a rel="DEFINITION" href=
"26_glo_l.htm#list"><i>list</i></a> in <i>form1</i>. At the end of
each iteration, the function <i>step-fun</i> is applied to the
<a rel="DEFINITION" href="26_glo_l.htm#list"><i>list</i></a>; the
default value for <i>step-fun</i> is <a rel="DEFINITION" href=
"f_car_c.htm#cdr"><b>cdr</b></a>. The <a rel="DEFINITION" href=
"26_glo_l.htm#loop_keyword"><i>loop keywords</i></a> <tt>on</tt>
and <tt>by</tt> serve as valid prepositions in this syntax. The
<tt>for</tt> or <tt>as</tt> construct causes termination when the
end of the <a rel="DEFINITION" href=
"26_glo_l.htm#list"><i>list</i></a> is reached.</p>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>6.1.2.1.3.1 Examples of for-as-on-list subclause</h2>
<pre>
;; Collect successive tails of a list.
 (loop for sublist on '(a b c d)
       collect sublist)
=&gt;  ((A B C D) (B C D) (C D) (D))
 
;; Print a list by using destructuring with the loop keyword ON.
 (loop for (item) on '(1 2 3)
       do (print item))
&gt;&gt;  1 
&gt;&gt;  2 
&gt;&gt;  3 
=&gt;  NIL
 
</pre>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>6.1.2.1.4 The for-as-equals-then subclause</h2>
<p>In the <i>for-as-equals-then</i> subclause the <tt>for</tt> or
<tt>as</tt> construct initializes the variable <i>var</i> by
setting it to the result of evaluating <i>form1</i> on the first
iteration, then setting it to the result of evaluating <i>form2</i>
on the second and subsequent iterations. If <i>form2</i> is
omitted, the construct uses <i>form1</i> on the second and
subsequent iterations. The <a rel="DEFINITION" href=
"26_glo_l.htm#loop_keyword"><i>loop keywords</i></a> = and
<tt>then</tt> serve as valid prepositions in this syntax. This
construct does not provide any termination tests.</p>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>6.1.2.1.4.1 Examples of for-as-equals-then subclause</h2>
<pre>
;; Collect some numbers.
 (loop for item = 1 then (+ item 10)
       for iteration from 1 to 5
       collect item)
=&gt;  (1 11 21 31 41)
</pre>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>6.1.2.1.5 The for-as-across subclause</h2>
<p>In the <i>for-as-across</i> subclause the <tt>for</tt> or
<tt>as</tt> construct binds the variable <i>var</i> to the value of
each element in the array <i>vector</i>. The <a rel="DEFINITION"
href="26_glo_l.htm#loop_keyword"><i>loop keyword</i></a>
<tt>across</tt> marks the array <i>vector</i>; <tt>across</tt> is
used as a preposition in this syntax. Iteration stops when there
are no more elements in the supplied <a rel="DEFINITION" href=
"26_glo_a.htm#array"><i>array</i></a> that can be referenced. Some
implementations might recognize a <a rel="DEFINITION" href=
"s_the.htm#the"><b>the</b></a> special form in the <i>vector</i>
form to produce more efficient code.</p>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>6.1.2.1.5.1 Examples of for-as-across subclause</h2>
<pre>
 (loop for char across (the simple-string (find-message channel))
       do (write-char char stream))
</pre>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>6.1.2.1.6 The for-as-hash subclause</h2>
<p>In the <i>for-as-hash</i> subclause the <tt>for</tt> or
<tt>as</tt> construct iterates over the elements, keys, and values
of a <a rel="DEFINITION" href=
"t_hash_t.htm#hash-table"><i>hash-table</i></a>. In this syntax, a
compound preposition is used to designate access to a <a rel=
"DEFINITION" href="26_glo_h.htm#hash_table"><i>hash table</i></a>.
The variable <i>var</i> takes on the value of each hash key or hash
value in the supplied <i>hash-table</i>. The following <a rel=
"DEFINITION" href="26_glo_l.htm#loop_keyword"><i>loop
keywords</i></a> serve as valid prepositions within this
syntax:</p>
<dl>
<dt><tt>being</tt><br></dt>
<dd>The keyword <tt>being</tt> introduces either the Loop schema
<tt>hash-key</tt> or <tt>hash-value</tt>.</dd>
<dt><tt>each</tt>, <tt>the</tt><br></dt>
<dd>The <a rel="DEFINITION" href=
"26_glo_l.htm#loop_keyword"><i>loop keyword</i></a> <tt>each</tt>
follows the <a rel="DEFINITION" href=
"26_glo_l.htm#loop_keyword"><i>loop keyword</i></a> <tt>being</tt>
when <tt>hash-key</tt> or <tt>hash-value</tt> is used. The <a rel=
"DEFINITION" href="26_glo_l.htm#loop_keyword"><i>loop
keyword</i></a> <tt>the</tt> is used with <tt>hash-keys</tt> and
<tt>hash-values</tt> only for ease of reading. This agreement isn't
required.</dd>
<dt><tt>hash-key</tt>, <tt>hash-keys</tt><br></dt>
<dd>These <a rel="DEFINITION" href=
"26_glo_l.htm#loop_keyword"><i>loop keywords</i></a> access each
key entry of the <a rel="DEFINITION" href=
"26_glo_h.htm#hash_table"><i>hash table</i></a>. If the name
<tt>hash-value</tt> is supplied in a <tt>using</tt> construct with
one of these Loop schemas, the iteration can optionally access the
keyed value. The order in which the keys are accessed is undefined;
empty slots in the <a rel="DEFINITION" href=
"26_glo_h.htm#hash_table"><i>hash table</i></a> are ignored.</dd>
<dt><tt>hash-value</tt>, <tt>hash-values</tt><br></dt>
<dd>These <a rel="DEFINITION" href=
"26_glo_l.htm#loop_keyword"><i>loop keywords</i></a> access each
value entry of a <a rel="DEFINITION" href=
"26_glo_h.htm#hash_table"><i>hash table</i></a>. If the name
<tt>hash-key</tt> is supplied in a <tt>using</tt> construct with
one of these Loop schemas, the iteration can optionally access the
key that corresponds to the value. The order in which the keys are
accessed is undefined; empty slots in the <a rel="DEFINITION" href=
"26_glo_h.htm#hash_table"><i>hash table</i></a> are ignored.</dd>
<dt><tt>using</tt><br></dt>
<dd>The <a rel="DEFINITION" href=
"26_glo_l.htm#loop_keyword"><i>loop keyword</i></a> <tt>using</tt>
introduces the optional key or the keyed value to be accessed. It
allows access to the hash key if iteration is over the hash values,
and the hash value if iteration is over the hash keys.</dd>
<dt><tt>in</tt>, <tt>of</tt><br></dt>
<dd>These loop prepositions introduce <i>hash-table</i>.</dd>
</dl>
<p>In effect</p>
<p><tt>being</tt> {<tt>each</tt> | <tt>the</tt>}
{<tt>hash-value</tt> | <tt>hash-values</tt> | <tt>hash-key</tt> |
<tt>hash-keys</tt>} {<tt>in</tt> | <tt>of</tt>}</p>
<p>is a compound preposition.</p>
<p>Iteration stops when there are no more hash keys or hash values
to be referenced in the supplied <i>hash-table</i>.</p>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>6.1.2.1.7 The for-as-package subclause</h2>
<p>In the <i>for-as-package</i> subclause the <tt>for</tt> or
<tt>as</tt> construct iterates over the <a rel="DEFINITION" href=
"26_glo_s.htm#symbol"><i>symbols</i></a> in a <a rel="DEFINITION"
href="26_glo_p.htm#package"><i>package</i></a>. In this syntax, a
compound preposition is used to designate access to a <a rel=
"DEFINITION" href="26_glo_p.htm#package"><i>package</i></a>. The
variable <i>var</i> takes on the value of each <a rel="DEFINITION"
href="26_glo_s.htm#symbol"><i>symbol</i></a> in the supplied
<a rel="DEFINITION" href="26_glo_p.htm#package"><i>package</i></a>.
The following <a rel="DEFINITION" href=
"26_glo_l.htm#loop_keyword"><i>loop keywords</i></a> serve as valid
prepositions within this syntax:</p>
<dl>
<dt><tt>being</tt><br></dt>
<dd>The keyword <tt>being</tt> introduces either the Loop schema
<tt>symbol</tt>, <tt>present-symbol</tt>, or
<tt>external-symbol</tt>.</dd>
<dt><tt>each</tt>, <tt>the</tt><br></dt>
<dd>The <a rel="DEFINITION" href=
"26_glo_l.htm#loop_keyword"><i>loop keyword</i></a> <tt>each</tt>
follows the <a rel="DEFINITION" href=
"26_glo_l.htm#loop_keyword"><i>loop keyword</i></a> <tt>being</tt>
when <tt>symbol</tt>, <tt>present-symbol</tt>, or
<tt>external-symbol</tt> is used. The <a rel="DEFINITION" href=
"26_glo_l.htm#loop_keyword"><i>loop keyword</i></a> <tt>the</tt> is
used with <tt>symbols</tt>, <tt>present-symbols</tt>, and
<tt>external-symbols</tt> only for ease of reading. This agreement
isn't required.</dd>
<dt><tt>present-symbol</tt>, <tt>present-symbols</tt><br></dt>
<dd>These Loop schemas iterate over the <a rel="DEFINITION" href=
"26_glo_s.htm#symbol"><i>symbols</i></a> that are <a rel=
"DEFINITION" href="26_glo_p.htm#present"><i>present</i></a> in a
<a rel="DEFINITION" href="26_glo_p.htm#package"><i>package</i></a>.
The <i>package</i> to be iterated over is supplied in the same way
that <a rel="DEFINITION" href=
"26_glo_p.htm#package"><i>package</i></a> arguments to <a rel=
"DEFINITION" href=
"f_find_p.htm#find-package"><b>find-package</b></a> are supplied.
If the <i>package</i> for the iteration is not supplied, the
<a rel="DEFINITION" href="26_glo_c.htm#current_package"><i>current
package</i></a> is used. If a <i>package</i> that does not exist is
supplied, an error of <a rel="DEFINITION" href=
"26_glo_t.htm#type"><i>type</i></a> <a rel="DEFINITION" href=
"e_pkg_er.htm#package-error"><b>package-error</b></a> is
signaled.</dd>
<dt><tt>symbol</tt>, <tt>symbols</tt><br></dt>
<dd>These Loop schemas iterate over <a rel="DEFINITION" href=
"26_glo_s.htm#symbol"><i>symbols</i></a> that are <a rel=
"DEFINITION" href="26_glo_a.htm#accessible"><i>accessible</i></a>
in a given <i>package</i>. The <i>package</i> to be iterated over
is supplied in the same way that <a rel="DEFINITION" href=
"26_glo_p.htm#package"><i>package</i></a> arguments to <a rel=
"DEFINITION" href=
"f_find_p.htm#find-package"><b>find-package</b></a> are supplied.
If the <i>package</i> for the iteration is not supplied, the
<a rel="DEFINITION" href="26_glo_c.htm#current_package"><i>current
package</i></a> is used. If a <i>package</i> that does not exist is
supplied, an error of <a rel="DEFINITION" href=
"26_glo_t.htm#type"><i>type</i></a> <a rel="DEFINITION" href=
"e_pkg_er.htm#package-error"><b>package-error</b></a> is
signaled.</dd>
<dt><tt>external-symbol</tt>, <tt>external-symbols</tt><br></dt>
<dd>These Loop schemas iterate over the <a rel="DEFINITION" href=
"26_glo_e.htm#external_symbol"><i>external symbols</i></a> of a
<i>package</i>. The <i>package</i> to be iterated over is supplied
in the same way that <a rel="DEFINITION" href=
"26_glo_p.htm#package"><i>package</i></a> arguments to <a rel=
"DEFINITION" href=
"f_find_p.htm#find-package"><b>find-package</b></a> are supplied.
If the <i>package</i> for the iteration is not supplied, the
<a rel="DEFINITION" href="26_glo_c.htm#current_package"><i>current
package</i></a> is used. If a <i>package</i> that does not exist is
supplied, an error of <a rel="DEFINITION" href=
"26_glo_t.htm#type"><i>type</i></a> <a rel="DEFINITION" href=
"e_pkg_er.htm#package-error"><b>package-error</b></a> is
signaled.</dd>
<dt><tt>in</tt>, <tt>of</tt><br></dt>
<dd>These loop prepositions introduce <i>package</i>.</dd>
</dl>
<p>In effect</p>
<p><tt>being</tt> {<tt>each</tt> | <tt>the</tt>} {<tt>symbol</tt> |
<tt>symbols</tt> | <tt>present-symbol</tt> |
<tt>present-symbols</tt> | <tt>external-symbol</tt> |
<tt>external-symbols</tt>} {<tt>in</tt> | <tt>of</tt>}</p>
<p>is a compound preposition.</p>
<p>Iteration stops when there are no more <a rel="DEFINITION" href=
"26_glo_s.htm#symbol"><i>symbols</i></a> to be referenced in the
supplied <i>package</i>.</p>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>6.1.2.1.7.1 Examples of for-as-package subclause</h2>
<pre>
 (let ((*package* (make-package "TEST-PACKAGE-1")))
   ;; For effect, intern some symbols
   (read-from-string "(THIS IS A TEST)")
   (export (intern "THIS"))
   (loop for x being each present-symbol of *package*
          do (print x)))
&gt;&gt;  A 
&gt;&gt;  TEST 
&gt;&gt;  THIS
&gt;&gt;  IS 
=&gt;  NIL
</pre>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>6.1.2.2 Local Variable Initializations</h2>
<p>When a <a rel="DEFINITION" href=
"m_loop.htm#loop"><b>loop</b></a> <a rel="DEFINITION" href=
"26_glo_f.htm#form"><i>form</i></a> is executed, the local
variables are bound and are initialized to some value. These local
variables exist until <a rel="DEFINITION" href=
"m_loop.htm#loop"><b>loop</b></a> iteration terminates, at which
point they cease to exist. Implicit variables are also established
by iteration control clauses and the <tt>into</tt> preposition of
accumulation clauses.</p>
<p>The <tt>with</tt> construct initializes variables that are local
to a loop. The variables are initialized one time only. If the
optional <i>type-spec</i> argument is supplied for the variable
<i>var</i>, but there is no related expression to be evaluated,
<i>var</i> is initialized to an appropriate default value for its
<a rel="DEFINITION" href="26_glo_t.htm#type"><i>type</i></a>. For
example, for the types <a rel="DEFINITION" href=
"t_t.htm#t"><b>t</b></a>, <a rel="DEFINITION" href=
"t_number.htm#number"><b>number</b></a>, and <a rel="DEFINITION"
href="t_float.htm#float"><b>float</b></a>, the default values are
<a rel="DEFINITION" href="a_nil.htm#nil"><b>nil</b></a>,
<tt>0</tt>, and <tt>0.0</tt> respectively. The consequences are
undefined if a <i>type-spec</i> argument is supplied for <i>var</i>
if the related expression returns a value that is not of the
supplied <a rel="DEFINITION" href=
"26_glo_t.htm#type"><i>type</i></a>. By default, the <tt>with</tt>
construct initializes variables <a rel="DEFINITION" href=
"26_glo_s.htm#sequentially"><i>sequentially</i></a>; that is, one
variable is assigned a value before the next expression is
evaluated. However, by using the <a rel="DEFINITION" href=
"26_glo_l.htm#loop_keyword"><i>loop keyword</i></a> <tt>and</tt> to
join several <tt>with</tt> clauses, initializations can be forced
to occur in <a rel="DEFINITION" href=
"26_glo_p.htm#parallel"><i>parallel</i></a>; that is, all of the
supplied <i>forms</i> are evaluated, and the results are bound to
the respective variables simultaneously.</p>
<p><a rel="DEFINITION" href=
"26_glo_s.htm#sequential"><i>Sequential</i></a> <a rel="DEFINITION"
href="26_glo_b.htm#binding"><i>binding</i></a> is used when it is
desireable for the initialization of some variables to depend on
the values of previously bound variables. For example, suppose the
variables <tt>a</tt>, <tt>b</tt>, and <tt>c</tt> are to be bound in
sequence:</p>
<pre>
 (loop with a = 1 
       with b = (+ a 2) 
       with c = (+ b 3)
       return (list a b c))
=&gt;  (1 3 6)
</pre>
<p>The execution of the above <a rel="DEFINITION" href=
"m_loop.htm#loop"><b>loop</b></a> is equivalent to the execution of
the following code:</p>
<pre>
 (block nil
   (let* ((a 1)
          (b (+ a 2))
          (c (+ b 3)))
     (tagbody
         (next-loop (return (list a b c))
                    (go next-loop)
                    end-loop))))
</pre>
<p>If the values of previously bound variables are not needed for
the initialization of other local variables, an <tt>and</tt> clause
can be used to specify that the bindings are to occur in <a rel=
"DEFINITION" href="26_glo_p.htm#parallel"><i>parallel</i></a>:</p>
<pre>
 (loop with a = 1 
       and b = 2 
       and c = 3
       return (list a b c))
=&gt;  (1 2 3)
</pre>
<p>The execution of the above loop is equivalent to the execution
of the following code:</p>
<pre>
 (block nil
   (let ((a 1)
         (b 2)
         (c 3))
     (tagbody
         (next-loop (return (list a b c))
                    (go next-loop)
                    end-loop))))
</pre>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>6.1.2.2.1 Examples of WITH clause</h2>
<pre>
;; These bindings occur in sequence.
 (loop with a = 1 
       with b = (+ a 2) 
       with c = (+ b 3)
       return (list a b c))
=&gt;  (1 3 6)
 
;; These bindings occur in parallel.
 (setq a 5 b 10)
=&gt;  10
 (loop with a = 1
       and b = (+ a 2)
       and c = (+ b 3)
       return (list a b c))
=&gt;  (1 7 13)
 
;; This example shows a shorthand way to declare local variables 
;; that are of different types.
 (loop with (a b c) of-type (float integer float)
       return (format nil "~A ~A ~A" a b c))
=&gt;  "0.0 0 0.0"
 
;; This example shows a shorthand way to declare local variables 
;; that are the same type.
 (loop with (a b c) of-type float 
       return (format nil "~A ~A ~A" a b c))
=&gt;  "0.0 0.0 0.0"
</pre>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>6.1.3 Value Accumulation Clauses</h2>
<p>The constructs <tt>collect</tt>, <tt>collecting</tt>,
<tt>append</tt>, <tt>appending</tt>, <tt>nconc</tt>,
<tt>nconcing</tt>, <tt>count</tt>, <tt>counting</tt>,
<tt>maximize</tt>, <tt>maximizing</tt>, <tt>minimize</tt>,
<tt>minimizing</tt>, <tt>sum</tt>, and <tt>summing</tt>, allow
values to be accumulated in a <a rel="DEFINITION" href=
"m_loop.htm#loop"><b>loop</b></a>.</p>
<p>The constructs <tt>collect</tt>, <tt>collecting</tt>,
<tt>append</tt>, <tt>appending</tt>, <tt>nconc</tt>, and
<tt>nconcing</tt>, designate clauses that accumulate values in
<a rel="DEFINITION" href="26_glo_l.htm#list"><i>lists</i></a> and
return them. The constructs <tt>count</tt>, <tt>counting</tt>,
<tt>maximize</tt>, <tt>maximizing</tt>, <tt>minimize</tt>,
<tt>minimizing</tt>, <tt>sum</tt>, and <tt>summing</tt> designate
clauses that accumulate and return numerical values.</p>
<p>During each iteration, the constructs <tt>collect</tt> and
<tt>collecting</tt> collect the value of the supplied <i>form</i>
into a <a rel="DEFINITION" href=
"26_glo_l.htm#list"><i>list</i></a>. When iteration terminates, the
<a rel="DEFINITION" href="26_glo_l.htm#list"><i>list</i></a> is
returned. The argument <i>var</i> is set to the <a rel="DEFINITION"
href="26_glo_l.htm#list"><i>list</i></a> of collected values; if
<i>var</i> is supplied, the <a rel="DEFINITION" href=
"m_loop.htm#loop"><b>loop</b></a> does not return the final <a rel=
"DEFINITION" href="26_glo_l.htm#list"><i>list</i></a>
automatically. If <i>var</i> is not supplied, it is equivalent to
supplying an internal name for <i>var</i> and returning its value
in a <tt>finally</tt> clause. The <i>var</i> argument is bound as
if by the construct <tt>with</tt>. No mechanism is provided for
declaring the <a rel="DEFINITION" href=
"26_glo_t.htm#type"><i>type</i></a> of <i>var</i>; it must be of
<a rel="DEFINITION" href="26_glo_t.htm#type"><i>type</i></a>
<a rel="DEFINITION" href="t_list.htm#list"><b>list</b></a>.</p>
<p>The constructs <tt>append</tt>, <tt>appending</tt>,
<tt>nconc</tt>, and <tt>nconcing</tt> are similar to
<tt>collect</tt> except that the values of the supplied <i>form</i>
must be <a rel="DEFINITION" href=
"26_glo_l.htm#list"><i>lists</i></a>.</p>
<dl>
<dt>* The <tt>append</tt> keyword causes its <a rel="DEFINITION"
href="26_glo_l.htm#list"><i>list</i></a> values to be concatenated
into a single <a rel="DEFINITION" href=
"26_glo_l.htm#list"><i>list</i></a>, as if they were arguments to
the <a rel="DEFINITION" href=
"26_glo_f.htm#function"><i>function</i></a> <a rel="DEFINITION"
href="f_append.htm#append"><b>append</b></a>.<br></dt>
<dt>* The <tt>nconc</tt> keyword causes its <a rel="DEFINITION"
href="26_glo_l.htm#list"><i>list</i></a> values to be concatenated
into a single <a rel="DEFINITION" href=
"26_glo_l.htm#list"><i>list</i></a>, as if they were arguments to
the <a rel="DEFINITION" href=
"26_glo_f.htm#function"><i>function</i></a> <a rel="DEFINITION"
href="f_nconc.htm#nconc"><b>nconc</b></a>.<br></dt>
</dl>
<p>The argument <i>var</i> is set to the <a rel="DEFINITION" href=
"26_glo_l.htm#list"><i>list</i></a> of concatenated values; if
<i>var</i> is supplied, <a rel="DEFINITION" href=
"m_loop.htm#loop"><b>loop</b></a> does not return the final <a rel=
"DEFINITION" href="26_glo_l.htm#list"><i>list</i></a>
automatically. The <i>var</i> argument is bound as if by the
construct <tt>with</tt>. A <a rel="DEFINITION" href=
"26_glo_t.htm#type"><i>type</i></a> cannot be supplied for
<i>var</i>; it must be of <a rel="DEFINITION" href=
"26_glo_t.htm#type"><i>type</i></a> <a rel="DEFINITION" href=
"t_list.htm#list"><b>list</b></a>. The construct <tt>nconc</tt>
destructively modifies its argument <a rel="DEFINITION" href=
"26_glo_l.htm#list"><i>lists</i></a>.</p>
<p>The <tt>count</tt> construct counts the number of times that the
supplied <i>form</i> returns <a rel="DEFINITION" href=
"26_glo_t.htm#true"><i>true</i></a>. The argument <i>var</i>
accumulates the number of occurrences; if <i>var</i> is supplied,
<a rel="DEFINITION" href="m_loop.htm#loop"><b>loop</b></a> does not
return the final count automatically. The <i>var</i> argument is
bound as if by the construct <tt>with</tt> to a zero of the
appropriate type. Subsequent values (including any necessary
coercions) are computed as if by the function <a rel="DEFINITION"
href="f_1pl_1_.htm#1PL"><b>1+</b></a>. If <tt>into</tt> <i>var</i>
is used, a <a rel="DEFINITION" href=
"26_glo_t.htm#type"><i>type</i></a> can be supplied for <i>var</i>
with the <i>type-spec</i> argument; the consequences are
unspecified if a nonnumeric <a rel="DEFINITION" href=
"26_glo_t.htm#type"><i>type</i></a> is supplied. If there is no
<tt>into</tt> variable, the optional <i>type-spec</i> argument
applies to the internal variable that is keeping the count. The
default <a rel="DEFINITION" href=
"26_glo_t.htm#type"><i>type</i></a> is <a rel="DEFINITION" href=
"26_glo_i.htm#implementation-dependent"><i>implementation-dependent</i></a>;
but it must be a <a rel="DEFINITION" href=
"26_glo_s.htm#supertype"><i>supertype</i></a> of <a rel=
"DEFINITION" href="26_glo_t.htm#type"><i>type</i></a> <a rel=
"DEFINITION" href="t_fixnum.htm#fixnum"><b>fixnum</b></a>.</p>
<p>The <tt>maximize</tt> and <tt>minimize</tt> constructs compare
the value of the supplied <i>form</i> obtained during the first
iteration with values obtained in successive iterations. The
maximum (for <tt>maximize</tt>) or minimum (for <tt>minimize</tt>)
value encountered is determined (as if by the <a rel="DEFINITION"
href="26_glo_f.htm#function"><i>function</i></a> <a rel=
"DEFINITION" href="f_max_m.htm#max"><b>max</b></a> for
<tt>maximize</tt> and as if by the <a rel="DEFINITION" href=
"26_glo_f.htm#function"><i>function</i></a> <a rel="DEFINITION"
href="f_max_m.htm#min"><b>min</b></a> for <tt>minimize</tt>) and
returned. If the <tt>maximize</tt> or <tt>minimize</tt> clause is
never executed, the accumulated value is unspecified. The argument
<i>var</i> accumulates the maximum or minimum value; if <i>var</i>
is supplied, <a rel="DEFINITION" href=
"m_loop.htm#loop"><b>loop</b></a> does not return the maximum or
minimum automatically. The <i>var</i> argument is bound as if by
the construct <tt>with</tt>. If <tt>into</tt> <i>var</i> is used, a
<a rel="DEFINITION" href="26_glo_t.htm#type"><i>type</i></a> can be
supplied for <i>var</i> with the <i>type-spec</i> argument; the
consequences are unspecified if a nonnumeric <a rel="DEFINITION"
href="26_glo_t.htm#type"><i>type</i></a> is supplied. If there is
no <tt>into</tt> variable, the optional <i>type-spec</i> argument
applies to the internal variable that is keeping the maximum or
minimum value. The default <a rel="DEFINITION" href=
"26_glo_t.htm#type"><i>type</i></a> is <a rel="DEFINITION" href=
"26_glo_i.htm#implementation-dependent"><i>implementation-dependent</i></a>;
but it must be a <a rel="DEFINITION" href=
"26_glo_s.htm#supertype"><i>supertype</i></a> of <a rel=
"DEFINITION" href="26_glo_t.htm#type"><i>type</i></a> <a rel=
"DEFINITION" href="t_real.htm#real"><b>real</b></a>.</p>
<p>The <tt>sum</tt> construct forms a cumulative sum of the
successive <a rel="DEFINITION" href=
"26_glo_p.htm#primary_value"><i>primary values</i></a> of the
supplied <i>form</i> at each iteration. The argument <i>var</i> is
used to accumulate the sum; if <i>var</i> is supplied, <a rel=
"DEFINITION" href="m_loop.htm#loop"><b>loop</b></a> does not return
the final sum automatically. The <i>var</i> argument is bound as if
by the construct <tt>with</tt> to a zero of the appropriate type.
Subsequent values (including any necessary coercions) are computed
as if by the <a rel="DEFINITION" href=
"26_glo_f.htm#function"><i>function</i></a> <a rel="DEFINITION"
href="f_pl.htm#PL"><b>+</b></a>. If <tt>into</tt> <i>var</i> is
used, a <a rel="DEFINITION" href=
"26_glo_t.htm#type"><i>type</i></a> can be supplied for <i>var</i>
with the <i>type-spec</i> argument; the consequences are
unspecified if a nonnumeric <a rel="DEFINITION" href=
"26_glo_t.htm#type"><i>type</i></a> is supplied. If there is no
<tt>into</tt> variable, the optional <i>type-spec</i> argument
applies to the internal variable that is keeping the sum. The
default <a rel="DEFINITION" href=
"26_glo_t.htm#type"><i>type</i></a> is <a rel="DEFINITION" href=
"26_glo_i.htm#implementation-dependent"><i>implementation-dependent</i></a>;
but it must be a <a rel="DEFINITION" href=
"26_glo_s.htm#supertype"><i>supertype</i></a> of <a rel=
"DEFINITION" href="26_glo_t.htm#type"><i>type</i></a> <a rel=
"DEFINITION" href="t_number.htm#number"><b>number</b></a>.</p>
<p>If <tt>into</tt> is used, the construct does not provide a
default return value; however, the variable is available for use in
any <tt>finally</tt> clause.</p>
<p>Certain kinds of accumulation clauses can be combined in a
<a rel="DEFINITION" href="m_loop.htm#loop"><b>loop</b></a> if their
destination is the same (the result of <a rel="DEFINITION" href=
"m_loop.htm#loop"><b>loop</b></a> or an <tt>into</tt> <i>var</i>)
because they are considered to accumulate conceptually compatible
quantities. In particular, any elements of following sets of
accumulation clauses can be mixed with other elements of the same
set for the same destination in a <a rel="DEFINITION" href=
"m_loop.htm#loop"><b>loop</b></a> <a rel="DEFINITION" href=
"26_glo_f.htm#form"><i>form</i></a>:</p>
<dl>
<dt>* <tt>collect</tt>, <tt>append</tt>, <tt>nconc</tt><br></dt>
<dt>* <tt>sum</tt>, <tt>count</tt><br></dt>
<dt>* <tt>maximize</tt>, <tt>minimize</tt><br></dt>
</dl>
<pre>
;; Collect every name and the kids in one list by using 
;; COLLECT and APPEND.
 (loop for name in '(fred sue alice joe june)
       for kids in '((bob ken) () () (kris sunshine) ())
       collect name
       append kids)
=&gt;  (FRED BOB KEN SUE ALICE JOE KRIS SUNSHINE JUNE)
</pre>
<p>Any two clauses that do not accumulate the same <a rel=
"DEFINITION" href="26_glo_t.htm#type"><i>type</i></a> of <a rel=
"DEFINITION" href="26_glo_o.htm#object"><i>object</i></a> can
coexist in a <a rel="DEFINITION" href=
"m_loop.htm#loop"><b>loop</b></a> only if each clause accumulates
its values into a different <a rel="DEFINITION" href=
"26_glo_v.htm#variable"><i>variable</i></a>.</p>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>6.1.3.1 Examples of COLLECT clause</h2>
<pre>
;; Collect all the symbols in a list.
 (loop for i in '(bird 3 4 turtle (1 . 4) horse cat)
       when (symbolp i) collect i)
=&gt;  (BIRD TURTLE HORSE CAT)
 
;; Collect and return odd numbers.
 (loop for i from 1 to 10
       if (oddp i) collect i)
=&gt;  (1 3 5 7 9)
 
;; Collect items into local variable, but don't return them.
 (loop for i in '(a b c d) by #'cddr
       collect i into my-list
       finally (print my-list))
&gt;&gt;  (A C) 
=&gt;  NIL
</pre>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>6.1.3.2 Examples of APPEND and NCONC clauses</h2>
<pre>
;; Use APPEND to concatenate some sublists.
  (loop for x in '((a) (b) ((c)))
        append x)
=&gt;  (A B (C))
 
;; NCONC some sublists together.  Note that only lists made by the
;; call to LIST are modified.
  (loop for i upfrom 0 
        as x in '(a b (c))
        nconc (if (evenp i) (list x) nil))
=&gt;  (A (C))
</pre>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>6.1.3.3 Examples of COUNT clause</h2>
<pre>
 (loop for i in '(a b nil c nil d e)
       count i)
=&gt;  5
</pre>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>6.1.3.4 Examples of MAXIMIZE and MINIMIZE clauses</h2>
<pre>
 (loop for i in '(2 1 5 3 4)
       maximize i)
=&gt;  5
 (loop for i in '(2 1 5 3 4)
       minimize i)
=&gt;  1
 
;; In this example, FIXNUM applies to the internal variable that holds
;; the maximum value.
 (setq series '(1.2 4.3 5.7))
=&gt;  (1.2 4.3 5.7)
 (loop for v in series 
       maximize (round v) of-type fixnum)
=&gt;  6
 
;; In this example, FIXNUM applies to the variable RESULT.
 (loop for v of-type float in series
       minimize (round v) into result of-type fixnum
       finally (return result))
=&gt;  1
</pre>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>6.1.3.5 Examples of SUM clause</h2>
<pre>
 (loop for i of-type fixnum in '(1 2 3 4 5)
       sum i)
=&gt;  15
 (setq series '(1.2 4.3 5.7))
=&gt;  (1.2 4.3 5.7)
 (loop for v in series 
       sum (* 2.0 v))
=&gt;  22.4
</pre>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>6.1.4 Termination Test Clauses</h2>
<p>The <tt>repeat</tt> construct causes iteration to terminate
after a specified number of times. The loop body executes <i>n</i>
times, where <i>n</i> is the value of the expression <i>form</i>.
The <i>form</i> argument is evaluated one time in the loop
prologue. If the expression evaluates to 0 or to a negative <a rel=
"DEFINITION" href="26_glo_n.htm#number"><i>number</i></a>, the loop
body is not evaluated.</p>
<p>The constructs <tt>always</tt>, <tt>never</tt>,
<tt>thereis</tt>, <tt>while</tt>, <tt>until</tt>, and the macro
<a rel="DEFINITION" href=
"m_loop_f.htm#loop-finish"><b>loop-finish</b></a> allow conditional
termination of iteration within a <a rel="DEFINITION" href=
"m_loop.htm#loop"><b>loop</b></a>.</p>
<p>The constructs <tt>always</tt>, <tt>never</tt>, and
<tt>thereis</tt> provide specific values to be returned when a
<a rel="DEFINITION" href="m_loop.htm#loop"><b>loop</b></a>
terminates. Using <tt>always</tt>, <tt>never</tt>, or
<tt>thereis</tt> in a loop with value accumulation clauses that are
not <tt>into</tt> causes an error of <a rel="DEFINITION" href=
"26_glo_t.htm#type"><i>type</i></a> <a rel="DEFINITION" href=
"e_progra.htm#program-error"><b>program-error</b></a> to be
signaled (at macro expansion time). Since <tt>always</tt>,
<tt>never</tt>, and <tt>thereis</tt> use the <a rel="DEFINITION"
href="s_ret_fr.htm#return-from"><b>return-from</b></a> <a rel=
"DEFINITION" href="26_glo_s.htm#special_operator"><i>special
operator</i></a> to terminate iteration, any <tt>finally</tt>
clause that is supplied is not evaluated when exit occurs due to
any of these constructs. In all other respects these constructs
behave like the <tt>while</tt> and <tt>until</tt> constructs.</p>
<p>The <tt>always</tt> construct takes one <a rel="DEFINITION"
href="26_glo_f.htm#form"><i>form</i></a> and terminates the <a rel=
"DEFINITION" href="m_loop.htm#loop"><b>loop</b></a> if the <a rel=
"DEFINITION" href="26_glo_f.htm#form"><i>form</i></a> ever
evaluates to <a rel="DEFINITION" href=
"a_nil.htm#nil"><b>nil</b></a>; in this case, it returns <a rel=
"DEFINITION" href="a_nil.htm#nil"><b>nil</b></a>. Otherwise, it
provides a default return value of <a rel="DEFINITION" href=
"a_t.htm#t"><b>t</b></a>. If the value of the supplied <a rel=
"DEFINITION" href="26_glo_f.htm#form"><i>form</i></a> is never
<a rel="DEFINITION" href="a_nil.htm#nil"><b>nil</b></a>, some other
construct can terminate the iteration.</p>
<p>The <tt>never</tt> construct terminates iteration the first time
that the value of the supplied <i>form</i> is <a rel="DEFINITION"
href="26_glo_n.htm#non-nil"><i>non-nil</i></a>; the <a rel=
"DEFINITION" href="m_loop.htm#loop"><b>loop</b></a> returns <a rel=
"DEFINITION" href="a_nil.htm#nil"><b>nil</b></a>. If the value of
the supplied <i>form</i> is always <a rel="DEFINITION" href=
"a_nil.htm#nil"><b>nil</b></a>, some other construct can terminate
the iteration. Unless some other clause contributes a return value,
the default value returned is <a rel="DEFINITION" href=
"a_t.htm#t"><b>t</b></a>.</p>
<p>The <tt>thereis</tt> construct terminates iteration the first
time that the value of the supplied <i>form</i> is <a rel=
"DEFINITION" href="26_glo_n.htm#non-nil"><i>non-nil</i></a>; the
<a rel="DEFINITION" href="m_loop.htm#loop"><b>loop</b></a> returns
the value of the supplied <i>form</i>. If the value of the supplied
<i>form</i> is always <a rel="DEFINITION" href=
"a_nil.htm#nil"><b>nil</b></a>, some other construct can terminate
the iteration. Unless some other clause contributes a return value,
the default value returned is <a rel="DEFINITION" href=
"a_nil.htm#nil"><b>nil</b></a>.</p>
<p>There are two differences between the <tt>thereis</tt> and
<tt>until</tt> constructs:</p>
<dl>
<dt>* The <tt>until</tt> construct does not return a value or
<a rel="DEFINITION" href="a_nil.htm#nil"><b>nil</b></a> based on
the value of the supplied <i>form</i>.<br></dt>
<dt>* The <tt>until</tt> construct executes any <tt>finally</tt>
clause. Since <tt>thereis</tt> uses the <a rel="DEFINITION" href=
"s_ret_fr.htm#return-from"><b>return-from</b></a> <a rel=
"DEFINITION" href="26_glo_s.htm#special_operator"><i>special
operator</i></a> to terminate iteration, any <tt>finally</tt>
clause that is supplied is not evaluated when exit occurs due to
<tt>thereis</tt>.<br></dt>
</dl>
<p>The <tt>while</tt> construct allows iteration to continue until
the supplied <i>form</i> evaluates to <a rel="DEFINITION" href=
"26_glo_f.htm#false"><i>false</i></a>. The supplied <i>form</i> is
reevaluated at the location of the <tt>while</tt> clause.</p>
<p>The <tt>until</tt> construct is equivalent to <tt>while
(not</tt> <i>form</i><tt>)...</tt>. If the value of the supplied
<i>form</i> is <a rel="DEFINITION" href=
"26_glo_n.htm#non-nil"><i>non-nil</i></a>, iteration
terminates.</p>
<p>Termination-test control constructs can be used anywhere within
the loop body. The termination tests are used in the order in which
they appear. If an <tt>until</tt> or <tt>while</tt> clause causes
termination, any clauses that precede it in the source are still
evaluated. If the <tt>until</tt> and <tt>while</tt> constructs
cause termination, control is passed to the loop epilogue, where
any <tt>finally</tt> clauses will be executed.</p>
<p>There are two differences between the <tt>never</tt> and
<tt>until</tt> constructs:</p>
<dl>
<dt>* The <tt>until</tt> construct does not return <a rel=
"DEFINITION" href="a_t.htm#t"><b>t</b></a> or <a rel="DEFINITION"
href="a_nil.htm#nil"><b>nil</b></a> based on the value of the
supplied <i>form</i>.<br></dt>
<dt>* The <tt>until</tt> construct does not bypass any
<tt>finally</tt> clauses. Since <tt>never</tt> uses the <a rel=
"DEFINITION" href="s_ret_fr.htm#return-from"><b>return-from</b></a>
<a rel="DEFINITION" href="26_glo_s.htm#special_operator"><i>special
operator</i></a> to terminate iteration, any <tt>finally</tt>
clause that is supplied is not evaluated when exit occurs due to
<tt>never</tt>.<br></dt>
</dl>
<p>In most cases it is not necessary to use <a rel="DEFINITION"
href="m_loop_f.htm#loop-finish"><b>loop-finish</b></a> because
other loop control clauses terminate the <a rel="DEFINITION" href=
"m_loop.htm#loop"><b>loop</b></a>. The macro <a rel="DEFINITION"
href="m_loop_f.htm#loop-finish"><b>loop-finish</b></a> is used to
provide a normal exit from a nested conditional inside a <a rel=
"DEFINITION" href="m_loop.htm#loop"><b>loop</b></a>. Since <a rel=
"DEFINITION" href="m_loop_f.htm#loop-finish"><b>loop-finish</b></a>
transfers control to the loop epilogue, using <a rel="DEFINITION"
href="m_loop_f.htm#loop-finish"><b>loop-finish</b></a> within a
<tt>finally</tt> expression can cause infinite looping.</p>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>6.1.4.1 Examples of REPEAT clause</h2>
<pre>
 (loop repeat 3
       do (format t "~&amp;What I say three times is true.~%"))
&gt;&gt;  What I say three times is true.
&gt;&gt;  What I say three times is true.
&gt;&gt;  What I say three times is true.
=&gt;  NIL
 (loop repeat -15
   do (format t "What you see is what you expect~%"))
=&gt;  NIL
</pre>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>6.1.4.2 Examples of ALWAYS, NEVER, and THEREIS clauses</h2>
<pre>
;; Make sure I is always less than 11 (two ways).
;; The FOR construct terminates these loops.
 (loop for i from 0 to 10
       always (&lt; i 11))
=&gt;  T
 (loop for i from 0 to 10
       never (&gt; i 11))
=&gt;  T
 
;; If I exceeds 10 return I; otherwise, return NIL.
;; The THEREIS construct terminates this loop.
 (loop for i from 0
       thereis (when (&gt; i 10) i) )
=&gt;  11

;;; The FINALLY clause is not evaluated in these examples.
 (loop for i from 0 to 10
       always (&lt; i 9)
       finally (print "you won't see this"))
=&gt;  NIL
 (loop never t
       finally (print "you won't see this"))
=&gt;  NIL
 (loop thereis "Here is my value"
       finally (print "you won't see this"))
=&gt;  "Here is my value"
 
;; The FOR construct terminates this loop, so the FINALLY clause 
;; is evaluated.
 (loop for i from 1 to 10
       thereis (&gt; i 11)
       finally (prin1 'got-here))
&gt;&gt;  GOT-HERE
=&gt;  NIL
 
;; If this code could be used to find a counterexample to Fermat's
;; last theorem, it would still not return the value of the
;; counterexample because all of the THEREIS clauses in this example
;; only return T.  But if Fermat is right, that won't matter
;; because this won't terminate.
 
 (loop for z upfrom 2
       thereis
         (loop for n upfrom 3 below (log z 2)
               thereis
                 (loop for x below z
                       thereis
                         (loop for y below z
                               thereis (= (+ (expt x n) (expt y n))
                                          (expt z n))))))
</pre>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>6.1.4.3 Examples of WHILE and UNTIL clauses</h2>
<pre>
 (loop while (hungry-p) do (eat))
 
;; UNTIL NOT is equivalent to WHILE.
 (loop until (not (hungry-p)) do (eat))
 
;; Collect the length and the items of STACK.
 (let ((stack '(a b c d e f)))
   (loop for item = (length stack) then (pop stack)
         collect item
         while stack))
=&gt;  (6 A B C D E F)
 
;; Use WHILE to terminate a loop that otherwise wouldn't terminate.
;; Note that WHILE occurs after the WHEN.
 (loop for i fixnum from 3
       when (oddp i) collect i
       while (&lt; i 5))
=&gt;  (3 5)
</pre>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>6.1.5 Unconditional Execution Clauses</h2>
<p>The <tt>do</tt> and <tt>doing</tt> constructs evaluate the
supplied <i>forms</i> wherever they occur in the expanded form of
<a rel="DEFINITION" href="m_loop.htm#loop"><b>loop</b></a>. The
<i>form</i> argument can be any <a rel="DEFINITION" href=
"26_glo_c.htm#compound_form"><i>compound form</i></a>. Each
<i>form</i> is evaluated in every iteration. Because every loop
clause must begin with a <a rel="DEFINITION" href=
"26_glo_l.htm#loop_keyword"><i>loop keyword</i></a>, the keyword
<tt>do</tt> is used when no control action other than execution is
required.</p>
<p>The <tt>return</tt> construct takes one <a rel="DEFINITION"
href="26_glo_f.htm#form"><i>form</i></a>. Any <a rel="DEFINITION"
href="26_glo_v.htm#value"><i>values</i></a> returned by the <a rel=
"DEFINITION" href="26_glo_f.htm#form"><i>form</i></a> are
immediately returned by the <a rel="DEFINITION" href=
"m_loop.htm#loop"><b>loop</b></a> form. It is equivalent to the
clause <tt>do (return-from</tt> <i>block-name</i>
<i>value</i><tt>)</tt>, where <i>block-name</i> is the name
specified in a <tt>named</tt> clause, or <a rel="DEFINITION" href=
"a_nil.htm#nil"><b>nil</b></a> if there is no <tt>named</tt>
clause.</p>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>6.1.5.1 Examples of unconditional execution</h2>
<pre>
;; Print numbers and their squares.
;; The DO construct applies to multiple forms.
 (loop for i from 1 to 3
       do (print i)
          (print (* i i)))
&gt;&gt;  1 
&gt;&gt;  1 
&gt;&gt;  2 
&gt;&gt;  4 
&gt;&gt;  3 
&gt;&gt;  9 
=&gt;  NIL

</pre>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>6.1.6 Conditional Execution Clauses</h2>
<p>The <tt>if</tt>, <tt>when</tt>, and <tt>unless</tt> constructs
establish conditional control in a <a rel="DEFINITION" href=
"m_loop.htm#loop"><b>loop</b></a>. If the test passes, the
succeeding loop clause is executed. If the test does not pass, the
succeeding clause is skipped, and program control moves to the
clause that follows the <a rel="DEFINITION" href=
"26_glo_l.htm#loop_keyword"><i>loop keyword</i></a> <tt>else</tt>.
If the test does not pass and no <tt>else</tt> clause is supplied,
control is transferred to the clause or construct following the
entire conditional clause.</p>
<p>If conditional clauses are nested, each <tt>else</tt> is paired
with the closest preceding conditional clause that has no
associated <tt>else</tt> or <tt>end</tt>.</p>
<p>In the <tt>if</tt> and <tt>when</tt> clauses, which are
synonymous, the test passes if the value of <i>form</i> is <a rel=
"DEFINITION" href="26_glo_t.htm#true"><i>true</i></a>.</p>
<p>In the <tt>unless</tt> clause, the test passes if the value of
<i>form</i> is <a rel="DEFINITION" href=
"26_glo_f.htm#false"><i>false</i></a>.</p>
<p>Clauses that follow the test expression can be grouped by using
the <a rel="DEFINITION" href="26_glo_l.htm#loop_keyword"><i>loop
keyword</i></a> <tt>and</tt> to produce a conditional block
consisting of a compound clause.</p>
<p>The <a rel="DEFINITION" href="26_glo_l.htm#loop_keyword"><i>loop
keyword</i></a> <tt>it</tt> can be used to refer to the result of
the test expression in a clause. Use the <a rel="DEFINITION" href=
"26_glo_l.htm#loop_keyword"><i>loop keyword</i></a> <tt>it</tt> in
place of the form in a <tt>return</tt> clause or an
<i>accumulation</i> clause that is inside a conditional execution
clause. If multiple clauses are connected with <tt>and</tt>, the
<tt>it</tt> construct must be in the first clause in the block.</p>
<p>The optional <a rel="DEFINITION" href=
"26_glo_l.htm#loop_keyword"><i>loop keyword</i></a> <tt>end</tt>
marks the end of the clause. If this keyword is not supplied, the
next <a rel="DEFINITION" href="26_glo_l.htm#loop_keyword"><i>loop
keyword</i></a> marks the end. The construct <tt>end</tt> can be
used to distinguish the scoping of compound clauses.</p>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>6.1.6.1 Examples of WHEN clause</h2>
<pre>
;; Signal an exceptional condition.
 (loop for item in '(1 2 3 a 4 5)
       when (not (numberp item))
        return (cerror "enter new value" "non-numeric value: ~s" item))
Error: non-numeric value: A
 
;; The previous example is equivalent to the following one.
 (loop for item in '(1 2 3 a 4 5)
       when (not (numberp item))
        do (return 
            (cerror "Enter new value" "non-numeric value: ~s" item)))
Error: non-numeric value: A
</pre>
<pre>
;; This example parses a simple printed string representation from 
;; BUFFER (which is itself a string) and returns the index of the
;; closing double-quote character.
 (let ((buffer "\"a\" \"b\""))
   (loop initially (unless (char= (char buffer 0) #\")
                     (loop-finish))
         for i of-type fixnum from 1 below (length (the string buffer))
         when (char= (char buffer i) #\")
          return i))
=&gt;  2
 
;; The collected value is returned.
 (loop for i from 1 to 10
       when (&gt; i 5)
         collect i
       finally (prin1 'got-here))
&gt;&gt;  GOT-HERE
=&gt;  (6 7 8 9 10) 

;; Return both the count of collected numbers and the numbers.
 (loop for i from 1 to 10
       when (&gt; i 5)
         collect i into number-list
         and count i into number-count
       finally (return (values number-count number-list)))
=&gt;  5, (6 7 8 9 10)
</pre>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>6.1.7 Miscellaneous Clauses</h2>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>6.1.7.1 Control Transfer Clauses</h2>
<p>The <tt>named</tt> construct establishes a name for an <a rel=
"DEFINITION" href="26_glo_i.htm#implicit_block"><i>implicit
block</i></a> surrounding the entire <a rel="DEFINITION" href=
"m_loop.htm#loop"><b>loop</b></a> so that the <a rel="DEFINITION"
href="s_ret_fr.htm#return-from"><b>return-from</b></a> <a rel=
"DEFINITION" href="26_glo_s.htm#special_operator"><i>special
operator</i></a> can be used to return values from or to exit
<a rel="DEFINITION" href="m_loop.htm#loop"><b>loop</b></a>. Only
one name per <a rel="DEFINITION" href=
"m_loop.htm#loop"><b>loop</b></a> <a rel="DEFINITION" href=
"26_glo_f.htm#form"><i>form</i></a> can be assigned. If used, the
<tt>named</tt> construct must be the first clause in the loop
expression.</p>
<p>The <tt>return</tt> construct takes one <a rel="DEFINITION"
href="26_glo_f.htm#form"><i>form</i></a>. Any <a rel="DEFINITION"
href="26_glo_v.htm#value"><i>values</i></a> returned by the <a rel=
"DEFINITION" href="26_glo_f.htm#form"><i>form</i></a> are
immediately returned by the <a rel="DEFINITION" href=
"m_loop.htm#loop"><b>loop</b></a> form. This construct is similar
to the <a rel="DEFINITION" href=
"s_ret_fr.htm#return-from"><b>return-from</b></a> <a rel=
"DEFINITION" href="26_glo_s.htm#special_operator"><i>special
operator</i></a> and the <a rel="DEFINITION" href=
"m_return.htm#return"><b>return</b></a> <a rel="DEFINITION" href=
"26_glo_m.htm#macro"><i>macro</i></a>. The <tt>return</tt>
construct does not execute any <tt>finally</tt> clause that the
<a rel="DEFINITION" href="m_loop.htm#loop"><b>loop</b></a> <a rel=
"DEFINITION" href="26_glo_f.htm#form"><i>form</i></a> is given.</p>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>6.1.7.1.1 Examples of NAMED clause</h2>
<pre>
;; Just name and return.
 (loop named max
       for i from 1 to 10
       do (print i)
       do (return-from max 'done))
&gt;&gt;  1 
=&gt;  DONE
</pre>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>6.1.7.2 Initial and Final Execution</h2>
<p>The <tt>initially</tt> and <tt>finally</tt> constructs evaluate
forms that occur before and after the loop body.</p>
<p>The <tt>initially</tt> construct causes the supplied
<i>compound-forms</i> to be evaluated in the loop prologue, which
precedes all loop code except for initial settings supplied by
constructs <tt>with</tt>, <tt>for</tt>, or <tt>as</tt>. The code
for any <tt>initially</tt> clauses is executed in the order in
which the clauses appeared in the <a rel="DEFINITION" href=
"m_loop.htm#loop"><b>loop</b></a>.</p>
<p>The <tt>finally</tt> construct causes the supplied
<i>compound-forms</i> to be evaluated in the loop epilogue after
normal iteration terminates. The code for any <tt>finally</tt>
clauses is executed in the order in which the clauses appeared in
the <a rel="DEFINITION" href="m_loop.htm#loop"><b>loop</b></a>. The
collected code is executed once in the loop epilogue before any
implicit values are returned from the accumulation clauses. An
explicit transfer of control (e.g., by <a rel="DEFINITION" href=
"m_return.htm#return"><b>return</b></a>, <a rel="DEFINITION" href=
"s_go.htm#go"><b>go</b></a>, or <a rel="DEFINITION" href=
"s_throw.htm#throw"><b>throw</b></a>) from the loop body, however,
will exit the <a rel="DEFINITION" href=
"m_loop.htm#loop"><b>loop</b></a> without executing the epilogue
code.</p>
<p>Clauses such as <tt>return</tt>, <tt>always</tt>,
<tt>never</tt>, and <tt>thereis</tt> can bypass the
<tt>finally</tt> clause. <a rel="DEFINITION" href=
"m_return.htm#return"><b>return</b></a> (or <a rel="DEFINITION"
href="s_ret_fr.htm#return-from"><b>return-from</b></a>, if the
<tt>named</tt> option was supplied) can be used after
<tt>finally</tt> to return values from a <a rel="DEFINITION" href=
"m_loop.htm#loop"><b>loop</b></a>. Such an <a rel="DEFINITION"
href="26_glo_e.htm#explicit_return"><i>explicit return</i></a>
inside the <tt>finally</tt> clause takes precedence over returning
the accumulation from clauses supplied by such keywords as
<tt>collect</tt>, <tt>nconc</tt>, <tt>append</tt>, <tt>sum</tt>,
<tt>count</tt>, <tt>maximize</tt>, and <tt>minimize</tt>; the
accumulation values for these preempted clauses are not returned by
<a rel="DEFINITION" href="m_loop.htm#loop"><b>loop</b></a> if
<a rel="DEFINITION" href="m_return.htm#return"><b>return</b></a> or
<a rel="DEFINITION" href=
"s_ret_fr.htm#return-from"><b>return-from</b></a> is used.</p>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>6.1.8 Examples of Miscellaneous Loop Features</h2>
<pre>
 (let ((i 0))                     ; no loop keywords are used
    (loop (incf i) (if (= i 3) (return i)))) =&gt;  3
 (let ((i 0)(j 0))
    (tagbody
      (loop (incf j 3) (incf i) (if (= i 3) (go exit)))
      exit)
    j) =&gt;  9
</pre>
<p>In the following example, the variable <tt>x</tt> is stepped
before <tt>y</tt> is stepped; thus, the value of <tt>y</tt>
reflects the updated value of <tt>x</tt>:</p>
<pre>
 (loop for x from 1 to 10 
       for y = nil then x 
       collect (list x y))
=&gt;  ((1 NIL) (2 2) (3 3) (4 4) (5 5) (6 6) (7 7) (8 8) (9 9) (10 10))
</pre>
<p>In this example, <tt>x</tt> and <tt>y</tt> are stepped in
<a rel="DEFINITION" href=
"26_glo_p.htm#parallel"><i>parallel</i></a>:</p>
<pre>
 (loop for x from 1 to 10 
       and y = nil then x 
       collect (list x y))
=&gt;  ((1 NIL) (2 1) (3 2) (4 3) (5 4) (6 5) (7 6) (8 7) (9 8) (10 9))
</pre>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>6.1.8.1 Examples of clause grouping</h2>
<pre>
;; Group conditional clauses.
 (loop for i in '(1 324 2345 323 2 4 235 252)
       when (oddp i)
         do (print i)
         and collect i into odd-numbers
         and do (terpri)
       else                              ; I is even.
         collect i into even-numbers
       finally
         (return (values odd-numbers even-numbers)))
&gt;&gt;  1 
&gt;&gt;  
&gt;&gt;  2345 
&gt;&gt;  
&gt;&gt;  323 
&gt;&gt;  
&gt;&gt;  235 
=&gt;  (1 2345 323 235), (324 2 4 252)

;; Collect numbers larger than 3.
 (loop for i in '(1 2 3 4 5 6)
       when (and (&gt; i 3) i)
       collect it)                      ; IT refers to (and (&gt; i 3) i).
=&gt;  (4 5 6)
 
;; Find a number in a list.
 (loop for i in '(1 2 3 4 5 6)
       when (and (&gt; i 3) i)
       return it)
=&gt;  4
     
;; The above example is similar to the following one.
 (loop for i in '(1 2 3 4 5 6)
       thereis (and (&gt; i 3) i))
=&gt;  4


;; Nest conditional clauses.
 (let ((list '(0 3.0 apple 4 5 9.8 orange banana)))
   (loop for i in list
         when (numberp i)
           when (floatp i)
             collect i into float-numbers
           else                                  ; Not (floatp i)
             collect i into other-numbers
         else                                    ; Not (numberp i)
           when (symbolp i) 
             collect i into symbol-list
           else                                  ; Not (symbolp i)
             do (error "found a funny value in list ~S, value ~S~%" list i)
         finally (return (values float-numbers other-numbers symbol-list))))
=&gt;  (3.0 9.8), (0 4 5), (APPLE ORANGE BANANA)

;; Without the END preposition, the last AND would apply to the
;; inner IF rather than the outer one.
 (loop for x from 0 to 3 
       do (print x)
       if (zerop (mod x 2))
         do (princ " a")
          and if (zerop (floor x 2))
                do (princ " b")
                end
          and do (princ " c"))
&gt;&gt;  0  a b c
&gt;&gt;  1 
&gt;&gt;  2  a c
&gt;&gt;  3 
=&gt;  NIL
</pre>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>6.1.9 Notes about Loop</h2>
<p><a rel="DEFINITION" href="26_glo_t.htm#type"><i>Types</i></a>
can be supplied for loop variables. It is not necessary to supply a
<a rel="DEFINITION" href="26_glo_t.htm#type"><i>type</i></a> for
any variable, but supplying the <a rel="DEFINITION" href=
"26_glo_t.htm#type"><i>type</i></a> can ensure that the variable
has a correctly typed initial value, and it can also enable
compiler optimizations (depending on the <a rel="DEFINITION" href=
"26_glo_i.htm#implementation"><i>implementation</i></a>).</p>
<p>The clause <tt>repeat</tt> <i>n</i> ... is roughly equivalent to
a clause such as</p>
<pre>
 (loop for internal-variable downfrom (- n 1) to 0 ...)
</pre>
<p>but in some <a rel="DEFINITION" href=
"26_glo_i.htm#implementation"><i>implementations</i></a>, the
<tt>repeat</tt> construct might be more efficient.</p>
<p>Within the executable parts of the loop clauses and around the
entire <a rel="DEFINITION" href="m_loop.htm#loop"><b>loop</b></a>
form, variables can be bound by using <a rel="DEFINITION" href=
"s_let_l.htm#let"><b>let</b></a>.</p>
<p>Use caution when using a variable named <tt>IT</tt> (in any
<a rel="DEFINITION" href="26_glo_p.htm#package"><i>package</i></a>)
in connection with <a rel="DEFINITION" href=
"m_loop.htm#loop"><b>loop</b></a>, since <tt>it</tt> is a <a rel=
"DEFINITION" href="26_glo_l.htm#loop_keyword"><i>loop
keyword</i></a> that can be used in place of a <a rel="DEFINITION"
href="26_glo_f.htm#form"><i>form</i></a> in certain contexts.</p>
<p>There is no <a rel="DEFINITION" href=
"26_glo_s.htm#standardized"><i>standardized</i></a> mechanism for
users to add extensions to <a rel="DEFINITION" href=
"m_loop.htm#loop"><b>loop</b></a>.</p>
</body>
</html>
