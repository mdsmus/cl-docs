<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html>
<head>
<meta name="generator" content=
"HTML Tidy for Linux/x86 (vers 12 April 2005), see www.w3.org">
<title>CLHS: Chapter 18</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="f_rm_dup.htm">
<link rel="UP" href="../Front/Contents.htm">
<link rel="NEXT" href="18_a.htm">
<title>CLHS: Section 18.1</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="18_.htm">
<link rel="UP" href="18_.htm">
<link rel="NEXT" href="18_aa.htm">
<title>CLHS: Section 18.1.1</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="18_a.htm">
<link rel="UP" href="18_a.htm">
<link rel="NEXT" href="18_ab.htm">
<title>CLHS: Section 18.1.2</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="18_aa.htm">
<link rel="UP" href="18_a.htm">
<link rel="NEXT" href="18_aba.htm">
<title>CLHS: Section 18.1.2.1</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="18_ab.htm">
<link rel="UP" href="18_ab.htm">
<link rel="NEXT" href="18_abb.htm">
<title>CLHS: Section 18.1.2.2</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="18_aba.htm">
<link rel="UP" href="18_ab.htm">
<link rel="NEXT" href="18_abba.htm">
<title>CLHS: Section 18.1.2.2.1</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="18_abb.htm">
<link rel="UP" href="18_abb.htm">
<link rel="NEXT" href="18_abbb.htm">
<title>CLHS: Section 18.1.2.2.2</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="18_abba.htm">
<link rel="UP" href="18_abb.htm">
<link rel="NEXT" href="18_abc.htm">
<title>CLHS: Section 18.1.2.3</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="18_abbb.htm">
<link rel="UP" href="18_ab.htm">
<link rel="NEXT" href="18_abca.htm">
<title>CLHS: Section 18.1.2.3.1</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="18_abc.htm">
<link rel="UP" href="18_abc.htm">
<link rel="NEXT" href="18_abcb.htm">
<title>CLHS: Section 18.1.2.3.2</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="18_abca.htm">
<link rel="UP" href="18_abc.htm">
<link rel="NEXT" href="18_abcc.htm">
<title>CLHS: Section 18.1.2.3.3</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="18_abcb.htm">
<link rel="UP" href="18_abc.htm">
<link rel="NEXT" href="18_abd.htm">
<title>CLHS: Section 18.1.2.4</title>
<link href="../Data/clhs.css" rel="stylesheet" type="text/css">
<meta http-equiv="Author" content="Kent M. Pitman">
<meta http-equiv="Organization" content="LispWorks Ltd.">
<link rel="TOP" href="../Front/index.htm">
<link rel="COPYRIGHT" href="../Front/Help.htm#Legal">
<link rel="DISCLAIMER" href="../Front/Help.htm#Disclaimer">
<link rel="PREV" href="18_abcc.htm">
<link rel="UP" href="18_ab.htm">
<link rel="NEXT" href="c_hash_t.htm">
</head>
<body>
<p><a name="chapeighteen" id="chapeighteen"></a><a name=
"hashtables" id="hashtables"></a></p>
<h2>18. Hash Tables</h2>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>18.1 Hash Table Concepts</h2>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>18.1.1 Hash-Table Operations</h2>
<p>The next figure lists some <a rel="DEFINITION" href=
"26_glo_d.htm#defined_name"><i>defined names</i></a> that are
applicable to <a rel="DEFINITION" href=
"26_glo_h.htm#hash_table"><i>hash tables</i></a>. The following
rules apply to <a rel="DEFINITION" href=
"26_glo_h.htm#hash_table"><i>hash tables</i></a>.</p>
<dl>
<dt>-- A <a rel="DEFINITION" href="26_glo_h.htm#hash_table"><i>hash
table</i></a> can only associate one value with a given key. If an
attempt is made to add a second value for a given key, the second
value will replace the first. Thus, adding a value to a <a rel=
"DEFINITION" href="26_glo_h.htm#hash_table"><i>hash table</i></a>
is a destructive operation; the <a rel="DEFINITION" href=
"26_glo_h.htm#hash_table"><i>hash table</i></a> is
modified.<br></dt>
<dt>-- There are four kinds of <a rel="DEFINITION" href=
"26_glo_h.htm#hash_table"><i>hash tables</i></a>: those whose keys
are compared with <a rel="DEFINITION" href=
"f_eq.htm#eq"><b>eq</b></a>, those whose keys are compared with
<a rel="DEFINITION" href="f_eql.htm#eql"><b>eql</b></a>, those
whose keys are compared with <a rel="DEFINITION" href=
"f_equal.htm#equal"><b>equal</b></a>, and those whose keys are
compared with <a rel="DEFINITION" href=
"f_equalp.htm#equalp"><b>equalp</b></a>.<br></dt>
<dt>-- <a rel="DEFINITION" href="26_glo_h.htm#hash_table"><i>Hash
tables</i></a> are created by <a rel="DEFINITION" href=
"f_mk_has.htm#make-hash-table"><b>make-hash-table</b></a>. <a rel=
"DEFINITION" href="f_gethas.htm#gethash"><b>gethash</b></a> is used
to look up a key and find the associated value. New entries are
added to <a rel="DEFINITION" href="26_glo_h.htm#hash_table"><i>hash
tables</i></a> using <a rel="DEFINITION" href=
"m_setf_.htm#setf"><b>setf</b></a> with <a rel="DEFINITION" href=
"f_gethas.htm#gethash"><b>gethash</b></a>. <a rel="DEFINITION"
href="f_remhas.htm#remhash"><b>remhash</b></a> is used to remove an
entry. For example:<br></dt>
<dd>
<pre>
 (setq a (make-hash-table)) =&gt;  #&lt;HASH-TABLE EQL 0/120 32536573&gt;
 (setf (gethash 'color a) 'brown) =&gt;  BROWN
 (setf (gethash 'name a) 'fred) =&gt;  FRED
 (gethash 'color a) =&gt;  BROWN, <a rel="DEFINITION" href=
"26_glo_t.htm#true">true</a>
 (gethash 'name a) =&gt;  FRED, <a rel="DEFINITION" href=
"26_glo_t.htm#true">true</a>
 (gethash 'pointy a) =&gt;  NIL, <a rel="DEFINITION" href=
"26_glo_f.htm#false">false</a>
</pre>
<p>In this example, the symbols <tt>color</tt> and <tt>name</tt>
are being used as keys, and the symbols <tt>brown</tt> and
<tt>fred</tt> are being used as the associated values. The <a rel=
"DEFINITION" href="26_glo_h.htm#hash_table"><i>hash table</i></a>
has two items in it, one of which associates from <tt>color</tt> to
<tt>brown</tt>, and the other of which associates from
<tt>name</tt> to <tt>fred</tt>.</p>
</dd>
<dt>-- A key or a value may be any <a rel="DEFINITION" href=
"26_glo_o.htm#object"><i>object</i></a>.<br></dt>
<dt>-- The existence of an entry in the <a rel="DEFINITION" href=
"26_glo_h.htm#hash_table"><i>hash table</i></a> can be determined
from the <a rel="DEFINITION" href=
"26_glo_s.htm#secondary_value"><i>secondary value</i></a> returned
by <a rel="DEFINITION" href=
"f_gethas.htm#gethash"><b>gethash</b></a>.<br></dt>
</dl>
<pre>
<a rel="DEFINITION" href=
"f_clrhas.htm#clrhash">clrhash</a>           <a rel="DEFINITION"
href="f_hash_t.htm#hash-table-p">hash-table-p</a>     <a rel=
"DEFINITION" href="f_remhas.htm#remhash">remhash</a>  
<a rel="DEFINITION" href=
"f_gethas.htm#gethash">gethash</a>           <a rel="DEFINITION"
href="f_mk_has.htm#make-hash-table">make-hash-table</a>  <a rel=
"DEFINITION" href="f_sxhash.htm#sxhash">sxhash</a>   
<a rel="DEFINITION" href=
"f_hash_1.htm#hash-table-count">hash-table-count</a>  <a rel=
"DEFINITION" href=
"f_maphas.htm#maphash">maphash</a>                   
</pre>
<p><b>Figure 18-1. Hash-table defined names</b></p>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>18.1.2 Modifying Hash Table Keys</h2>
<p>The function supplied as the <tt>:test</tt> argument to <a rel=
"DEFINITION" href=
"f_mk_has.htm#make-hash-table"><b>make-hash-table</b></a> specifies
the `equivalence test' for the <a rel="DEFINITION" href=
"26_glo_h.htm#hash_table"><i>hash table</i></a> it creates.</p>
<p>An <a rel="DEFINITION" href=
"26_glo_o.htm#object"><i>object</i></a> is `visibly modified' with
regard to an equivalence test if there exists some set of <a rel=
"DEFINITION" href="26_glo_o.htm#object"><i>objects</i></a> (or
potential <a rel="DEFINITION" href=
"26_glo_o.htm#object"><i>objects</i></a>) which are equivalent to
the <a rel="DEFINITION" href=
"26_glo_o.htm#object"><i>object</i></a> before the modification but
are no longer equivalent afterwards.</p>
<p>If an <a rel="DEFINITION" href=
"26_glo_o.htm#object"><i>object</i></a> O1 is used as a key in a
<a rel="DEFINITION" href="26_glo_h.htm#hash_table"><i>hash
table</i></a> H and is then visibly modified with regard to the
equivalence test of H, then the consequences are unspecified if O1,
or any <a rel="DEFINITION" href=
"26_glo_o.htm#object"><i>object</i></a> O2 equivalent to O1 under
the equivalence test (either before or after the modification), is
used as a key in further operations on H. The consequences of using
O1 as a key are unspecified even if O1 is visibly modified and then
later modified again in such a way as to undo the visible
modification.</p>
<p>Following are specifications of the modifications which are
visible to the equivalence tests which must be supported by <a rel=
"DEFINITION" href="26_glo_h.htm#hash_table"><i>hash tables</i></a>.
The modifications are described in terms of modification of
components, and are defined recursively. Visible modifications of
components of the <a rel="DEFINITION" href=
"26_glo_o.htm#object"><i>object</i></a> are visible modifications
of the <a rel="DEFINITION" href=
"26_glo_o.htm#object"><i>object</i></a>.</p>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>18.1.2.1 Visible Modification of Objects with respect to EQ and
EQL</h2>
<p>No <a rel="DEFINITION" href=
"26_glo_s.htm#standardized"><i>standardized</i></a> <a rel=
"DEFINITION" href="26_glo_f.htm#function"><i>function</i></a> is
provided that is capable of visibly modifying an <a rel=
"DEFINITION" href="26_glo_o.htm#object"><i>object</i></a> with
regard to <a rel="DEFINITION" href="f_eq.htm#eq"><b>eq</b></a> or
<a rel="DEFINITION" href="f_eql.htm#eql"><b>eql</b></a>.</p>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>18.1.2.2 Visible Modification of Objects with respect to
EQUAL</h2>
<p>As a consequence of the behavior for <a rel="DEFINITION" href=
"f_equal.htm#equal"><b>equal</b></a>, the rules for visible
modification of <a rel="DEFINITION" href=
"26_glo_o.htm#object"><i>objects</i></a> not explicitly mentioned
in this section are inherited from those in <a rel="CHILD" href=
"18_aba.htm">Section 18.1.2.1 (Visible Modification of Objects with
respect to EQ and EQL)</a>.</p>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>18.1.2.2.1 Visible Modification of Conses with respect to
EQUAL</h2>
<p>Any visible change to the <a rel="DEFINITION" href=
"26_glo_c.htm#car"><i>car</i></a> or the <a rel="DEFINITION" href=
"26_glo_c.htm#cdr"><i>cdr</i></a> of a <a rel="DEFINITION" href=
"26_glo_c.htm#cons"><i>cons</i></a> is considered a visible
modification with regard to <a rel="DEFINITION" href=
"f_equal.htm#equal"><b>equal</b></a>.</p>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>18.1.2.2.2 Visible Modification of Bit Vectors and Strings with
respect to EQUAL</h2>
<p>For a <a rel="DEFINITION" href=
"26_glo_v.htm#vector"><i>vector</i></a> of <a rel="DEFINITION"
href="26_glo_t.htm#type"><i>type</i></a> <a rel="DEFINITION" href=
"t_bt_vec.htm#bit-vector"><b>bit-vector</b></a> or of <a rel=
"DEFINITION" href="26_glo_t.htm#type"><i>type</i></a> <a rel=
"DEFINITION" href="t_string.htm#string"><b>string</b></a>, any
visible change to an <a rel="DEFINITION" href=
"26_glo_a.htm#active"><i>active</i></a> <a rel="DEFINITION" href=
"26_glo_e.htm#element"><i>element</i></a> of the <a rel=
"DEFINITION" href="26_glo_v.htm#vector"><i>vector</i></a>, or to
the <a rel="DEFINITION" href=
"26_glo_l.htm#length"><i>length</i></a> of the <a rel="DEFINITION"
href="26_glo_v.htm#vector"><i>vector</i></a> (if it is <a rel=
"DEFINITION" href="26_glo_a.htm#actually_adjustable"><i>actually
adjustable</i></a> or has a <a rel="DEFINITION" href=
"26_glo_f.htm#fill_pointer"><i>fill pointer</i></a>) is considered
a visible modification with regard to <a rel="DEFINITION" href=
"f_equal.htm#equal"><b>equal</b></a>.</p>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>18.1.2.3 Visible Modification of Objects with respect to
EQUALP</h2>
<p>As a consequence of the behavior for <a rel="DEFINITION" href=
"f_equalp.htm#equalp"><b>equalp</b></a>, the rules for visible
modification of <a rel="DEFINITION" href=
"26_glo_o.htm#object"><i>objects</i></a> not explicitly mentioned
in this section are inherited from those in <a rel="CHILD" href=
"18_abb.htm">Section 18.1.2.2 (Visible Modification of Objects with
respect to EQUAL)</a>.</p>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>18.1.2.3.1 Visible Modification of Structures with respect to
EQUALP</h2>
<p>Any visible change to a <a rel="DEFINITION" href=
"26_glo_s.htm#slot"><i>slot</i></a> of a <a rel="DEFINITION" href=
"26_glo_s.htm#structure"><i>structure</i></a> is considered a
visible modification with regard to <a rel="DEFINITION" href=
"f_equalp.htm#equalp"><b>equalp</b></a>.</p>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>18.1.2.3.2 Visible Modification of Arrays with respect to
EQUALP</h2>
<p>In an <a rel="DEFINITION" href=
"26_glo_a.htm#array"><i>array</i></a>, any visible change to an
<a rel="DEFINITION" href="26_glo_a.htm#active"><i>active</i></a>
<a rel="DEFINITION" href="26_glo_e.htm#element"><i>element</i></a>,
to the <a rel="DEFINITION" href="26_glo_f.htm#fill_pointer"><i>fill
pointer</i></a> (if the <a rel="DEFINITION" href=
"26_glo_a.htm#array"><i>array</i></a> can and does have one), or to
the <a rel="DEFINITION" href=
"26_glo_d.htm#dimension"><i>dimensions</i></a> (if the <a rel=
"DEFINITION" href="26_glo_a.htm#array"><i>array</i></a> is <a rel=
"DEFINITION" href="26_glo_a.htm#actually_adjustable"><i>actually
adjustable</i></a>) is considered a visible modification with
regard to <a rel="DEFINITION" href=
"f_equalp.htm#equalp"><b>equalp</b></a>.</p>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>18.1.2.3.3 Visible Modification of Hash Tables with respect to
EQUALP</h2>
<p>In a <a rel="DEFINITION" href="26_glo_h.htm#hash_table"><i>hash
table</i></a>, any visible change to the count of entries in the
<a rel="DEFINITION" href="26_glo_h.htm#hash_table"><i>hash
table</i></a>, to the keys, or to the values associated with the
keys is considered a visible modification with regard to <a rel=
"DEFINITION" href="f_equalp.htm#equalp"><b>equalp</b></a>.</p>
<p>Note that the visibility of modifications to the keys depends on
the equivalence test of the <a rel="DEFINITION" href=
"26_glo_h.htm#hash_table"><i>hash table</i></a>, not on the
specification of <a rel="DEFINITION" href=
"f_equalp.htm#equalp"><b>equalp</b></a>.</p>
<!-- Common Lisp HyperSpec (TM), version 7.0 generated by Kent M. Pitman on Mon, 11-Apr-2005 2:31am EDT -->
<h2>18.1.2.4 Visible Modifications by Language Extensions</h2>
<p><a rel="DEFINITION" href=
"26_glo_i.htm#implementation"><i>Implementations</i></a> that
extend the language by providing additional mutator functions (or
additional behavior for existing mutator functions) must document
how the use of these extensions interacts with equivalence tests
and <a rel="DEFINITION" href="26_glo_h.htm#hash_table"><i>hash
table</i></a> searches.</p>
<p><a rel="DEFINITION" href=
"26_glo_i.htm#implementation"><i>Implementations</i></a> that
extend the language by defining additional acceptable equivalence
tests for <a rel="DEFINITION" href=
"26_glo_h.htm#hash_table"><i>hash tables</i></a> (allowing
additional values for the <tt>:test</tt> argument to <a rel=
"DEFINITION" href=
"f_mk_has.htm#make-hash-table"><b>make-hash-table</b></a>) must
document the visible components of these tests.</p>
</body>
</html>
